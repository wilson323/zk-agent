# æ•°æ®åº“æ€§èƒ½ä¼˜åŒ–ç³»ç»Ÿ

## æ¦‚è¿°

æ•°æ®åº“æ€§èƒ½ä¼˜åŒ–ç³»ç»Ÿæ˜¯ ZK-Agent å¹³å°çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ï¼Œæä¾›å…¨é¢çš„æ•°æ®åº“ç›‘æ§ã€æ€§èƒ½åˆ†æå’Œè‡ªåŠ¨ä¼˜åŒ–åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ” æ€§èƒ½ç›‘æ§
- å®æ—¶æ•°æ®åº“è¿æ¥æ± çŠ¶æ€ç›‘æ§
- æŸ¥è¯¢æ€§èƒ½æŒ‡æ ‡è¿½è¸ª
- æ…¢æŸ¥è¯¢æ£€æµ‹å’Œåˆ†æ
- èµ„æºä½¿ç”¨æƒ…å†µç›‘æ§

### ğŸ“Š æ€§èƒ½åˆ†æ
- æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’åˆ†æ
- ç´¢å¼•ä½¿ç”¨æ•ˆç‡è¯„ä¼°
- æ•°æ®åº“è´Ÿè½½åˆ†æ
- æ€§èƒ½è¶‹åŠ¿æŠ¥å‘Š

### âš¡ è‡ªåŠ¨ä¼˜åŒ–
- æ™ºèƒ½ç´¢å¼•å»ºè®®
- æŸ¥è¯¢ä¼˜åŒ–å»ºè®®
- è¿æ¥æ± å‚æ•°è°ƒä¼˜
- ç¼“å­˜ç­–ç•¥ä¼˜åŒ–

### ğŸ¯ å¥åº·æ£€æŸ¥
- æ•°æ®åº“è¿æ¥çŠ¶æ€æ£€æŸ¥
- æ€§èƒ½æŒ‡æ ‡å¥åº·è¯„ä¼°
- ç³»ç»Ÿèµ„æºä½¿ç”¨è¯„ä¼°
- ä¼˜åŒ–çŠ¶æ€ç›‘æ§

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº”ç”¨ç¨‹åºå±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DatabaseInitializer  â”‚  Admin Dashboard  â”‚  API Routes     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æ ¸å¿ƒæœåŠ¡å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DatabaseMonitor  â”‚  PerformanceUtils  â”‚  Connection Pool  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æ•°æ®åº“å±‚                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              PostgreSQL / MySQL / SQLite                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒç»„ä»¶

### 1. DatabaseInitializationManager
è´Ÿè´£ç³»ç»Ÿå¯åŠ¨æ—¶çš„åˆå§‹åŒ–æµç¨‹ï¼š
- æ•°æ®åº“è¿æ¥å»ºç«‹
- æ€§èƒ½ç›‘æ§å¯åŠ¨
- ä¼˜åŒ–ç»„ä»¶åˆå§‹åŒ–
- å¥åº·æ£€æŸ¥æ‰§è¡Œ

### 2. DatabaseMonitor
æä¾›å®æ—¶ç›‘æ§åŠŸèƒ½ï¼š
- è¿æ¥æ± çŠ¶æ€ç›‘æ§
- æŸ¥è¯¢æ€§èƒ½è¿½è¸ª
- èµ„æºä½¿ç”¨ç›‘æ§
- å¼‚å¸¸æ£€æµ‹

### 3. DatabasePerformanceUtils
æä¾›æ€§èƒ½åˆ†æå’Œä¼˜åŒ–åŠŸèƒ½ï¼š
- æŸ¥è¯¢åˆ†æ
- ç´¢å¼•ä¼˜åŒ–å»ºè®®
- æ€§èƒ½æŠ¥å‘Šç”Ÿæˆ
- ä¼˜åŒ–ç­–ç•¥æ‰§è¡Œ

### 4. DatabaseInitializer (Reactç»„ä»¶)
å‰ç«¯åˆå§‹åŒ–ç»„ä»¶ï¼š
- è‡ªåŠ¨åˆå§‹åŒ–è§¦å‘
- çŠ¶æ€æ˜¾ç¤º
- é”™è¯¯å¤„ç†
- è¿›åº¦åé¦ˆ

## ä½¿ç”¨æŒ‡å—

### ç®¡ç†å‘˜ç•Œé¢

1. **è®¿é—®ç®¡ç†é¢æ¿**
   ```
   https://your-domain.com/admin/database-performance
   ```

2. **æŸ¥çœ‹æ€§èƒ½æ¦‚è§ˆ**
   - è¿æ¥æ± çŠ¶æ€
   - ç›‘æ§ç³»ç»ŸçŠ¶æ€
   - ä¼˜åŒ–çŠ¶æ€
   - å…³é”®æ€§èƒ½æŒ‡æ ‡

3. **æ‰§è¡Œæ€§èƒ½ä¼˜åŒ–**
   - ç‚¹å‡»"ä¼˜åŒ–æ•°æ®åº“"æŒ‰é’®
   - æŸ¥çœ‹ä¼˜åŒ–å»ºè®®
   - åº”ç”¨ä¼˜åŒ–ç­–ç•¥
   - ç›‘æ§ä¼˜åŒ–æ•ˆæœ

### API æ¥å£

#### è·å–æ€§èƒ½æ•°æ®
```http
GET /api/admin/database/performance
```

å“åº”ç¤ºä¾‹ï¼š
```json
{
  "success": true,
  "data": {
    "overview": {
      "totalConnections": 50,
      "activeConnections": 12,
      "avgResponseTime": 45.2,
      "healthScore": 85
    },
    "poolStatus": {
      "total": 50,
      "active": 12,
      "idle": 38,
      "waiting": 0
    },
    "monitoringStatus": {
      "enabled": true,
      "uptime": "2h 30m",
      "lastCheck": "2024-12-19T10:30:00Z"
    }
  }
}
```

#### è§¦å‘æ€§èƒ½ä¼˜åŒ–
```http
POST /api/admin/database/optimize
Content-Type: application/json

{
  "optimizationType": "full",
  "options": {
    "analyzeQueries": true,
    "optimizeIndexes": true,
    "tuneConnections": true
  }
}
```

### ç¼–ç¨‹æ¥å£

#### æ£€æŸ¥åˆå§‹åŒ–çŠ¶æ€
```typescript
import { isDatabaseInitialized, getDatabaseInitializationStatus } from '@/lib/database/initialization'

// æ£€æŸ¥æ˜¯å¦å·²åˆå§‹åŒ–
const isInitialized = await isDatabaseInitialized()

// è·å–è¯¦ç»†çŠ¶æ€
const status = await getDatabaseInitializationStatus()
console.log('åˆå§‹åŒ–çŠ¶æ€:', status)
```

#### è·å–æ€§èƒ½æ¦‚è§ˆ
```typescript
import { getDatabasePerformanceOverview } from '@/lib/database/connection'

const overview = await getDatabasePerformanceOverview()
console.log('æ€§èƒ½æ¦‚è§ˆ:', overview)
```

#### è§¦å‘ä¼˜åŒ–
```typescript
import { triggerDatabaseOptimization } from '@/lib/database/connection'

const result = await triggerDatabaseOptimization({
  analyzeQueries: true,
  optimizeIndexes: true,
  tuneConnections: true
})
console.log('ä¼˜åŒ–ç»“æœ:', result)
```

## é…ç½®é€‰é¡¹

### ç¯å¢ƒå˜é‡
```bash
# æ•°æ®åº“è¿æ¥
DATABASE_URL=postgresql://user:password@localhost:5432/dbname

# ç›‘æ§é…ç½®
DB_MONITOR_ENABLED=true
DB_MONITOR_INTERVAL=30000
DB_HEALTH_CHECK_INTERVAL=60000

# æ€§èƒ½ä¼˜åŒ–
DB_AUTO_OPTIMIZE=false
DB_OPTIMIZATION_THRESHOLD=80
DB_MAX_CONNECTIONS=50
```

### æ•°æ®åº“é…ç½®
```javascript
// database.config.js
module.exports = {
  monitoring: {
    enabled: true,
    interval: 30000,
    healthCheckInterval: 60000,
    metricsRetention: '7d'
  },
  optimization: {
    autoOptimize: false,
    threshold: 80,
    strategies: ['indexes', 'queries', 'connections']
  },
  pool: {
    min: 5,
    max: 50,
    acquireTimeoutMillis: 30000,
    idleTimeoutMillis: 600000
  }
}
```

## ç›‘æ§æŒ‡æ ‡

### è¿æ¥æ± æŒ‡æ ‡
- **æ€»è¿æ¥æ•°**: è¿æ¥æ± ä¸­çš„æ€»è¿æ¥æ•°
- **æ´»è·ƒè¿æ¥æ•°**: å½“å‰æ­£åœ¨ä½¿ç”¨çš„è¿æ¥æ•°
- **ç©ºé—²è¿æ¥æ•°**: å¯ç”¨çš„ç©ºé—²è¿æ¥æ•°
- **ç­‰å¾…è¿æ¥æ•°**: ç­‰å¾…è·å–è¿æ¥çš„è¯·æ±‚æ•°

### æ€§èƒ½æŒ‡æ ‡
- **å¹³å‡å“åº”æ—¶é—´**: æŸ¥è¯¢çš„å¹³å‡æ‰§è¡Œæ—¶é—´
- **æŸ¥è¯¢ååé‡**: æ¯ç§’å¤„ç†çš„æŸ¥è¯¢æ•°
- **æ…¢æŸ¥è¯¢æ•°é‡**: æ‰§è¡Œæ—¶é—´è¶…è¿‡é˜ˆå€¼çš„æŸ¥è¯¢æ•°
- **é”™è¯¯ç‡**: æŸ¥è¯¢å¤±è´¥çš„ç™¾åˆ†æ¯”

### å¥åº·æŒ‡æ ‡
- **å¥åº·è¯„åˆ†**: ç»¼åˆæ€§èƒ½è¯„åˆ† (0-100)
- **å¯ç”¨æ€§**: æ•°æ®åº“æœåŠ¡å¯ç”¨æ€§ç™¾åˆ†æ¯”
- **èµ„æºä½¿ç”¨ç‡**: CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨æƒ…å†µ

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **åˆå§‹åŒ–å¤±è´¥**
   - æ£€æŸ¥æ•°æ®åº“è¿æ¥é…ç½®
   - ç¡®è®¤æ•°æ®åº“æœåŠ¡è¿è¡ŒçŠ¶æ€
   - æŸ¥çœ‹åº”ç”¨ç¨‹åºæ—¥å¿—

2. **ç›‘æ§æ•°æ®ä¸æ›´æ–°**
   - æ£€æŸ¥ç›‘æ§æœåŠ¡çŠ¶æ€
   - ç¡®è®¤ç›‘æ§é—´éš”é…ç½®
   - é‡å¯ç›‘æ§æœåŠ¡

3. **ä¼˜åŒ–å»ºè®®ä¸å‡†ç¡®**
   - ç¡®ä¿æœ‰è¶³å¤Ÿçš„å†å²æ•°æ®
   - æ£€æŸ¥æŸ¥è¯¢åˆ†æé…ç½®
   - æ›´æ–°ä¼˜åŒ–ç­–ç•¥

### æ—¥å¿—åˆ†æ

æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ï¼š
```bash
# åº”ç”¨ç¨‹åºæ—¥å¿—
tail -f logs/application.log | grep "Database"

# æ•°æ®åº“æ—¥å¿—
tail -f logs/database.log

# æ€§èƒ½ç›‘æ§æ—¥å¿—
tail -f logs/performance.log
```

## æœ€ä½³å®è·µ

### 1. ç›‘æ§é…ç½®
- è®¾ç½®åˆé€‚çš„ç›‘æ§é—´éš”ï¼ˆå»ºè®®30ç§’ï¼‰
- å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—
- é…ç½®å‘Šè­¦é˜ˆå€¼

### 2. æ€§èƒ½ä¼˜åŒ–
- å®šæœŸæ‰§è¡Œæ€§èƒ½åˆ†æ
- æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´è¿æ¥æ± å¤§å°
- åŠæ—¶åº”ç”¨ç´¢å¼•ä¼˜åŒ–å»ºè®®

### 3. ç»´æŠ¤ç­–ç•¥
- å®šæœŸå¤‡ä»½æ€§èƒ½æ•°æ®
- æ¸…ç†è¿‡æœŸçš„ç›‘æ§æ•°æ®
- æ›´æ–°ä¼˜åŒ–ç­–ç•¥

## ç‰ˆæœ¬å†å²

### v1.0.0 (2024-12-19)
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- åŸºç¡€ç›‘æ§åŠŸèƒ½
- æ€§èƒ½åˆ†æå’Œä¼˜åŒ–
- ç®¡ç†å‘˜ç•Œé¢
- API æ¥å£

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»ï¼š
- æŠ€æœ¯æ”¯æŒ: support@zk-agent.com
- æ–‡æ¡£åé¦ˆ: docs@zk-agent.com
- GitHub Issues: https://github.com/zk-agent/issues
