7e3955ee60409f93c705ef824be922c1
"use strict";
/**
 * Enhanced Database Manager 测试
 * 测试lib/database/enhanced-database-manager.ts中的所有功能
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock Prisma Client
jest.mock('@prisma/client');
// Mock Logger
jest.mock('@/lib/logger');
const enhanced_database_manager_1 = require("@/lib/database/enhanced-database-manager");
const client_1 = require("@prisma/client");
const logger_1 = require("@/lib/logger");
// Mock fetch for external API calls
global.fetch = jest.fn();
const mockPrismaInstance = {
    $connect: jest.fn(),
    $disconnect: jest.fn(),
    $transaction: jest.fn(),
    $queryRaw: jest.fn(),
    $executeRaw: jest.fn(),
    user: {
        findMany: jest.fn(),
        create: jest.fn(),
        update: jest.fn(),
        delete: jest.fn(),
    },
    post: {
        findMany: jest.fn(),
        create: jest.fn(),
        update: jest.fn(),
        delete: jest.fn(),
    },
};
const mockLogger = {
    info: jest.fn(),
    error: jest.fn(),
    warn: jest.fn(),
    debug: jest.fn(),
};
client_1.PrismaClient.mockImplementation(() => mockPrismaInstance);
logger_1.Logger.mockImplementation(() => mockLogger);
// Helper function to execute queries
const executeQuery = async (queryFn) => {
    return await queryFn();
};
describe('EnhancedDatabaseManager', () => {
    let dbManager;
    beforeEach(() => {
        jest.clearAllMocks();
        enhanced_database_manager_1.EnhancedDatabaseManager.instance = null;
        dbManager = enhanced_database_manager_1.EnhancedDatabaseManager.getInstance();
    });
    afterEach(async () => {
        await dbManager.disconnect();
    });
    describe('单例模式', () => {
        it('应该返回相同的实例', () => {
            const instance1 = enhanced_database_manager_1.EnhancedDatabaseManager.getInstance();
            const instance2 = enhanced_database_manager_1.EnhancedDatabaseManager.getInstance();
            expect(instance1).toBe(instance2);
        });
    });
    describe('初始化', () => {
        it('应该成功初始化数据库连接', async () => {
            mockPrismaInstance.$connect.mockResolvedValue(undefined);
            await dbManager.initialize();
            expect(mockPrismaInstance.$connect).toHaveBeenCalled();
            expect(mockLogger.info).toHaveBeenCalledWith('数据库连接已建立');
        });
        it('应该处理初始化错误', async () => {
            const error = new Error('连接失败');
            mockPrismaInstance.$connect.mockRejectedValue(error);
            await expect(dbManager.initialize()).rejects.toThrow('连接失败');
            expect(mockLogger.error).toHaveBeenCalledWith('数据库初始化失败:', error);
        });
    });
    describe('事务执行', () => {
        it('应该成功执行事务', async () => {
            const mockResult = { id: 1, name: 'test' };
            mockPrismaInstance.$transaction.mockResolvedValue(mockResult);
            const transactionFn = jest.fn().mockResolvedValue(mockResult);
            const result = await dbManager.executeTransaction(transactionFn);
            expect(result).toEqual(mockResult);
            expect(mockPrismaInstance.$transaction).toHaveBeenCalledWith(transactionFn);
        });
        it('应该处理事务错误', async () => {
            const error = new Error('事务失败');
            mockPrismaInstance.$transaction.mockRejectedValue(error);
            const transactionFn = jest.fn();
            await expect(dbManager.executeTransaction(transactionFn)).rejects.toThrow('事务失败');
            expect(mockLogger.error).toHaveBeenCalledWith('事务执行失败:', error);
        });
    });
    describe('查询执行', () => {
        it('应该成功执行查询', async () => {
            const mockResult = [{ id: 1, name: 'test' }];
            const queryFn = jest.fn().mockResolvedValue(mockResult);
            const result = await dbManager.executeQuery(queryFn);
            expect(result).toEqual(mockResult);
            expect(queryFn).toHaveBeenCalled();
        });
        it('应该处理查询错误', async () => {
            const error = new Error('查询失败');
            const queryFn = jest.fn().mockRejectedValue(error);
            await expect(dbManager.executeQuery(queryFn)).rejects.toThrow('查询失败');
            expect(mockLogger.error).toHaveBeenCalledWith('查询执行失败:', error);
        });
    });
    describe('健康检查', () => {
        it('应该返回健康状态', async () => {
            mockPrismaInstance.$queryRaw.mockResolvedValue([{ result: 1 }]);
            const health = await dbManager.healthCheck();
            expect(health.status).toBe('healthy');
            expect(health.timestamp).toBeDefined();
            expect(mockPrismaInstance.$queryRaw).toHaveBeenCalledWith `SELECT 1 as result`;
        });
        it('应该处理健康检查错误', async () => {
            const error = new Error('健康检查失败');
            mockPrismaInstance.$queryRaw.mockRejectedValue(error);
            const health = await dbManager.healthCheck();
            expect(health.status).toBe('unhealthy');
            expect(health.error).toBe('健康检查失败');
        });
    });
    describe('批量操作', () => {
        it('应该成功执行批量创建', async () => {
            const mockData = [{ name: 'test1' }, { name: 'test2' }];
            const mockResult = [{ id: 1, name: 'test1' }, { id: 2, name: 'test2' }];
            mockPrismaInstance.$transaction.mockImplementation(async (operations) => {
                return await Promise.all(operations.map(() => mockResult[0]));
            });
            const result = await dbManager.batchCreate('user', mockData);
            expect(result).toBeDefined();
            expect(mockPrismaInstance.$transaction).toHaveBeenCalled();
        });
        it('应该成功执行批量更新', async () => {
            const mockUpdates = [{ id: 1, name: 'updated1' }, { id: 2, name: 'updated2' }];
            mockPrismaInstance.$transaction.mockImplementation(async (operations) => {
                return await Promise.all(operations.map(() => ({ count: 1 })));
            });
            const result = await dbManager.batchUpdate('user', mockUpdates);
            expect(result).toBeDefined();
            expect(mockPrismaInstance.$transaction).toHaveBeenCalled();
        });
        it('应该成功执行批量删除', async () => {
            const mockIds = [1, 2, 3];
            mockPrismaInstance.$transaction.mockImplementation(async (operations) => {
                return await Promise.all(operations.map(() => ({ count: 1 })));
            });
            const result = await dbManager.batchDelete('user', mockIds);
            expect(result).toBeDefined();
            expect(mockPrismaInstance.$transaction).toHaveBeenCalled();
        });
    });
    describe('查询分析', () => {
        it('应该返回查询分析数据', () => {
            const analytics = dbManager.getQueryAnalytics();
            expect(analytics).toBeDefined();
            expect(analytics.totalQueries).toBeDefined();
            expect(analytics.averageExecutionTime).toBeDefined();
            expect(analytics.slowQueries).toBeDefined();
        });
        it('应该重置查询分析数据', () => {
            dbManager.resetQueryAnalytics();
            const analytics = dbManager.getQueryAnalytics();
            expect(analytics.totalQueries).toBe(0);
            expect(analytics.averageExecutionTime).toBe(0);
            expect(analytics.slowQueries).toHaveLength(0);
        });
    });
    describe('连接池管理', () => {
        it('应该返回连接池状态', () => {
            const poolStatus = dbManager.getConnectionPoolStatus();
            expect(poolStatus).toBeDefined();
            expect(poolStatus.activeConnections).toBeDefined();
            expect(poolStatus.idleConnections).toBeDefined();
            expect(poolStatus.totalConnections).toBeDefined();
        });
    });
    describe('缓存管理', () => {
        it('应该设置和获取缓存', () => {
            const key = 'test-key';
            const value = { data: 'test' };
            dbManager.setCache(key, value);
            const cachedValue = dbManager.getCache(key);
            expect(cachedValue).toEqual(value);
        });
        it('应该清除缓存', () => {
            const key = 'test-key';
            const value = { data: 'test' };
            dbManager.setCache(key, value);
            dbManager.clearCache(key);
            const cachedValue = dbManager.getCache(key);
            expect(cachedValue).toBeNull();
        });
        it('应该清除所有缓存', () => {
            dbManager.setCache('key1', 'value1');
            dbManager.setCache('key2', 'value2');
            dbManager.clearAllCache();
            expect(dbManager.getCache('key1')).toBeNull();
            expect(dbManager.getCache('key2')).toBeNull();
        });
    });
    describe('优雅关闭', () => {
        it('应该优雅地断开数据库连接', async () => {
            mockPrismaInstance.$disconnect.mockResolvedValue(undefined);
            await dbManager.disconnect();
            expect(mockPrismaInstance.$disconnect).toHaveBeenCalled();
            expect(mockLogger.info).toHaveBeenCalledWith('数据库连接已断开');
        });
        it('应该处理断开连接时的错误', async () => {
            const error = new Error('断开连接失败');
            mockPrismaInstance.$disconnect.mockRejectedValue(error);
            await dbManager.disconnect();
            expect(mockLogger.error).toHaveBeenCalledWith('断开数据库连接时发生错误:', error);
        });
    });
    describe('Prisma客户端访问', () => {
        it('应该提供对Prisma客户端的访问', () => {
            const prismaClient = dbManager.getPrismaClient();
            expect(prismaClient).toBeDefined();
            expect(prismaClient).toBe(mockPrismaInstance);
        });
    });
    describe('性能测试', () => {
        it('应该在合理时间内完成查询', async () => {
            const startTime = Date.now();
            const queryFn = jest.fn().mockResolvedValue({ id: 1 });
            await dbManager.executeQuery(queryFn);
            const endTime = Date.now();
            const executionTime = endTime - startTime;
            expect(executionTime).toBeLessThan(1000); // 应该在1秒内完成
        });
        it('应该在合理时间内完成事务', async () => {
            const startTime = Date.now();
            const transactionFn = jest.fn().mockResolvedValue({ id: 1 });
            mockPrismaInstance.$transaction.mockResolvedValue({ id: 1 });
            await dbManager.executeTransaction(transactionFn);
            const endTime = Date.now();
            const executionTime = endTime - startTime;
            expect(executionTime).toBeLessThan(2000); // 事务应该在2秒内完成
        });
    });
    describe('错误处理', () => {
        it('应该处理数据库连接错误', async () => {
            const error = new Error('数据库连接失败');
            mockPrismaInstance.$connect.mockRejectedValue(error);
            await expect(dbManager.initialize()).rejects.toThrow('数据库连接失败');
            expect(mockLogger.error).toHaveBeenCalledWith('数据库初始化失败:', error);
        });
        it('应该处理查询超时', async () => {
            const timeoutError = new Error('查询超时');
            const queryFn = jest.fn().mockRejectedValue(timeoutError);
            await expect(dbManager.executeQuery(queryFn)).rejects.toThrow('查询超时');
            expect(mockLogger.error).toHaveBeenCalledWith('查询执行失败:', timeoutError);
        });
    });
    describe('内存管理', () => {
        it('应该正确管理查询指标内存', async () => {
            // 模拟大量查询以测试内存管理
            const promises = Array.from({ length: 1500 }, async (_, i) => {
                const queryFn = jest.fn().mockResolvedValue({ id: i.toString() });
                return executeQuery(queryFn);
            });
            await Promise.all(promises);
            // 验证查询指标不会无限增长
            const analytics = dbManager.getQueryAnalytics();
            expect(analytics).toBeDefined();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRTpcXHprLWFnZW50XFxfX3Rlc3RzX19cXGxpYlxcZGF0YWJhc2VcXGVuaGFuY2VkLWRhdGFiYXNlLW1hbmFnZXIudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOztBQU1ILHFCQUFxQjtBQUNyQixJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUE7QUFFM0IsY0FBYztBQUNkLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUE7QUFSekIsd0ZBQWtGO0FBQ2xGLDJDQUE2QztBQUM3Qyx5Q0FBcUM7QUFRckMsb0NBQW9DO0FBQ3BDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFBO0FBRXhCLE1BQU0sa0JBQWtCLEdBQUc7SUFDekIsUUFBUSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDbkIsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDdEIsWUFBWSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDdkIsU0FBUyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDcEIsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDdEIsSUFBSSxFQUFFO1FBQ0osUUFBUSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDbkIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDakIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDakIsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDbEI7SUFDRCxJQUFJLEVBQUU7UUFDSixRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNuQixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNqQixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNqQixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtLQUNsQjtDQUNGLENBQUE7QUFFRCxNQUFNLFVBQVUsR0FBRztJQUNqQixJQUFJLEVBQUUsSUFB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QUcsRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7WUFDL0QsQ0FBQyxDQUFDLENBQUE7WUFFRixNQUFNLE1BQU0sR0FBRyxNQUFNLFNBQVMsQ0FBQyxXQUFXLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFBO1lBRTVELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtZQUM1QixNQUFNLENBQUMsa0JBQWtCLENBQUMsWUFBWSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQTtRQUM1RCxDQUFDLENBQUMsQ0FBQTtRQUVGLEVBQUUsQ0FBQyxZQUFZLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDMUIsTUFBTSxXQUFXLEdBQUcsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLENBQUMsQ0FBQTtZQUU5RSxrQkFBa0IsQ0FBQyxZQUFZLENBQUMsa0JBQWtCLENBQUMsS0FBSyxFQUFFLFVBQVUsRUFBRSxFQUFFO2dCQUN0RSxPQUFPLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUE7WUFDaEUsQ0FBQyxDQUFDLENBQUE7WUFFRixNQUFNLE1BQU0sR0FBRyxNQUFNLFNBQVMsQ0FBQyxXQUFXLENBQUMsTUFBTSxFQUFFLFdBQVcsQ0FBQyxDQUFBO1lBRS9ELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtZQUM1QixNQUFNLENBQUMsa0JBQWtCLENBQUMsWUFBWSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQTtRQUM1RCxDQUFDLENBQUMsQ0FBQTtRQUVGLEVBQUUsQ0FBQyxZQUFZLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDMUIsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFBO1lBRXpCLGtCQUFrQixDQUFDLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLEVBQUUsVUFBVSxFQUFFLEVBQUU7Z0JBQ3RFLE9BQU8sTUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQTtZQUNoRSxDQUFDLENBQUMsQ0FBQTtZQUVGLE1BQU0sTUFBTSxHQUFHLE1BQU0sU0FBUyxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUE7WUFFM0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFBO1lBQzVCLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxZQUFZLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFBO1FBQzVELENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQyxDQUFDLENBQUE7SUFFRixRQUFRLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRTtRQUNwQixFQUFFLENBQUMsWUFBWSxFQUFFLEdBQUcsRUFBRTtZQUNwQixNQUFNLFNBQVMsR0FBRyxTQUFTLENBQUMsaUJBQWlCLEVBQUUsQ0FBQTtZQUUvQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7WUFDL0IsTUFBTSxDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtZQUM1QyxNQUFNLENBQUMsU0FBUyxDQUFDLG9CQUFvQixDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7WUFDcEQsTUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtRQUM3QyxDQUFDLENBQUMsQ0FBQTtRQUVGLEVBQUUsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFO1lBQ3BCLFNBQVMsQ0FBQyxtQkFBbUIsRUFBRSxDQUFBO1lBRS9CLE1BQU0sU0FBUyxHQUFHLFNBQVMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFBO1lBQy9DLE1BQU0sQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFBO1lBQ3RDLE1BQU0sQ0FBQyxTQUFTLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUE7WUFDOUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUE7UUFDL0MsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDLENBQUMsQ0FBQTtJQUVGLFFBQVEsQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFO1FBQ3JCLEVBQUUsQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFO1lBQ25CLE1BQU0sVUFBVSxHQUFHLFNBQVMsQ0FBQyx1QkFBdUIsRUFBRSxDQUFBO1lBRXRELE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtZQUNoQyxNQUFNLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7WUFDbEQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtZQUNoRCxNQUFNLENBQUMsVUFBVSxDQUFDLGdCQUFnQixDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7UUFDbkQsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDLENBQUMsQ0FBQTtJQUVGLFFBQVEsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFO1FBQ3BCLEVBQUUsQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFO1lBQ25CLE1BQU0sR0FBRyxHQUFHLFVBQVUsQ0FBQTtZQUN0QixNQUFNLEtBQUssR0FBRyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQTtZQUU5QixTQUFTLENBQUMsUUFBUSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQTtZQUM5QixNQUFNLFdBQVcsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFBO1lBRTNDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDcEMsQ0FBQyxDQUFDLENBQUE7UUFFRixFQUFFLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRTtZQUNoQixNQUFNLEdBQUcsR0FBRyxVQUFVLENBQUE7WUFDdEIsTUFBTSxLQUFLLEdBQUcsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUE7WUFFOUIsU0FBUyxDQUFDLFFBQVEsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUE7WUFDOUIsU0FBUyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQTtZQUN6QixNQUFNLFdBQVcsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFBO1lBRTNDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQTtRQUNoQyxDQUFDLENBQUMsQ0FBQTtRQUVGLEVBQUUsQ0FBQyxVQUFVLEVBQUUsR0FBRyxFQUFFO1lBQ2xCLFNBQVMsQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFBO1lBQ3BDLFNBQVMsQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFBO1lBRXBDLFNBQVMsQ0FBQyxhQUFhLEVBQUUsQ0FBQTtZQUV6QixNQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFBO1lBQzdDLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUE7UUFDL0MsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDLENBQUMsQ0FBQTtJQUVGLFFBQVEsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFO1FBQ3BCLEVBQUUsQ0FBQyxjQUFjLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDNUIsa0JBQWtCLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFBO1lBRTNELE1BQU0sU0FBUyxDQUFDLFVBQVUsRUFBRSxDQUFBO1lBRTVCLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxXQUFXLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFBO1lBQ3pELE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsb0JBQW9CLENBQUMsVUFBVSxDQUFDLENBQUE7UUFDMUQsQ0FBQyxDQUFDLENBQUE7UUFFRixFQUFFLENBQUMsY0FBYyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzVCLE1BQU0sS0FBSyxHQUFHLElBQUksS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFBO1lBQ2pDLGtCQUFrQixDQUFDLFdBQVcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQTtZQUV2RCxNQUFNLFNBQVMsQ0FBQyxVQUFVLEVBQUUsQ0FBQTtZQUU1QixNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLG9CQUFvQixDQUFDLGVBQWUsRUFBRSxLQUFLLENBQUMsQ0FBQTtRQUN2RSxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQyxDQUFBO0lBRUYsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDM0IsRUFBRSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRTtZQUMzQixNQUFNLFlBQVksR0FBRyxTQUFTLENBQUMsZUFBZSxFQUFFLENBQUE7WUFFaEQsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFBO1lBQ2xDLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQTtRQUMvQyxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQyxDQUFBO0lBRUYsUUFBUSxDQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUU7UUFDcEIsRUFBRSxDQUFDLGNBQWMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM1QixNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUE7WUFDNUIsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUE7WUFFdEQsTUFBTSxTQUFTLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFBO1lBRXJDLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQTtZQUMxQixNQUFNLGFBQWEsR0FBRyxPQUFPLEdBQUcsU0FBUyxDQUFBO1lBRXpDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUEsQ0FBQyxXQUFXO1FBQ3RELENBQUMsQ0FBQyxDQUFBO1FBRUYsRUFBRSxDQUFDLGNBQWMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM1QixNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUE7WUFDNUIsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUE7WUFDNUQsa0JBQWtCLENBQUMsWUFBWSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUE7WUFFNUQsTUFBTSxTQUFTLENBQUMsa0JBQWtCLENBQUMsYUFBYSxDQUFDLENBQUE7WUFFakQsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFBO1lBQzFCLE1BQU0sYUFBYSxHQUFHLE9BQU8sR0FBRyxTQUFTLENBQUE7WUFFekMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQSxDQUFDLGFBQWE7UUFDeEQsQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDLENBQUMsQ0FBQTtJQUVGLFFBQVEsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFO1FBQ3BCLEVBQUUsQ0FBQyxhQUFhLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDM0IsTUFBTSxLQUFLLEdBQUcsSUFBSSxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUE7WUFDbEMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFBO1lBRXBELE1BQU0sTUFBTSxDQUFDLFNBQVMsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUE7WUFDL0QsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxXQUFXLEVBQUUsS0FBSyxDQUFDLENBQUE7UUFDbkUsQ0FBQyxDQUFDLENBQUE7UUFFRixFQUFFLENBQUMsVUFBVSxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3hCLE1BQU0sWUFBWSxHQUFHLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFBO1lBQ3RDLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsQ0FBQTtZQUV6RCxNQUFNLE1BQU0sQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQTtZQUNyRSxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsQ0FBQTtRQUN4RSxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQyxDQUFBO0lBRUYsUUFBUSxDQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUU7UUFDcEIsRUFBRSxDQUFDLGNBQWMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUM1QixnQkFBZ0I7WUFDaEIsTUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUMzRCxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQTtnQkFDakUsT0FBTyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUE7WUFDOUIsQ0FBQyxDQUFDLENBQUE7WUFFRixNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUE7WUFFM0IsZUFBZTtZQUNmLE1BQU0sU0FBUyxHQUFHLFNBQVMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFBO1lBQy9DLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtRQUNqQyxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQyxDQUFDLENBQUEiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiRTpcXHprLWFnZW50XFxfX3Rlc3RzX19cXGxpYlxcZGF0YWJhc2VcXGVuaGFuY2VkLWRhdGFiYXNlLW1hbmFnZXIudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEVuaGFuY2VkIERhdGFiYXNlIE1hbmFnZXIg5rWL6K+VXG4gKiDmtYvor5VsaWIvZGF0YWJhc2UvZW5oYW5jZWQtZGF0YWJhc2UtbWFuYWdlci50c+S4reeahOaJgOacieWKn+iDvVxuICovXG5cbmltcG9ydCB7IEVuaGFuY2VkRGF0YWJhc2VNYW5hZ2VyIH0gZnJvbSAnQC9saWIvZGF0YWJhc2UvZW5oYW5jZWQtZGF0YWJhc2UtbWFuYWdlcidcbmltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xuaW1wb3J0IHsgTG9nZ2VyIH0gZnJvbSAnQC9saWIvbG9nZ2VyJ1xuXG4vLyBNb2NrIFByaXNtYSBDbGllbnRcbmplc3QubW9jaygnQHByaXNtYS9jbGllbnQnKVxuXG4vLyBNb2NrIExvZ2dlclxuamVzdC5tb2NrKCdAL2xpYi9sb2dnZXInKVxuXG4vLyBNb2NrIGZldGNoIGZvciBleHRlcm5hbCBBUEkgY2FsbHNcbmdsb2JhbC5mZXRjaCA9IGplc3QuZm4oKVxuXG5jb25zdCBtb2NrUHJpc21hSW5zdGFuY2UgPSB7XG4gICRjb25uZWN0OiBqZXN0LmZuKCksXG4gICRkaXNjb25uZWN0OiBqZXN0LmZuKCksXG4gICR0cmFuc2FjdGlvbjogamVzdC5mbigpLFxuICAkcXVlcnlSYXc6IGplc3QuZm4oKSxcbiAgJGV4ZWN1dGVSYXc6IGplc3QuZm4oKSxcbiAgdXNlcjoge1xuICAgIGZpbmRNYW55OiBqZXN0LmZuKCksXG4gICAgY3JlYXRlOiBqZXN0LmZuKCksXG4gICAgdXBkYXRlOiBqZXN0LmZuKCksXG4gICAgZGVsZXRlOiBqZXN0LmZuKCksXG4gIH0sXG4gIHBvc3Q6IHtcbiAgICBmaW5kTWFueTogamVzdC5mbigpLFxuICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICAgIHVwZGF0ZTogamVzdC5mbigpLFxuICAgIGRlbGV0ZTogamVzdC5mbigpLFxuICB9LFxufVxuXG5jb25zdCBtb2NrTG9nZ2VyID0ge1xuICBpbmZvOiBqZXN0LmZuKCksXG4gIGVycm9yOiBqZXN0LmZuKCksXG4gIHdhcm46IGplc3QuZm4oKSxcbiAgZGVidWc6IGplc3QuZm4oKSxcbn1cblxuOyhQcmlzbWFDbGllbnQgYXMgamVzdC5Nb2NrZWRDbGFzczx0eXBlb2YgUHJpc21hQ2xpZW50PikubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IG1vY2tQcmlzbWFJbnN0YW5jZSBhcyBhbnkpXG47KExvZ2dlciBhcyBqZXN0Lk1vY2tlZENsYXNzPHR5cGVvZiBMb2dnZXI+KS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gbW9ja0xvZ2dlciBhcyBhbnkpXG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBleGVjdXRlIHF1ZXJpZXNcbmNvbnN0IGV4ZWN1dGVRdWVyeSA9IGFzeW5jIChxdWVyeUZuOiAoKSA9PiBQcm9taXNlPGFueT4pID0+IHtcbiAgcmV0dXJuIGF3YWl0IHF1ZXJ5Rm4oKVxufVxuXG5kZXNjcmliZSgnRW5oYW5jZWREYXRhYmFzZU1hbmFnZXInLCAoKSA9PiB7XG4gIGxldCBkYk1hbmFnZXI6IEVuaGFuY2VkRGF0YWJhc2VNYW5hZ2VyXG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKClcbiAgICAvLyBSZXNldCBzaW5nbGV0b24gaW5zdGFuY2VcbiAgICA7KEVuaGFuY2VkRGF0YWJhc2VNYW5hZ2VyIGFzIGFueSkuaW5zdGFuY2UgPSBudWxsXG4gICAgZGJNYW5hZ2VyID0gRW5oYW5jZWREYXRhYmFzZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKVxuICB9KVxuXG4gIGFmdGVyRWFjaChhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgZGJNYW5hZ2VyLmRpc2Nvbm5lY3QoKVxuICB9KVxuXG4gIGRlc2NyaWJlKCfljZXkvovmqKHlvI8nLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpei/lOWbnuebuOWQjOeahOWunuS+iycsICgpID0+IHtcbiAgICAgIGNvbnN0IGluc3RhbmNlMSA9IEVuaGFuY2VkRGF0YWJhc2VNYW5hZ2VyLmdldEluc3RhbmNlKClcbiAgICAgIGNvbnN0IGluc3RhbmNlMiA9IEVuaGFuY2VkRGF0YWJhc2VNYW5hZ2VyLmdldEluc3RhbmNlKClcbiAgICAgIGV4cGVjdChpbnN0YW5jZTEpLnRvQmUoaW5zdGFuY2UyKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ+WIneWni+WMlicsICgpID0+IHtcbiAgICBpdCgn5bqU6K+l5oiQ5Yqf5Yid5aeL5YyW5pWw5o2u5bqT6L+e5o6lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1ByaXNtYUluc3RhbmNlLiRjb25uZWN0Lm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZClcbiAgICAgIFxuICAgICAgYXdhaXQgZGJNYW5hZ2VyLmluaXRpYWxpemUoKVxuICAgICAgXG4gICAgICBleHBlY3QobW9ja1ByaXNtYUluc3RhbmNlLiRjb25uZWN0KS50b0hhdmVCZWVuQ2FsbGVkKClcbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmluZm8pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCfmlbDmja7lupPov57mjqXlt7Llu7rnq4snKVxuICAgIH0pXG5cbiAgICBpdCgn5bqU6K+l5aSE55CG5Yid5aeL5YyW6ZSZ6K+vJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ+i/nuaOpeWksei0pScpXG4gICAgICBtb2NrUHJpc21hSW5zdGFuY2UuJGNvbm5lY3QubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpXG4gICAgICBcbiAgICAgIGF3YWl0IGV4cGVjdChkYk1hbmFnZXIuaW5pdGlhbGl6ZSgpKS5yZWplY3RzLnRvVGhyb3coJ+i/nuaOpeWksei0pScpXG4gICAgICBleHBlY3QobW9ja0xvZ2dlci5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ+aVsOaNruW6k+WIneWni+WMluWksei0pTonLCBlcnJvcilcbiAgICB9KVxuICB9KVxuXG4gIGRlc2NyaWJlKCfkuovliqHmiafooYwnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpeaIkOWKn+aJp+ihjOS6i+WKoScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tSZXN1bHQgPSB7IGlkOiAxLCBuYW1lOiAndGVzdCcgfVxuICAgICAgbW9ja1ByaXNtYUluc3RhbmNlLiR0cmFuc2FjdGlvbi5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVzdWx0KVxuICAgICAgXG4gICAgICBjb25zdCB0cmFuc2FjdGlvbkZuID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZXN1bHQpXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYk1hbmFnZXIuZXhlY3V0ZVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uRm4pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Jlc3VsdClcbiAgICAgIGV4cGVjdChtb2NrUHJpc21hSW5zdGFuY2UuJHRyYW5zYWN0aW9uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh0cmFuc2FjdGlvbkZuKVxuICAgIH0pXG5cbiAgICBpdCgn5bqU6K+l5aSE55CG5LqL5Yqh6ZSZ6K+vJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ+S6i+WKoeWksei0pScpXG4gICAgICBtb2NrUHJpc21hSW5zdGFuY2UuJHRyYW5zYWN0aW9uLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKVxuICAgICAgXG4gICAgICBjb25zdCB0cmFuc2FjdGlvbkZuID0gamVzdC5mbigpXG4gICAgICBhd2FpdCBleHBlY3QoZGJNYW5hZ2VyLmV4ZWN1dGVUcmFuc2FjdGlvbih0cmFuc2FjdGlvbkZuKSkucmVqZWN0cy50b1Rocm93KCfkuovliqHlpLHotKUnKVxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCfkuovliqHmiafooYzlpLHotKU6JywgZXJyb3IpXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgn5p+l6K+i5omn6KGMJywgKCkgPT4ge1xuICAgIGl0KCflupTor6XmiJDlip/miafooYzmn6Xor6InLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUmVzdWx0ID0gW3sgaWQ6IDEsIG5hbWU6ICd0ZXN0JyB9XVxuICAgICAgY29uc3QgcXVlcnlGbiA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVzdWx0KVxuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYk1hbmFnZXIuZXhlY3V0ZVF1ZXJ5KHF1ZXJ5Rm4pXG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Jlc3VsdClcbiAgICAgIGV4cGVjdChxdWVyeUZuKS50b0hhdmVCZWVuQ2FsbGVkKClcbiAgICB9KVxuXG4gICAgaXQoJ+W6lOivpeWkhOeQhuafpeivoumUmeivrycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCfmn6Xor6LlpLHotKUnKVxuICAgICAgY29uc3QgcXVlcnlGbiA9IGplc3QuZm4oKS5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcilcbiAgICAgIFxuICAgICAgYXdhaXQgZXhwZWN0KGRiTWFuYWdlci5leGVjdXRlUXVlcnkocXVlcnlGbikpLnJlamVjdHMudG9UaHJvdygn5p+l6K+i5aSx6LSlJylcbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgn5p+l6K+i5omn6KGM5aSx6LSlOicsIGVycm9yKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ+WBpeW6t+ajgOafpScsICgpID0+IHtcbiAgICBpdCgn5bqU6K+l6L+U5Zue5YGl5bq354q25oCBJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1ByaXNtYUluc3RhbmNlLiRxdWVyeVJhdy5tb2NrUmVzb2x2ZWRWYWx1ZShbeyByZXN1bHQ6IDEgfV0pXG4gICAgICBcbiAgICAgIGNvbnN0IGhlYWx0aCA9IGF3YWl0IGRiTWFuYWdlci5oZWFsdGhDaGVjaygpXG4gICAgICBcbiAgICAgIGV4cGVjdChoZWFsdGguc3RhdHVzKS50b0JlKCdoZWFsdGh5JylcbiAgICAgIGV4cGVjdChoZWFsdGgudGltZXN0YW1wKS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QobW9ja1ByaXNtYUluc3RhbmNlLiRxdWVyeVJhdykudG9IYXZlQmVlbkNhbGxlZFdpdGhgU0VMRUNUIDEgYXMgcmVzdWx0YFxuICAgIH0pXG5cbiAgICBpdCgn5bqU6K+l5aSE55CG5YGl5bq35qOA5p+l6ZSZ6K+vJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ+WBpeW6t+ajgOafpeWksei0pScpXG4gICAgICBtb2NrUHJpc21hSW5zdGFuY2UuJHF1ZXJ5UmF3Lm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKVxuICAgICAgXG4gICAgICBjb25zdCBoZWFsdGggPSBhd2FpdCBkYk1hbmFnZXIuaGVhbHRoQ2hlY2soKVxuICAgICAgXG4gICAgICBleHBlY3QoaGVhbHRoLnN0YXR1cykudG9CZSgndW5oZWFsdGh5JylcbiAgICAgIGV4cGVjdChoZWFsdGguZXJyb3IpLnRvQmUoJ+WBpeW6t+ajgOafpeWksei0pScpXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgn5om56YeP5pON5L2cJywgKCkgPT4ge1xuICAgIGl0KCflupTor6XmiJDlip/miafooYzmibnph4/liJvlu7onLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrRGF0YSA9IFt7IG5hbWU6ICd0ZXN0MScgfSwgeyBuYW1lOiAndGVzdDInIH1dXG4gICAgICBjb25zdCBtb2NrUmVzdWx0ID0gW3sgaWQ6IDEsIG5hbWU6ICd0ZXN0MScgfSwgeyBpZDogMiwgbmFtZTogJ3Rlc3QyJyB9XVxuICAgICAgXG4gICAgICBtb2NrUHJpc21hSW5zdGFuY2UuJHRyYW5zYWN0aW9uLm1vY2tJbXBsZW1lbnRhdGlvbihhc3luYyAob3BlcmF0aW9ucykgPT4ge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwob3BlcmF0aW9ucy5tYXAoKCkgPT4gbW9ja1Jlc3VsdFswXSkpXG4gICAgICB9KVxuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYk1hbmFnZXIuYmF0Y2hDcmVhdGUoJ3VzZXInLCBtb2NrRGF0YSlcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKVxuICAgICAgZXhwZWN0KG1vY2tQcmlzbWFJbnN0YW5jZS4kdHJhbnNhY3Rpb24pLnRvSGF2ZUJlZW5DYWxsZWQoKVxuICAgIH0pXG5cbiAgICBpdCgn5bqU6K+l5oiQ5Yqf5omn6KGM5om56YeP5pu05pawJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VwZGF0ZXMgPSBbeyBpZDogMSwgbmFtZTogJ3VwZGF0ZWQxJyB9LCB7IGlkOiAyLCBuYW1lOiAndXBkYXRlZDInIH1dXG4gICAgICBcbiAgICAgIG1vY2tQcmlzbWFJbnN0YW5jZS4kdHJhbnNhY3Rpb24ubW9ja0ltcGxlbWVudGF0aW9uKGFzeW5jIChvcGVyYXRpb25zKSA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLmFsbChvcGVyYXRpb25zLm1hcCgoKSA9PiAoeyBjb3VudDogMSB9KSkpXG4gICAgICB9KVxuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYk1hbmFnZXIuYmF0Y2hVcGRhdGUoJ3VzZXInLCBtb2NrVXBkYXRlcylcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKVxuICAgICAgZXhwZWN0KG1vY2tQcmlzbWFJbnN0YW5jZS4kdHJhbnNhY3Rpb24pLnRvSGF2ZUJlZW5DYWxsZWQoKVxuICAgIH0pXG5cbiAgICBpdCgn5bqU6K+l5oiQ5Yqf5omn6KGM5om56YeP5Yig6ZmkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0lkcyA9IFsxLCAyLCAzXVxuICAgICAgXG4gICAgICBtb2NrUHJpc21hSW5zdGFuY2UuJHRyYW5zYWN0aW9uLm1vY2tJbXBsZW1lbnRhdGlvbihhc3luYyAob3BlcmF0aW9ucykgPT4ge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwob3BlcmF0aW9ucy5tYXAoKCkgPT4gKHsgY291bnQ6IDEgfSkpKVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGJNYW5hZ2VyLmJhdGNoRGVsZXRlKCd1c2VyJywgbW9ja0lkcylcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKVxuICAgICAgZXhwZWN0KG1vY2tQcmlzbWFJbnN0YW5jZS4kdHJhbnNhY3Rpb24pLnRvSGF2ZUJlZW5DYWxsZWQoKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ+afpeivouWIhuaekCcsICgpID0+IHtcbiAgICBpdCgn5bqU6K+l6L+U5Zue5p+l6K+i5YiG5p6Q5pWw5o2uJywgKCkgPT4ge1xuICAgICAgY29uc3QgYW5hbHl0aWNzID0gZGJNYW5hZ2VyLmdldFF1ZXJ5QW5hbHl0aWNzKClcbiAgICAgIFxuICAgICAgZXhwZWN0KGFuYWx5dGljcykudG9CZURlZmluZWQoKVxuICAgICAgZXhwZWN0KGFuYWx5dGljcy50b3RhbFF1ZXJpZXMpLnRvQmVEZWZpbmVkKClcbiAgICAgIGV4cGVjdChhbmFseXRpY3MuYXZlcmFnZUV4ZWN1dGlvblRpbWUpLnRvQmVEZWZpbmVkKClcbiAgICAgIGV4cGVjdChhbmFseXRpY3Muc2xvd1F1ZXJpZXMpLnRvQmVEZWZpbmVkKClcbiAgICB9KVxuXG4gICAgaXQoJ+W6lOivpemHjee9ruafpeivouWIhuaekOaVsOaNricsICgpID0+IHtcbiAgICAgIGRiTWFuYWdlci5yZXNldFF1ZXJ5QW5hbHl0aWNzKClcbiAgICAgIFxuICAgICAgY29uc3QgYW5hbHl0aWNzID0gZGJNYW5hZ2VyLmdldFF1ZXJ5QW5hbHl0aWNzKClcbiAgICAgIGV4cGVjdChhbmFseXRpY3MudG90YWxRdWVyaWVzKS50b0JlKDApXG4gICAgICBleHBlY3QoYW5hbHl0aWNzLmF2ZXJhZ2VFeGVjdXRpb25UaW1lKS50b0JlKDApXG4gICAgICBleHBlY3QoYW5hbHl0aWNzLnNsb3dRdWVyaWVzKS50b0hhdmVMZW5ndGgoMClcbiAgICB9KVxuICB9KVxuXG4gIGRlc2NyaWJlKCfov57mjqXmsaDnrqHnkIYnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpei/lOWbnui/nuaOpeaxoOeKtuaAgScsICgpID0+IHtcbiAgICAgIGNvbnN0IHBvb2xTdGF0dXMgPSBkYk1hbmFnZXIuZ2V0Q29ubmVjdGlvblBvb2xTdGF0dXMoKVxuICAgICAgXG4gICAgICBleHBlY3QocG9vbFN0YXR1cykudG9CZURlZmluZWQoKVxuICAgICAgZXhwZWN0KHBvb2xTdGF0dXMuYWN0aXZlQ29ubmVjdGlvbnMpLnRvQmVEZWZpbmVkKClcbiAgICAgIGV4cGVjdChwb29sU3RhdHVzLmlkbGVDb25uZWN0aW9ucykudG9CZURlZmluZWQoKVxuICAgICAgZXhwZWN0KHBvb2xTdGF0dXMudG90YWxDb25uZWN0aW9ucykudG9CZURlZmluZWQoKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ+e8k+WtmOeuoeeQhicsICgpID0+IHtcbiAgICBpdCgn5bqU6K+l6K6+572u5ZKM6I635Y+W57yT5a2YJywgKCkgPT4ge1xuICAgICAgY29uc3Qga2V5ID0gJ3Rlc3Qta2V5J1xuICAgICAgY29uc3QgdmFsdWUgPSB7IGRhdGE6ICd0ZXN0JyB9XG4gICAgICBcbiAgICAgIGRiTWFuYWdlci5zZXRDYWNoZShrZXksIHZhbHVlKVxuICAgICAgY29uc3QgY2FjaGVkVmFsdWUgPSBkYk1hbmFnZXIuZ2V0Q2FjaGUoa2V5KVxuICAgICAgXG4gICAgICBleHBlY3QoY2FjaGVkVmFsdWUpLnRvRXF1YWwodmFsdWUpXG4gICAgfSlcblxuICAgIGl0KCflupTor6XmuIXpmaTnvJPlrZgnLCAoKSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSAndGVzdC1rZXknXG4gICAgICBjb25zdCB2YWx1ZSA9IHsgZGF0YTogJ3Rlc3QnIH1cbiAgICAgIFxuICAgICAgZGJNYW5hZ2VyLnNldENhY2hlKGtleSwgdmFsdWUpXG4gICAgICBkYk1hbmFnZXIuY2xlYXJDYWNoZShrZXkpXG4gICAgICBjb25zdCBjYWNoZWRWYWx1ZSA9IGRiTWFuYWdlci5nZXRDYWNoZShrZXkpXG4gICAgICBcbiAgICAgIGV4cGVjdChjYWNoZWRWYWx1ZSkudG9CZU51bGwoKVxuICAgIH0pXG5cbiAgICBpdCgn5bqU6K+l5riF6Zmk5omA5pyJ57yT5a2YJywgKCkgPT4ge1xuICAgICAgZGJNYW5hZ2VyLnNldENhY2hlKCdrZXkxJywgJ3ZhbHVlMScpXG4gICAgICBkYk1hbmFnZXIuc2V0Q2FjaGUoJ2tleTInLCAndmFsdWUyJylcbiAgICAgIFxuICAgICAgZGJNYW5hZ2VyLmNsZWFyQWxsQ2FjaGUoKVxuICAgICAgXG4gICAgICBleHBlY3QoZGJNYW5hZ2VyLmdldENhY2hlKCdrZXkxJykpLnRvQmVOdWxsKClcbiAgICAgIGV4cGVjdChkYk1hbmFnZXIuZ2V0Q2FjaGUoJ2tleTInKSkudG9CZU51bGwoKVxuICAgIH0pXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ+S8mOmbheWFs+mXrScsICgpID0+IHtcbiAgICBpdCgn5bqU6K+l5LyY6ZuF5Zyw5pat5byA5pWw5o2u5bqT6L+e5o6lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1ByaXNtYUluc3RhbmNlLiRkaXNjb25uZWN0Lm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZClcbiAgICAgIFxuICAgICAgYXdhaXQgZGJNYW5hZ2VyLmRpc2Nvbm5lY3QoKVxuICAgICAgXG4gICAgICBleHBlY3QobW9ja1ByaXNtYUluc3RhbmNlLiRkaXNjb25uZWN0KS50b0hhdmVCZWVuQ2FsbGVkKClcbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmluZm8pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCfmlbDmja7lupPov57mjqXlt7Lmlq3lvIAnKVxuICAgIH0pXG5cbiAgICBpdCgn5bqU6K+l5aSE55CG5pat5byA6L+e5o6l5pe255qE6ZSZ6K+vJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ+aWreW8gOi/nuaOpeWksei0pScpXG4gICAgICBtb2NrUHJpc21hSW5zdGFuY2UuJGRpc2Nvbm5lY3QubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpXG4gICAgICBcbiAgICAgIGF3YWl0IGRiTWFuYWdlci5kaXNjb25uZWN0KClcbiAgICAgIFxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCfmlq3lvIDmlbDmja7lupPov57mjqXml7blj5HnlJ/plJnor686JywgZXJyb3IpXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgnUHJpc21h5a6i5oi356uv6K6/6ZeuJywgKCkgPT4ge1xuICAgIGl0KCflupTor6Xmj5Dkvpvlr7lQcmlzbWHlrqLmiLfnq6/nmoTorr/pl64nLCAoKSA9PiB7XG4gICAgICBjb25zdCBwcmlzbWFDbGllbnQgPSBkYk1hbmFnZXIuZ2V0UHJpc21hQ2xpZW50KClcbiAgICAgIFxuICAgICAgZXhwZWN0KHByaXNtYUNsaWVudCkudG9CZURlZmluZWQoKVxuICAgICAgZXhwZWN0KHByaXNtYUNsaWVudCkudG9CZShtb2NrUHJpc21hSW5zdGFuY2UpXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgn5oCn6IO95rWL6K+VJywgKCkgPT4ge1xuICAgIGl0KCflupTor6XlnKjlkIjnkIbml7bpl7TlhoXlrozmiJDmn6Xor6InLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpXG4gICAgICBjb25zdCBxdWVyeUZuID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHsgaWQ6IDEgfSlcbiAgICAgIFxuICAgICAgYXdhaXQgZGJNYW5hZ2VyLmV4ZWN1dGVRdWVyeShxdWVyeUZuKVxuICAgICAgXG4gICAgICBjb25zdCBlbmRUaW1lID0gRGF0ZS5ub3coKVxuICAgICAgY29uc3QgZXhlY3V0aW9uVGltZSA9IGVuZFRpbWUgLSBzdGFydFRpbWVcbiAgICAgIFxuICAgICAgZXhwZWN0KGV4ZWN1dGlvblRpbWUpLnRvQmVMZXNzVGhhbigxMDAwKSAvLyDlupTor6XlnKgx56eS5YaF5a6M5oiQXG4gICAgfSlcblxuICAgIGl0KCflupTor6XlnKjlkIjnkIbml7bpl7TlhoXlrozmiJDkuovliqEnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpXG4gICAgICBjb25zdCB0cmFuc2FjdGlvbkZuID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHsgaWQ6IDEgfSlcbiAgICAgIG1vY2tQcmlzbWFJbnN0YW5jZS4kdHJhbnNhY3Rpb24ubW9ja1Jlc29sdmVkVmFsdWUoeyBpZDogMSB9KVxuICAgICAgXG4gICAgICBhd2FpdCBkYk1hbmFnZXIuZXhlY3V0ZVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uRm4pXG4gICAgICBcbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpXG4gICAgICBjb25zdCBleGVjdXRpb25UaW1lID0gZW5kVGltZSAtIHN0YXJ0VGltZVxuICAgICAgXG4gICAgICBleHBlY3QoZXhlY3V0aW9uVGltZSkudG9CZUxlc3NUaGFuKDIwMDApIC8vIOS6i+WKoeW6lOivpeWcqDLnp5LlhoXlrozmiJBcbiAgICB9KVxuICB9KVxuXG4gIGRlc2NyaWJlKCfplJnor6/lpITnkIYnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpeWkhOeQhuaVsOaNruW6k+i/nuaOpemUmeivrycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCfmlbDmja7lupPov57mjqXlpLHotKUnKVxuICAgICAgbW9ja1ByaXNtYUluc3RhbmNlLiRjb25uZWN0Lm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKVxuICAgICAgXG4gICAgICBhd2FpdCBleHBlY3QoZGJNYW5hZ2VyLmluaXRpYWxpemUoKSkucmVqZWN0cy50b1Rocm93KCfmlbDmja7lupPov57mjqXlpLHotKUnKVxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCfmlbDmja7lupPliJ3lp4vljJblpLHotKU6JywgZXJyb3IpXG4gICAgfSlcblxuICAgIGl0KCflupTor6XlpITnkIbmn6Xor6LotoXml7YnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0aW1lb3V0RXJyb3IgPSBuZXcgRXJyb3IoJ+afpeivoui2heaXticpXG4gICAgICBjb25zdCBxdWVyeUZuID0gamVzdC5mbigpLm1vY2tSZWplY3RlZFZhbHVlKHRpbWVvdXRFcnJvcilcbiAgICAgIFxuICAgICAgYXdhaXQgZXhwZWN0KGRiTWFuYWdlci5leGVjdXRlUXVlcnkocXVlcnlGbikpLnJlamVjdHMudG9UaHJvdygn5p+l6K+i6LaF5pe2JylcbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgn5p+l6K+i5omn6KGM5aSx6LSlOicsIHRpbWVvdXRFcnJvcilcbiAgICB9KVxuICB9KVxuXG4gIGRlc2NyaWJlKCflhoXlrZjnrqHnkIYnLCAoKSA9PiB7XG4gICAgaXQoJ+W6lOivpeato+ehrueuoeeQhuafpeivouaMh+agh+WGheWtmCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIOaooeaLn+Wkp+mHj+afpeivouS7pea1i+ivleWGheWtmOeuoeeQhlxuICAgICAgY29uc3QgcHJvbWlzZXMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiAxNTAwIH0sIGFzeW5jIChfLCBpKSA9PiB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5Rm4gPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoeyBpZDogaS50b1N0cmluZygpIH0pXG4gICAgICAgIHJldHVybiBleGVjdXRlUXVlcnkocXVlcnlGbilcbiAgICAgIH0pXG5cbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKVxuXG4gICAgICAvLyDpqozor4Hmn6Xor6LmjIfmoIfkuI3kvJrml6DpmZDlop7plb9cbiAgICAgIGNvbnN0IGFuYWx5dGljcyA9IGRiTWFuYWdlci5nZXRRdWVyeUFuYWx5dGljcygpXG4gICAgICBleHBlY3QoYW5hbHl0aWNzKS50b0JlRGVmaW5lZCgpXG4gICAgfSlcbiAgfSlcbn0pIl0sInZlcnNpb24iOjN9