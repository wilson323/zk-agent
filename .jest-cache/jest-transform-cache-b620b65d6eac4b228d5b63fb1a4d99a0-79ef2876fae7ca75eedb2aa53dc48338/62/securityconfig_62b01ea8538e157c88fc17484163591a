77572e33641381950c0142fc7b642773
/**
 * @file 数据库安全配置
 * @description 生产级数据库安全配置和策略
 * @author ZK-Agent Team
 * @date 2024-06-25
 */

const fs = require('fs');
const path = require('path');
const crypto = require('crypto');

// SSL证书路径
const SSL_CERT_PATH = path.join(process.cwd(), 'ssl', 'certs', 'server.crt');
const SSL_KEY_PATH = path.join(process.cwd(), 'ssl', 'certs', 'server.key');
const SSL_CA_PATH = path.join(process.cwd(), 'ssl', 'certs', 'ca.crt');

/**
 * 生产级数据库安全配置
 */
const securityConfig = {
  // SSL/TLS配置
  ssl: {
    // 开发环境配置
    development: {
      enabled: process.env.DATABASE_SSL_DEV === 'true',
      rejectUnauthorized: false,
      // 开发环境允许自签名证书
      cert: fs.existsSync(SSL_CERT_PATH) ? fs.readFileSync(SSL_CERT_PATH) : null,
      key: fs.existsSync(SSL_KEY_PATH) ? fs.readFileSync(SSL_KEY_PATH) : null,
      ca: fs.existsSync(SSL_CA_PATH) ? fs.readFileSync(SSL_CA_PATH) : null,
      checkServerIdentity: () => undefined // 开发环境跳过服务器身份验证
    },
    // 测试环境配置
    test: {
      enabled: false,
      // 测试环境通常不需要SSL
      rejectUnauthorized: false
    },
    // 生产环境配置
    production: {
      enabled: process.env.DATABASE_SSL === 'true' || process.env.NODE_ENV === 'production',
      rejectUnauthorized: true,
      // 生产环境必须验证证书
      cert: process.env.DATABASE_SSL_CERT ? fs.readFileSync(process.env.DATABASE_SSL_CERT) : null,
      key: process.env.DATABASE_SSL_KEY ? fs.readFileSync(process.env.DATABASE_SSL_KEY) : null,
      ca: process.env.DATABASE_SSL_CA ? fs.readFileSync(process.env.DATABASE_SSL_CA) : null,
      servername: process.env.DATABASE_SSL_SERVERNAME || process.env.DB_HOST || 'localhost'
    }
  },
  // 密码安全策略
  password: {
    // 最小密码强度要求
    minLength: 12,
    requireUppercase: true,
    requireLowercase: true,
    requireNumbers: true,
    requireSpecialChars: true,
    // 禁用的弱密码
    blacklist: ['password', '123456', 'admin', 'root', 'postgres', 'password123', 'admin123', 'qwerty', '12345678'],
    // 密码轮换策略
    rotation: {
      enabled: process.env.NODE_ENV === 'production',
      intervalDays: 90,
      // 90天轮换一次
      historyCount: 5 // 记住最近5个密码
    }
  },
  // 连接安全配置
  connection: {
    // 连接超时配置
    timeouts: {
      connection: parseInt(process.env.DATABASE_CONNECTION_TIMEOUT) || 5000,
      idle: parseInt(process.env.DATABASE_IDLE_TIMEOUT) || 30000,
      query: parseInt(process.env.DATABASE_QUERY_TIMEOUT) || 10000
    },
    // 连接池安全配置
    pool: {
      // 最大连接数限制
      max: {
        development: 10,
        test: 5,
        production: parseInt(process.env.DATABASE_POOL_MAX) || 20
      },
      // 最小连接数
      min: {
        development: 2,
        test: 1,
        production: parseInt(process.env.DATABASE_POOL_MIN) || 5
      },
      // 连接获取超时
      acquire: {
        development: 30000,
        test: 30000,
        production: parseInt(process.env.DATABASE_POOL_ACQUIRE) || 60000
      },
      // 空闲连接超时
      idle: {
        development: 10000,
        test: 10000,
        production: parseInt(process.env.DATABASE_POOL_IDLE) || 300000 // 5分钟
      },
      // 连接驱逐间隔
      evict: {
        development: 1000,
        test: 1000,
        production: parseInt(process.env.DATABASE_POOL_EVICT) || 5000
      }
    },
    // IP白名单（生产环境）
    allowedIPs: process.env.DATABASE_ALLOWED_IPS ? process.env.DATABASE_ALLOWED_IPS.split(',').map(ip => ip.trim()) : ['127.0.0.1', '::1', 'localhost'],
    // 连接重试配置
    retry: {
      max: 3,
      delay: 1000,
      backoff: 'exponential'
    }
  },
  // 审计和监控配置
  audit: {
    enabled: process.env.DATABASE_AUDIT === 'true' || process.env.NODE_ENV === 'production',
    // 记录的事件类型
    events: {
      connections: true,
      queries: process.env.DATABASE_AUDIT_QUERIES === 'true',
      errors: true,
      slowQueries: true,
      failedLogins: true
    },
    // 慢查询阈值（毫秒）
    slowQueryThreshold: parseInt(process.env.DATABASE_SLOW_QUERY_THRESHOLD) || 1000,
    // 审计日志保留期（天）
    retentionDays: parseInt(process.env.DATABASE_AUDIT_RETENTION) || 90
  },
  // 数据加密配置
  encryption: {
    // 静态数据加密
    atRest: {
      enabled: process.env.DATABASE_ENCRYPTION_AT_REST === 'true',
      algorithm: 'aes-256-gcm',
      keyRotationDays: 365
    },
    // 传输中数据加密
    inTransit: {
      enabled: process.env.DATABASE_ENCRYPTION_IN_TRANSIT === 'true' || process.env.NODE_ENV === 'production',
      minTlsVersion: '1.2',
      cipherSuites: ['ECDHE-RSA-AES256-GCM-SHA384', 'ECDHE-RSA-AES128-GCM-SHA256', 'ECDHE-RSA-AES256-SHA384', 'ECDHE-RSA-AES128-SHA256']
    }
  },
  // 备份安全配置
  backup: {
    encryption: {
      enabled: true,
      algorithm: 'aes-256-cbc',
      keyDerivation: 'pbkdf2'
    },
    // 备份访问控制
    access: {
      requireMFA: process.env.NODE_ENV === 'production',
      allowedUsers: process.env.DATABASE_BACKUP_USERS ? process.env.DATABASE_BACKUP_USERS.split(',').map(user => user.trim()) : ['admin']
    }
  }
};

/**
 * 获取当前环境的SSL配置
 * @param {string} env - 环境名称
 * @returns {object} SSL配置
 */
function getSSLConfig(env = process.env.NODE_ENV || 'development') {
  const config = securityConfig.ssl[env] || securityConfig.ssl.development;
  if (!config.enabled) {
    return false;
  }

  // 构建SSL配置对象
  const sslConfig = {
    require: true,
    rejectUnauthorized: config.rejectUnauthorized
  };

  // 添加证书文件（如果存在）
  if (config.cert) {
    sslConfig.cert = config.cert;
  }
  if (config.key) {
    sslConfig.key = config.key;
  }
  if (config.ca) {
    sslConfig.ca = config.ca;
  }
  if (config.servername) {
    sslConfig.servername = config.servername;
  }
  if (config.checkServerIdentity) {
    sslConfig.checkServerIdentity = config.checkServerIdentity;
  }
  return sslConfig;
}

/**
 * 验证密码强度
 * @param {string} password - 密码
 * @returns {object} 验证结果
 */
function validatePassword(password) {
  const config = securityConfig.password;
  const errors = [];

  // 检查长度
  if (password.length < config.minLength) {
    errors.push(`密码长度至少需要${config.minLength}个字符`);
  }

  // 检查大写字母
  if (config.requireUppercase && !/[A-Z]/.test(password)) {
    errors.push('密码必须包含至少一个大写字母');
  }

  // 检查小写字母
  if (config.requireLowercase && !/[a-z]/.test(password)) {
    errors.push('密码必须包含至少一个小写字母');
  }

  // 检查数字
  if (config.requireNumbers && !/\d/.test(password)) {
    errors.push('密码必须包含至少一个数字');
  }

  // 检查特殊字符
  if (config.requireSpecialChars && !/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password)) {
    errors.push('密码必须包含至少一个特殊字符');
  }

  // 检查黑名单
  if (config.blacklist.includes(password.toLowerCase())) {
    errors.push('密码过于简单，请选择更强的密码');
  }
  return {
    valid: errors.length === 0,
    errors,
    strength: calculatePasswordStrength(password)
  };
}

/**
 * 计算密码强度
 * @param {string} password - 密码
 * @returns {number} 强度分数 (0-100)
 */
function calculatePasswordStrength(password) {
  let score = 0;

  // 长度分数
  score += Math.min(password.length * 4, 25);

  // 字符类型分数
  if (/[a-z]/.test(password)) {
    score += 5;
  }
  if (/[A-Z]/.test(password)) {
    score += 5;
  }
  if (/\d/.test(password)) {
    score += 5;
  }
  if (/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password)) {
    score += 10;
  }

  // 复杂度分数
  const uniqueChars = new Set(password).size;
  score += Math.min(uniqueChars * 2, 20);

  // 模式检查（减分）
  if (/123|abc|qwe/i.test(password)) {
    score -= 10;
  }
  if (/(..).*\1/.test(password)) {
    score -= 10;
  } // 重复模式

  return Math.max(0, Math.min(100, score));
}

/**
 * 生成强密码
 * @param {number} length - 密码长度
 * @returns {string} 生成的密码
 */
function generateStrongPassword(length = 16) {
  const lowercase = 'abcdefghijklmnopqrstuvwxyz';
  const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  const numbers = '0123456789';
  const symbols = '!@#$%^&*()_+-=[]{}|;:,.<>?';
  const allChars = lowercase + uppercase + numbers + symbols;
  let password = '';

  // 确保至少包含每种类型的字符
  password += lowercase[Math.floor(Math.random() * lowercase.length)];
  password += uppercase[Math.floor(Math.random() * uppercase.length)];
  password += numbers[Math.floor(Math.random() * numbers.length)];
  password += symbols[Math.floor(Math.random() * symbols.length)];

  // 填充剩余长度
  for (let i = password.length; i < length; i++) {
    password += allChars[Math.floor(Math.random() * allChars.length)];
  }

  // 打乱字符顺序
  return password.split('').sort(() => Math.random() - 0.5).join('');
}

/**
 * 获取当前环境的连接池配置
 * @param {string} env - 环境名称
 * @returns {object} 连接池配置
 */
function getPoolConfig(env = process.env.NODE_ENV || 'development') {
  const poolConfig = securityConfig.connection.pool;
  return {
    max: poolConfig.max[env] || poolConfig.max.development,
    min: poolConfig.min[env] || poolConfig.min.development,
    acquire: poolConfig.acquire[env] || poolConfig.acquire.development,
    idle: poolConfig.idle[env] || poolConfig.idle.development,
    evict: poolConfig.evict[env] || poolConfig.evict.development
  };
}

/**
 * 验证数据库安全配置
 * @param {string} env - 环境名称
 * @returns {object} 验证结果
 */
function validateSecurityConfig(env = process.env.NODE_ENV || 'development') {
  const issues = [];
  const warnings = [];

  // 检查SSL配置
  if (env === 'production' && !securityConfig.ssl.production.enabled) {
    issues.push('生产环境必须启用SSL加密');
  }

  // 检查密码配置
  if (!process.env.DB_PASSWORD || process.env.DB_PASSWORD.length < securityConfig.password.minLength) {
    issues.push(`数据库密码长度至少需要${securityConfig.password.minLength}个字符`);
  }

  // 检查审计配置
  if (env === 'production' && !securityConfig.audit.enabled) {
    warnings.push('建议在生产环境启用数据库审计');
  }

  // 检查连接超时配置
  const timeouts = securityConfig.connection.timeouts;
  if (timeouts.connection > 10000) {
    warnings.push('连接超时时间过长，可能影响安全性');
  }
  return {
    valid: issues.length === 0,
    issues,
    warnings,
    score: calculateSecurityScore(env)
  };
}

/**
 * 计算安全配置分数
 * @param {string} env - 环境名称
 * @returns {number} 安全分数 (0-100)
 */
function calculateSecurityScore(env = process.env.NODE_ENV || 'development') {
  let score = 0;

  // SSL配置 (30分)
  if (securityConfig.ssl[env]?.enabled) {
    score += 30;
    if (securityConfig.ssl[env]?.rejectUnauthorized) {
      score += 10;
    }
  }

  // 密码强度 (25分)
  if (process.env.DB_PASSWORD) {
    const passwordValidation = validatePassword(process.env.DB_PASSWORD);
    score += Math.floor(passwordValidation.strength * 0.25);
  }

  // 审计配置 (20分)
  if (securityConfig.audit.enabled) {
    score += 20;
  }

  // 连接安全 (15分)
  const timeouts = securityConfig.connection.timeouts;
  if (timeouts.connection <= 5000) {
    score += 5;
  }
  if (timeouts.idle <= 30000) {
    score += 5;
  }
  if (timeouts.query <= 10000) {
    score += 5;
  }

  // 加密配置 (10分)
  if (securityConfig.encryption.inTransit.enabled) {
    score += 5;
  }
  if (securityConfig.encryption.atRest.enabled) {
    score += 5;
  }
  return Math.min(100, score);
}
module.exports = {
  securityConfig,
  getSSLConfig,
  validatePassword,
  calculatePasswordStrength,
  generateStrongPassword,
  getPoolConfig,
  validateSecurityConfig,
  calculateSecurityScore
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJwYXRoIiwiY3J5cHRvIiwiU1NMX0NFUlRfUEFUSCIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiU1NMX0tFWV9QQVRIIiwiU1NMX0NBX1BBVEgiLCJzZWN1cml0eUNvbmZpZyIsInNzbCIsImRldmVsb3BtZW50IiwiZW5hYmxlZCIsImVudiIsIkRBVEFCQVNFX1NTTF9ERVYiLCJyZWplY3RVbmF1dGhvcml6ZWQiLCJjZXJ0IiwiZXhpc3RzU3luYyIsInJlYWRGaWxlU3luYyIsImtleSIsImNhIiwiY2hlY2tTZXJ2ZXJJZGVudGl0eSIsInVuZGVmaW5lZCIsInRlc3QiLCJwcm9kdWN0aW9uIiwiREFUQUJBU0VfU1NMIiwiTk9ERV9FTlYiLCJEQVRBQkFTRV9TU0xfQ0VSVCIsIkRBVEFCQVNFX1NTTF9LRVkiLCJEQVRBQkFTRV9TU0xfQ0EiLCJzZXJ2ZXJuYW1lIiwiREFUQUJBU0VfU1NMX1NFUlZFUk5BTUUiLCJEQl9IT1NUIiwicGFzc3dvcmQiLCJtaW5MZW5ndGgiLCJyZXF1aXJlVXBwZXJjYXNlIiwicmVxdWlyZUxvd2VyY2FzZSIsInJlcXVpcmVOdW1iZXJzIiwicmVxdWlyZVNwZWNpYWxDaGFycyIsImJsYWNrbGlzdCIsInJvdGF0aW9uIiwiaW50ZXJ2YWxEYXlzIiwiaGlzdG9yeUNvdW50IiwiY29ubmVjdGlvbiIsInRpbWVvdXRzIiwicGFyc2VJbnQiLCJEQVRBQkFTRV9DT05ORUNUSU9OX1RJTUVPVVQiLCJpZGxlIiwiREFUQUJBU0VfSURMRV9USU1FT1VUIiwicXVlcnkiLCJEQVRBQkFTRV9RVUVSWV9USU1FT1VUIiwicG9vbCIsIm1heCIsIkRBVEFCQVNFX1BPT0xfTUFYIiwibWluIiwiREFUQUJBU0VfUE9PTF9NSU4iLCJhY3F1aXJlIiwiREFUQUJBU0VfUE9PTF9BQ1FVSVJFIiwiREFUQUJBU0VfUE9PTF9JRExFIiwiZXZpY3QiLCJEQVRBQkFTRV9QT09MX0VWSUNUIiwiYWxsb3dlZElQcyIsIkRBVEFCQVNFX0FMTE9XRURfSVBTIiwic3BsaXQiLCJtYXAiLCJpcCIsInRyaW0iLCJyZXRyeSIsImRlbGF5IiwiYmFja29mZiIsImF1ZGl0IiwiREFUQUJBU0VfQVVESVQiLCJldmVudHMiLCJjb25uZWN0aW9ucyIsInF1ZXJpZXMiLCJEQVRBQkFTRV9BVURJVF9RVUVSSUVTIiwiZXJyb3JzIiwic2xvd1F1ZXJpZXMiLCJmYWlsZWRMb2dpbnMiLCJzbG93UXVlcnlUaHJlc2hvbGQiLCJEQVRBQkFTRV9TTE9XX1FVRVJZX1RIUkVTSE9MRCIsInJldGVudGlvbkRheXMiLCJEQVRBQkFTRV9BVURJVF9SRVRFTlRJT04iLCJlbmNyeXB0aW9uIiwiYXRSZXN0IiwiREFUQUJBU0VfRU5DUllQVElPTl9BVF9SRVNUIiwiYWxnb3JpdGhtIiwia2V5Um90YXRpb25EYXlzIiwiaW5UcmFuc2l0IiwiREFUQUJBU0VfRU5DUllQVElPTl9JTl9UUkFOU0lUIiwibWluVGxzVmVyc2lvbiIsImNpcGhlclN1aXRlcyIsImJhY2t1cCIsImtleURlcml2YXRpb24iLCJhY2Nlc3MiLCJyZXF1aXJlTUZBIiwiYWxsb3dlZFVzZXJzIiwiREFUQUJBU0VfQkFDS1VQX1VTRVJTIiwidXNlciIsImdldFNTTENvbmZpZyIsImNvbmZpZyIsInNzbENvbmZpZyIsInZhbGlkYXRlUGFzc3dvcmQiLCJsZW5ndGgiLCJwdXNoIiwiaW5jbHVkZXMiLCJ0b0xvd2VyQ2FzZSIsInZhbGlkIiwic3RyZW5ndGgiLCJjYWxjdWxhdGVQYXNzd29yZFN0cmVuZ3RoIiwic2NvcmUiLCJNYXRoIiwidW5pcXVlQ2hhcnMiLCJTZXQiLCJzaXplIiwiZ2VuZXJhdGVTdHJvbmdQYXNzd29yZCIsImxvd2VyY2FzZSIsInVwcGVyY2FzZSIsIm51bWJlcnMiLCJzeW1ib2xzIiwiYWxsQ2hhcnMiLCJmbG9vciIsInJhbmRvbSIsImkiLCJzb3J0IiwiZ2V0UG9vbENvbmZpZyIsInBvb2xDb25maWciLCJ2YWxpZGF0ZVNlY3VyaXR5Q29uZmlnIiwiaXNzdWVzIiwid2FybmluZ3MiLCJEQl9QQVNTV09SRCIsImNhbGN1bGF0ZVNlY3VyaXR5U2NvcmUiLCJwYXNzd29yZFZhbGlkYXRpb24iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsic2VjdXJpdHktY29uZmlnLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGZpbGUg5pWw5o2u5bqT5a6J5YWo6YWN572uXG4gKiBAZGVzY3JpcHRpb24g55Sf5Lqn57qn5pWw5o2u5bqT5a6J5YWo6YWN572u5ZKM562W55WlXG4gKiBAYXV0aG9yIFpLLUFnZW50IFRlYW1cbiAqIEBkYXRlIDIwMjQtMDYtMjVcbiAqL1xuXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuY29uc3QgY3J5cHRvID0gcmVxdWlyZSgnY3J5cHRvJyk7XG5cbi8vIFNTTOivgeS5pui3r+W+hFxuY29uc3QgU1NMX0NFUlRfUEFUSCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnc3NsJywgJ2NlcnRzJywgJ3NlcnZlci5jcnQnKTtcbmNvbnN0IFNTTF9LRVlfUEFUSCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnc3NsJywgJ2NlcnRzJywgJ3NlcnZlci5rZXknKTtcbmNvbnN0IFNTTF9DQV9QQVRIID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdzc2wnLCAnY2VydHMnLCAnY2EuY3J0Jyk7XG5cbi8qKlxuICog55Sf5Lqn57qn5pWw5o2u5bqT5a6J5YWo6YWN572uXG4gKi9cbmNvbnN0IHNlY3VyaXR5Q29uZmlnID0ge1xuICAvLyBTU0wvVExT6YWN572uXG4gIHNzbDoge1xuICAgIC8vIOW8gOWPkeeOr+Wig+mFjee9rlxuICAgIGRldmVsb3BtZW50OiB7XG4gICAgICBlbmFibGVkOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9TU0xfREVWID09PSAndHJ1ZScsXG4gICAgICByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlLCAvLyDlvIDlj5Hnjq/looPlhYHorrjoh6rnrb7lkI3or4HkuaZcbiAgICAgIGNlcnQ6IGZzLmV4aXN0c1N5bmMoU1NMX0NFUlRfUEFUSCkgPyBmcy5yZWFkRmlsZVN5bmMoU1NMX0NFUlRfUEFUSCkgOiBudWxsLFxuICAgICAga2V5OiBmcy5leGlzdHNTeW5jKFNTTF9LRVlfUEFUSCkgPyBmcy5yZWFkRmlsZVN5bmMoU1NMX0tFWV9QQVRIKSA6IG51bGwsXG4gICAgICBjYTogZnMuZXhpc3RzU3luYyhTU0xfQ0FfUEFUSCkgPyBmcy5yZWFkRmlsZVN5bmMoU1NMX0NBX1BBVEgpIDogbnVsbCxcbiAgICAgIGNoZWNrU2VydmVySWRlbnRpdHk6ICgpID0+IHVuZGVmaW5lZCAvLyDlvIDlj5Hnjq/looPot7Pov4fmnI3liqHlmajouqvku73pqozor4FcbiAgICB9LFxuICAgIFxuICAgIC8vIOa1i+ivleeOr+Wig+mFjee9rlxuICAgIHRlc3Q6IHtcbiAgICAgIGVuYWJsZWQ6IGZhbHNlLCAvLyDmtYvor5Xnjq/looPpgJrluLjkuI3pnIDopoFTU0xcbiAgICAgIHJlamVjdFVuYXV0aG9yaXplZDogZmFsc2VcbiAgICB9LFxuICAgIFxuICAgIC8vIOeUn+S6p+eOr+Wig+mFjee9rlxuICAgIHByb2R1Y3Rpb246IHtcbiAgICAgIGVuYWJsZWQ6IHByb2Nlc3MuZW52LkRBVEFCQVNFX1NTTCA9PT0gJ3RydWUnIHx8IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXG4gICAgICByZWplY3RVbmF1dGhvcml6ZWQ6IHRydWUsIC8vIOeUn+S6p+eOr+Wig+W/hemhu+mqjOivgeivgeS5plxuICAgICAgY2VydDogcHJvY2Vzcy5lbnYuREFUQUJBU0VfU1NMX0NFUlQgPyBmcy5yZWFkRmlsZVN5bmMocHJvY2Vzcy5lbnYuREFUQUJBU0VfU1NMX0NFUlQpIDogbnVsbCxcbiAgICAgIGtleTogcHJvY2Vzcy5lbnYuREFUQUJBU0VfU1NMX0tFWSA/IGZzLnJlYWRGaWxlU3luYyhwcm9jZXNzLmVudi5EQVRBQkFTRV9TU0xfS0VZKSA6IG51bGwsXG4gICAgICBjYTogcHJvY2Vzcy5lbnYuREFUQUJBU0VfU1NMX0NBID8gZnMucmVhZEZpbGVTeW5jKHByb2Nlc3MuZW52LkRBVEFCQVNFX1NTTF9DQSkgOiBudWxsLFxuICAgICAgc2VydmVybmFtZTogcHJvY2Vzcy5lbnYuREFUQUJBU0VfU1NMX1NFUlZFUk5BTUUgfHwgcHJvY2Vzcy5lbnYuREJfSE9TVCB8fCAnbG9jYWxob3N0J1xuICAgIH1cbiAgfSxcbiAgXG4gIC8vIOWvhueggeWuieWFqOetlueVpVxuICBwYXNzd29yZDoge1xuICAgIC8vIOacgOWwj+WvhueggeW8uuW6puimgeaxglxuICAgIG1pbkxlbmd0aDogMTIsXG4gICAgcmVxdWlyZVVwcGVyY2FzZTogdHJ1ZSxcbiAgICByZXF1aXJlTG93ZXJjYXNlOiB0cnVlLFxuICAgIHJlcXVpcmVOdW1iZXJzOiB0cnVlLFxuICAgIHJlcXVpcmVTcGVjaWFsQ2hhcnM6IHRydWUsXG4gICAgXG4gICAgLy8g56aB55So55qE5byx5a+G56CBXG4gICAgYmxhY2tsaXN0OiBbXG4gICAgICAncGFzc3dvcmQnLCAnMTIzNDU2JywgJ2FkbWluJywgJ3Jvb3QnLCAncG9zdGdyZXMnLFxuICAgICAgJ3Bhc3N3b3JkMTIzJywgJ2FkbWluMTIzJywgJ3F3ZXJ0eScsICcxMjM0NTY3OCdcbiAgICBdLFxuICAgIFxuICAgIC8vIOWvhueggei9ruaNouetlueVpVxuICAgIHJvdGF0aW9uOiB7XG4gICAgICBlbmFibGVkOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxuICAgICAgaW50ZXJ2YWxEYXlzOiA5MCwgLy8gOTDlpKnova7mjaLkuIDmrKFcbiAgICAgIGhpc3RvcnlDb3VudDogNSAgIC8vIOiusOS9j+acgOi/kTXkuKrlr4bnoIFcbiAgICB9XG4gIH0sXG4gIFxuICAvLyDov57mjqXlronlhajphY3nva5cbiAgY29ubmVjdGlvbjoge1xuICAgIC8vIOi/nuaOpei2heaXtumFjee9rlxuICAgIHRpbWVvdXRzOiB7XG4gICAgICBjb25uZWN0aW9uOiBwYXJzZUludChwcm9jZXNzLmVudi5EQVRBQkFTRV9DT05ORUNUSU9OX1RJTUVPVVQpIHx8IDUwMDAsXG4gICAgICBpZGxlOiBwYXJzZUludChwcm9jZXNzLmVudi5EQVRBQkFTRV9JRExFX1RJTUVPVVQpIHx8IDMwMDAwLFxuICAgICAgcXVlcnk6IHBhcnNlSW50KHByb2Nlc3MuZW52LkRBVEFCQVNFX1FVRVJZX1RJTUVPVVQpIHx8IDEwMDAwXG4gICAgfSxcbiAgICBcbiAgICAvLyDov57mjqXmsaDlronlhajphY3nva5cbiAgICBwb29sOiB7XG4gICAgICAvLyDmnIDlpKfov57mjqXmlbDpmZDliLZcbiAgICAgIG1heDoge1xuICAgICAgICBkZXZlbG9wbWVudDogMTAsXG4gICAgICAgIHRlc3Q6IDUsXG4gICAgICAgIHByb2R1Y3Rpb246IHBhcnNlSW50KHByb2Nlc3MuZW52LkRBVEFCQVNFX1BPT0xfTUFYKSB8fCAyMFxuICAgICAgfSxcbiAgICAgIFxuICAgICAgLy8g5pyA5bCP6L+e5o6l5pWwXG4gICAgICBtaW46IHtcbiAgICAgICAgZGV2ZWxvcG1lbnQ6IDIsXG4gICAgICAgIHRlc3Q6IDEsXG4gICAgICAgIHByb2R1Y3Rpb246IHBhcnNlSW50KHByb2Nlc3MuZW52LkRBVEFCQVNFX1BPT0xfTUlOKSB8fCA1XG4gICAgICB9LFxuICAgICAgXG4gICAgICAvLyDov57mjqXojrflj5botoXml7ZcbiAgICAgIGFjcXVpcmU6IHtcbiAgICAgICAgZGV2ZWxvcG1lbnQ6IDMwMDAwLFxuICAgICAgICB0ZXN0OiAzMDAwMCxcbiAgICAgICAgcHJvZHVjdGlvbjogcGFyc2VJbnQocHJvY2Vzcy5lbnYuREFUQUJBU0VfUE9PTF9BQ1FVSVJFKSB8fCA2MDAwMFxuICAgICAgfSxcbiAgICAgIFxuICAgICAgLy8g56m66Zey6L+e5o6l6LaF5pe2XG4gICAgICBpZGxlOiB7XG4gICAgICAgIGRldmVsb3BtZW50OiAxMDAwMCxcbiAgICAgICAgdGVzdDogMTAwMDAsXG4gICAgICAgIHByb2R1Y3Rpb246IHBhcnNlSW50KHByb2Nlc3MuZW52LkRBVEFCQVNFX1BPT0xfSURMRSkgfHwgMzAwMDAwIC8vIDXliIbpkp9cbiAgICAgIH0sXG4gICAgICBcbiAgICAgIC8vIOi/nuaOpempsemAkOmXtOmalFxuICAgICAgZXZpY3Q6IHtcbiAgICAgICAgZGV2ZWxvcG1lbnQ6IDEwMDAsXG4gICAgICAgIHRlc3Q6IDEwMDAsXG4gICAgICAgIHByb2R1Y3Rpb246IHBhcnNlSW50KHByb2Nlc3MuZW52LkRBVEFCQVNFX1BPT0xfRVZJQ1QpIHx8IDUwMDBcbiAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIC8vIElQ55m95ZCN5Y2V77yI55Sf5Lqn546v5aKD77yJXG4gICAgYWxsb3dlZElQczogcHJvY2Vzcy5lbnYuREFUQUJBU0VfQUxMT1dFRF9JUFMgPyBcbiAgICAgIHByb2Nlc3MuZW52LkRBVEFCQVNFX0FMTE9XRURfSVBTLnNwbGl0KCcsJykubWFwKGlwID0+IGlwLnRyaW0oKSkgOiBcbiAgICAgIFsnMTI3LjAuMC4xJywgJzo6MScsICdsb2NhbGhvc3QnXSxcbiAgICBcbiAgICAvLyDov57mjqXph43or5XphY3nva5cbiAgICByZXRyeToge1xuICAgICAgbWF4OiAzLFxuICAgICAgZGVsYXk6IDEwMDAsXG4gICAgICBiYWNrb2ZmOiAnZXhwb25lbnRpYWwnXG4gICAgfVxuICB9LFxuICBcbiAgLy8g5a6h6K6h5ZKM55uR5o6n6YWN572uXG4gIGF1ZGl0OiB7XG4gICAgZW5hYmxlZDogcHJvY2Vzcy5lbnYuREFUQUJBU0VfQVVESVQgPT09ICd0cnVlJyB8fCBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxuICAgIFxuICAgIC8vIOiusOW9leeahOS6i+S7tuexu+Wei1xuICAgIGV2ZW50czoge1xuICAgICAgY29ubmVjdGlvbnM6IHRydWUsXG4gICAgICBxdWVyaWVzOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9BVURJVF9RVUVSSUVTID09PSAndHJ1ZScsXG4gICAgICBlcnJvcnM6IHRydWUsXG4gICAgICBzbG93UXVlcmllczogdHJ1ZSxcbiAgICAgIGZhaWxlZExvZ2luczogdHJ1ZVxuICAgIH0sXG4gICAgXG4gICAgLy8g5oWi5p+l6K+i6ZiI5YC877yI5q+r56eS77yJXG4gICAgc2xvd1F1ZXJ5VGhyZXNob2xkOiBwYXJzZUludChwcm9jZXNzLmVudi5EQVRBQkFTRV9TTE9XX1FVRVJZX1RIUkVTSE9MRCkgfHwgMTAwMCxcbiAgICBcbiAgICAvLyDlrqHorqHml6Xlv5fkv53nlZnmnJ/vvIjlpKnvvIlcbiAgICByZXRlbnRpb25EYXlzOiBwYXJzZUludChwcm9jZXNzLmVudi5EQVRBQkFTRV9BVURJVF9SRVRFTlRJT04pIHx8IDkwXG4gIH0sXG4gIFxuICAvLyDmlbDmja7liqDlr4bphY3nva5cbiAgZW5jcnlwdGlvbjoge1xuICAgIC8vIOmdmeaAgeaVsOaNruWKoOWvhlxuICAgIGF0UmVzdDoge1xuICAgICAgZW5hYmxlZDogcHJvY2Vzcy5lbnYuREFUQUJBU0VfRU5DUllQVElPTl9BVF9SRVNUID09PSAndHJ1ZScsXG4gICAgICBhbGdvcml0aG06ICdhZXMtMjU2LWdjbScsXG4gICAgICBrZXlSb3RhdGlvbkRheXM6IDM2NVxuICAgIH0sXG4gICAgXG4gICAgLy8g5Lyg6L6T5Lit5pWw5o2u5Yqg5a+GXG4gICAgaW5UcmFuc2l0OiB7XG4gICAgICBlbmFibGVkOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9FTkNSWVBUSU9OX0lOX1RSQU5TSVQgPT09ICd0cnVlJyB8fCBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxuICAgICAgbWluVGxzVmVyc2lvbjogJzEuMicsXG4gICAgICBjaXBoZXJTdWl0ZXM6IFtcbiAgICAgICAgJ0VDREhFLVJTQS1BRVMyNTYtR0NNLVNIQTM4NCcsXG4gICAgICAgICdFQ0RIRS1SU0EtQUVTMTI4LUdDTS1TSEEyNTYnLFxuICAgICAgICAnRUNESEUtUlNBLUFFUzI1Ni1TSEEzODQnLFxuICAgICAgICAnRUNESEUtUlNBLUFFUzEyOC1TSEEyNTYnXG4gICAgICBdXG4gICAgfVxuICB9LFxuICBcbiAgLy8g5aSH5Lu95a6J5YWo6YWN572uXG4gIGJhY2t1cDoge1xuICAgIGVuY3J5cHRpb246IHtcbiAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICBhbGdvcml0aG06ICdhZXMtMjU2LWNiYycsXG4gICAgICBrZXlEZXJpdmF0aW9uOiAncGJrZGYyJ1xuICAgIH0sXG4gICAgXG4gICAgLy8g5aSH5Lu96K6/6Zeu5o6n5Yi2XG4gICAgYWNjZXNzOiB7XG4gICAgICByZXF1aXJlTUZBOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxuICAgICAgYWxsb3dlZFVzZXJzOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9CQUNLVVBfVVNFUlMgPyBcbiAgICAgICAgcHJvY2Vzcy5lbnYuREFUQUJBU0VfQkFDS1VQX1VTRVJTLnNwbGl0KCcsJykubWFwKHVzZXIgPT4gdXNlci50cmltKCkpIDogXG4gICAgICAgIFsnYWRtaW4nXVxuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiDojrflj5blvZPliY3njq/looPnmoRTU0zphY3nva5cbiAqIEBwYXJhbSB7c3RyaW5nfSBlbnYgLSDnjq/looPlkI3np7BcbiAqIEByZXR1cm5zIHtvYmplY3R9IFNTTOmFjee9rlxuICovXG5mdW5jdGlvbiBnZXRTU0xDb25maWcoZW52ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ2RldmVsb3BtZW50Jykge1xuICBjb25zdCBjb25maWcgPSBzZWN1cml0eUNvbmZpZy5zc2xbZW52XSB8fCBzZWN1cml0eUNvbmZpZy5zc2wuZGV2ZWxvcG1lbnQ7XG4gIFxuICBpZiAoIWNvbmZpZy5lbmFibGVkKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIFxuICAvLyDmnoTlu7pTU0zphY3nva7lr7nosaFcbiAgY29uc3Qgc3NsQ29uZmlnID0ge1xuICAgIHJlcXVpcmU6IHRydWUsXG4gICAgcmVqZWN0VW5hdXRob3JpemVkOiBjb25maWcucmVqZWN0VW5hdXRob3JpemVkXG4gIH07XG4gIFxuICAvLyDmt7vliqDor4Hkuabmlofku7bvvIjlpoLmnpzlrZjlnKjvvIlcbiAgaWYgKGNvbmZpZy5jZXJ0KSB7c3NsQ29uZmlnLmNlcnQgPSBjb25maWcuY2VydDt9XG4gIGlmIChjb25maWcua2V5KSB7c3NsQ29uZmlnLmtleSA9IGNvbmZpZy5rZXk7fVxuICBpZiAoY29uZmlnLmNhKSB7c3NsQ29uZmlnLmNhID0gY29uZmlnLmNhO31cbiAgaWYgKGNvbmZpZy5zZXJ2ZXJuYW1lKSB7c3NsQ29uZmlnLnNlcnZlcm5hbWUgPSBjb25maWcuc2VydmVybmFtZTt9XG4gIGlmIChjb25maWcuY2hlY2tTZXJ2ZXJJZGVudGl0eSkge3NzbENvbmZpZy5jaGVja1NlcnZlcklkZW50aXR5ID0gY29uZmlnLmNoZWNrU2VydmVySWRlbnRpdHk7fVxuICBcbiAgcmV0dXJuIHNzbENvbmZpZztcbn1cblxuLyoqXG4gKiDpqozor4Hlr4bnoIHlvLrluqZcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXNzd29yZCAtIOWvhueggVxuICogQHJldHVybnMge29iamVjdH0g6aqM6K+B57uT5p6cXG4gKi9cbmZ1bmN0aW9uIHZhbGlkYXRlUGFzc3dvcmQocGFzc3dvcmQpIHtcbiAgY29uc3QgY29uZmlnID0gc2VjdXJpdHlDb25maWcucGFzc3dvcmQ7XG4gIGNvbnN0IGVycm9ycyA9IFtdO1xuICBcbiAgLy8g5qOA5p+l6ZW/5bqmXG4gIGlmIChwYXNzd29yZC5sZW5ndGggPCBjb25maWcubWluTGVuZ3RoKSB7XG4gICAgZXJyb3JzLnB1c2goYOWvhueggemVv+W6puiHs+WwkemcgOimgSR7Y29uZmlnLm1pbkxlbmd0aH3kuKrlrZfnrKZgKTtcbiAgfVxuICBcbiAgLy8g5qOA5p+l5aSn5YaZ5a2X5q+NXG4gIGlmIChjb25maWcucmVxdWlyZVVwcGVyY2FzZSAmJiAhL1tBLVpdLy50ZXN0KHBhc3N3b3JkKSkge1xuICAgIGVycm9ycy5wdXNoKCflr4bnoIHlv4XpobvljIXlkKvoh7PlsJHkuIDkuKrlpKflhpnlrZfmr40nKTtcbiAgfVxuICBcbiAgLy8g5qOA5p+l5bCP5YaZ5a2X5q+NXG4gIGlmIChjb25maWcucmVxdWlyZUxvd2VyY2FzZSAmJiAhL1thLXpdLy50ZXN0KHBhc3N3b3JkKSkge1xuICAgIGVycm9ycy5wdXNoKCflr4bnoIHlv4XpobvljIXlkKvoh7PlsJHkuIDkuKrlsI/lhpnlrZfmr40nKTtcbiAgfVxuICBcbiAgLy8g5qOA5p+l5pWw5a2XXG4gIGlmIChjb25maWcucmVxdWlyZU51bWJlcnMgJiYgIS9cXGQvLnRlc3QocGFzc3dvcmQpKSB7XG4gICAgZXJyb3JzLnB1c2goJ+WvhueggeW/hemhu+WMheWQq+iHs+WwkeS4gOS4quaVsOWtlycpO1xuICB9XG4gIFxuICAvLyDmo4Dmn6XnibnmrorlrZfnrKZcbiAgaWYgKGNvbmZpZy5yZXF1aXJlU3BlY2lhbENoYXJzICYmICEvWyFAIyQlXiYqKClfK1xcLT1cXFtcXF17fTsnOlwiXFxcXHwsLjw+XFwvP10vLnRlc3QocGFzc3dvcmQpKSB7XG4gICAgZXJyb3JzLnB1c2goJ+WvhueggeW/hemhu+WMheWQq+iHs+WwkeS4gOS4queJueauiuWtl+espicpO1xuICB9XG4gIFxuICAvLyDmo4Dmn6Xpu5HlkI3ljZVcbiAgaWYgKGNvbmZpZy5ibGFja2xpc3QuaW5jbHVkZXMocGFzc3dvcmQudG9Mb3dlckNhc2UoKSkpIHtcbiAgICBlcnJvcnMucHVzaCgn5a+G56CB6L+H5LqO566A5Y2V77yM6K+36YCJ5oup5pu05by655qE5a+G56CBJyk7XG4gIH1cbiAgXG4gIHJldHVybiB7XG4gICAgdmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgZXJyb3JzLFxuICAgIHN0cmVuZ3RoOiBjYWxjdWxhdGVQYXNzd29yZFN0cmVuZ3RoKHBhc3N3b3JkKVxuICB9O1xufVxuXG4vKipcbiAqIOiuoeeul+WvhueggeW8uuW6plxuICogQHBhcmFtIHtzdHJpbmd9IHBhc3N3b3JkIC0g5a+G56CBXG4gKiBAcmV0dXJucyB7bnVtYmVyfSDlvLrluqbliIbmlbAgKDAtMTAwKVxuICovXG5mdW5jdGlvbiBjYWxjdWxhdGVQYXNzd29yZFN0cmVuZ3RoKHBhc3N3b3JkKSB7XG4gIGxldCBzY29yZSA9IDA7XG4gIFxuICAvLyDplb/luqbliIbmlbBcbiAgc2NvcmUgKz0gTWF0aC5taW4ocGFzc3dvcmQubGVuZ3RoICogNCwgMjUpO1xuICBcbiAgLy8g5a2X56ym57G75Z6L5YiG5pWwXG4gIGlmICgvW2Etel0vLnRlc3QocGFzc3dvcmQpKSB7c2NvcmUgKz0gNTt9XG4gIGlmICgvW0EtWl0vLnRlc3QocGFzc3dvcmQpKSB7c2NvcmUgKz0gNTt9XG4gIGlmICgvXFxkLy50ZXN0KHBhc3N3b3JkKSkge3Njb3JlICs9IDU7fVxuICBpZiAoL1shQCMkJV4mKigpXytcXC09XFxbXFxde307JzpcIlxcXFx8LC48PlxcLz9dLy50ZXN0KHBhc3N3b3JkKSkge3Njb3JlICs9IDEwO31cbiAgXG4gIC8vIOWkjeadguW6puWIhuaVsFxuICBjb25zdCB1bmlxdWVDaGFycyA9IG5ldyBTZXQocGFzc3dvcmQpLnNpemU7XG4gIHNjb3JlICs9IE1hdGgubWluKHVuaXF1ZUNoYXJzICogMiwgMjApO1xuICBcbiAgLy8g5qih5byP5qOA5p+l77yI5YeP5YiG77yJXG4gIGlmICgvMTIzfGFiY3xxd2UvaS50ZXN0KHBhc3N3b3JkKSkge3Njb3JlIC09IDEwO31cbiAgaWYgKC8oLi4pLipcXDEvLnRlc3QocGFzc3dvcmQpKSB7c2NvcmUgLT0gMTA7fSAvLyDph43lpI3mqKHlvI9cbiAgXG4gIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLm1pbigxMDAsIHNjb3JlKSk7XG59XG5cbi8qKlxuICog55Sf5oiQ5by65a+G56CBXG4gKiBAcGFyYW0ge251bWJlcn0gbGVuZ3RoIC0g5a+G56CB6ZW/5bqmXG4gKiBAcmV0dXJucyB7c3RyaW5nfSDnlJ/miJDnmoTlr4bnoIFcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVTdHJvbmdQYXNzd29yZChsZW5ndGggPSAxNikge1xuICBjb25zdCBsb3dlcmNhc2UgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonO1xuICBjb25zdCB1cHBlcmNhc2UgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonO1xuICBjb25zdCBudW1iZXJzID0gJzAxMjM0NTY3ODknO1xuICBjb25zdCBzeW1ib2xzID0gJyFAIyQlXiYqKClfKy09W117fXw7OiwuPD4/JztcbiAgXG4gIGNvbnN0IGFsbENoYXJzID0gbG93ZXJjYXNlICsgdXBwZXJjYXNlICsgbnVtYmVycyArIHN5bWJvbHM7XG4gIGxldCBwYXNzd29yZCA9ICcnO1xuICBcbiAgLy8g56Gu5L+d6Iez5bCR5YyF5ZCr5q+P56eN57G75Z6L55qE5a2X56ymXG4gIHBhc3N3b3JkICs9IGxvd2VyY2FzZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBsb3dlcmNhc2UubGVuZ3RoKV07XG4gIHBhc3N3b3JkICs9IHVwcGVyY2FzZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB1cHBlcmNhc2UubGVuZ3RoKV07XG4gIHBhc3N3b3JkICs9IG51bWJlcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbnVtYmVycy5sZW5ndGgpXTtcbiAgcGFzc3dvcmQgKz0gc3ltYm9sc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzeW1ib2xzLmxlbmd0aCldO1xuICBcbiAgLy8g5aGr5YWF5Ymp5L2Z6ZW/5bqmXG4gIGZvciAobGV0IGkgPSBwYXNzd29yZC5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIHBhc3N3b3JkICs9IGFsbENoYXJzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFsbENoYXJzLmxlbmd0aCldO1xuICB9XG4gIFxuICAvLyDmiZPkubHlrZfnrKbpobrluo9cbiAgcmV0dXJuIHBhc3N3b3JkLnNwbGl0KCcnKS5zb3J0KCgpID0+IE1hdGgucmFuZG9tKCkgLSAwLjUpLmpvaW4oJycpO1xufVxuXG4vKipcbiAqIOiOt+WPluW9k+WJjeeOr+Wig+eahOi/nuaOpeaxoOmFjee9rlxuICogQHBhcmFtIHtzdHJpbmd9IGVudiAtIOeOr+Wig+WQjeensFxuICogQHJldHVybnMge29iamVjdH0g6L+e5o6l5rGg6YWN572uXG4gKi9cbmZ1bmN0aW9uIGdldFBvb2xDb25maWcoZW52ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgfHwgJ2RldmVsb3BtZW50Jykge1xuICBjb25zdCBwb29sQ29uZmlnID0gc2VjdXJpdHlDb25maWcuY29ubmVjdGlvbi5wb29sO1xuICBcbiAgcmV0dXJuIHtcbiAgICBtYXg6IHBvb2xDb25maWcubWF4W2Vudl0gfHwgcG9vbENvbmZpZy5tYXguZGV2ZWxvcG1lbnQsXG4gICAgbWluOiBwb29sQ29uZmlnLm1pbltlbnZdIHx8IHBvb2xDb25maWcubWluLmRldmVsb3BtZW50LFxuICAgIGFjcXVpcmU6IHBvb2xDb25maWcuYWNxdWlyZVtlbnZdIHx8IHBvb2xDb25maWcuYWNxdWlyZS5kZXZlbG9wbWVudCxcbiAgICBpZGxlOiBwb29sQ29uZmlnLmlkbGVbZW52XSB8fCBwb29sQ29uZmlnLmlkbGUuZGV2ZWxvcG1lbnQsXG4gICAgZXZpY3Q6IHBvb2xDb25maWcuZXZpY3RbZW52XSB8fCBwb29sQ29uZmlnLmV2aWN0LmRldmVsb3BtZW50XG4gIH07XG59XG5cbi8qKlxuICog6aqM6K+B5pWw5o2u5bqT5a6J5YWo6YWN572uXG4gKiBAcGFyYW0ge3N0cmluZ30gZW52IC0g546v5aKD5ZCN56ewXG4gKiBAcmV0dXJucyB7b2JqZWN0fSDpqozor4Hnu5PmnpxcbiAqL1xuZnVuY3Rpb24gdmFsaWRhdGVTZWN1cml0eUNvbmZpZyhlbnYgPSBwcm9jZXNzLmVudi5OT0RFX0VOViB8fCAnZGV2ZWxvcG1lbnQnKSB7XG4gIGNvbnN0IGlzc3VlcyA9IFtdO1xuICBjb25zdCB3YXJuaW5ncyA9IFtdO1xuICBcbiAgLy8g5qOA5p+lU1NM6YWN572uXG4gIGlmIChlbnYgPT09ICdwcm9kdWN0aW9uJyAmJiAhc2VjdXJpdHlDb25maWcuc3NsLnByb2R1Y3Rpb24uZW5hYmxlZCkge1xuICAgIGlzc3Vlcy5wdXNoKCfnlJ/kuqfnjq/looPlv4XpobvlkK/nlKhTU0zliqDlr4YnKTtcbiAgfVxuICBcbiAgLy8g5qOA5p+l5a+G56CB6YWN572uXG4gIGlmICghcHJvY2Vzcy5lbnYuREJfUEFTU1dPUkQgfHwgcHJvY2Vzcy5lbnYuREJfUEFTU1dPUkQubGVuZ3RoIDwgc2VjdXJpdHlDb25maWcucGFzc3dvcmQubWluTGVuZ3RoKSB7XG4gICAgaXNzdWVzLnB1c2goYOaVsOaNruW6k+WvhueggemVv+W6puiHs+WwkemcgOimgSR7c2VjdXJpdHlDb25maWcucGFzc3dvcmQubWluTGVuZ3RofeS4quWtl+espmApO1xuICB9XG4gIFxuICAvLyDmo4Dmn6XlrqHorqHphY3nva5cbiAgaWYgKGVudiA9PT0gJ3Byb2R1Y3Rpb24nICYmICFzZWN1cml0eUNvbmZpZy5hdWRpdC5lbmFibGVkKSB7XG4gICAgd2FybmluZ3MucHVzaCgn5bu66K6u5Zyo55Sf5Lqn546v5aKD5ZCv55So5pWw5o2u5bqT5a6h6K6hJyk7XG4gIH1cbiAgXG4gIC8vIOajgOafpei/nuaOpei2heaXtumFjee9rlxuICBjb25zdCB0aW1lb3V0cyA9IHNlY3VyaXR5Q29uZmlnLmNvbm5lY3Rpb24udGltZW91dHM7XG4gIGlmICh0aW1lb3V0cy5jb25uZWN0aW9uID4gMTAwMDApIHtcbiAgICB3YXJuaW5ncy5wdXNoKCfov57mjqXotoXml7bml7bpl7Tov4fplb/vvIzlj6/og73lvbHlk43lronlhajmgKcnKTtcbiAgfVxuICBcbiAgcmV0dXJuIHtcbiAgICB2YWxpZDogaXNzdWVzLmxlbmd0aCA9PT0gMCxcbiAgICBpc3N1ZXMsXG4gICAgd2FybmluZ3MsXG4gICAgc2NvcmU6IGNhbGN1bGF0ZVNlY3VyaXR5U2NvcmUoZW52KVxuICB9O1xufVxuXG4vKipcbiAqIOiuoeeul+WuieWFqOmFjee9ruWIhuaVsFxuICogQHBhcmFtIHtzdHJpbmd9IGVudiAtIOeOr+Wig+WQjeensFxuICogQHJldHVybnMge251bWJlcn0g5a6J5YWo5YiG5pWwICgwLTEwMClcbiAqL1xuZnVuY3Rpb24gY2FsY3VsYXRlU2VjdXJpdHlTY29yZShlbnYgPSBwcm9jZXNzLmVudi5OT0RFX0VOViB8fCAnZGV2ZWxvcG1lbnQnKSB7XG4gIGxldCBzY29yZSA9IDA7XG4gIFxuICAvLyBTU0zphY3nva4gKDMw5YiGKVxuICBpZiAoc2VjdXJpdHlDb25maWcuc3NsW2Vudl0/LmVuYWJsZWQpIHtcbiAgICBzY29yZSArPSAzMDtcbiAgICBpZiAoc2VjdXJpdHlDb25maWcuc3NsW2Vudl0/LnJlamVjdFVuYXV0aG9yaXplZCkge3Njb3JlICs9IDEwO31cbiAgfVxuICBcbiAgLy8g5a+G56CB5by65bqmICgyNeWIhilcbiAgaWYgKHByb2Nlc3MuZW52LkRCX1BBU1NXT1JEKSB7XG4gICAgY29uc3QgcGFzc3dvcmRWYWxpZGF0aW9uID0gdmFsaWRhdGVQYXNzd29yZChwcm9jZXNzLmVudi5EQl9QQVNTV09SRCk7XG4gICAgc2NvcmUgKz0gTWF0aC5mbG9vcihwYXNzd29yZFZhbGlkYXRpb24uc3RyZW5ndGggKiAwLjI1KTtcbiAgfVxuICBcbiAgLy8g5a6h6K6h6YWN572uICgyMOWIhilcbiAgaWYgKHNlY3VyaXR5Q29uZmlnLmF1ZGl0LmVuYWJsZWQpIHtcbiAgICBzY29yZSArPSAyMDtcbiAgfVxuICBcbiAgLy8g6L+e5o6l5a6J5YWoICgxNeWIhilcbiAgY29uc3QgdGltZW91dHMgPSBzZWN1cml0eUNvbmZpZy5jb25uZWN0aW9uLnRpbWVvdXRzO1xuICBpZiAodGltZW91dHMuY29ubmVjdGlvbiA8PSA1MDAwKSB7c2NvcmUgKz0gNTt9XG4gIGlmICh0aW1lb3V0cy5pZGxlIDw9IDMwMDAwKSB7c2NvcmUgKz0gNTt9XG4gIGlmICh0aW1lb3V0cy5xdWVyeSA8PSAxMDAwMCkge3Njb3JlICs9IDU7fVxuICBcbiAgLy8g5Yqg5a+G6YWN572uICgxMOWIhilcbiAgaWYgKHNlY3VyaXR5Q29uZmlnLmVuY3J5cHRpb24uaW5UcmFuc2l0LmVuYWJsZWQpIHtzY29yZSArPSA1O31cbiAgaWYgKHNlY3VyaXR5Q29uZmlnLmVuY3J5cHRpb24uYXRSZXN0LmVuYWJsZWQpIHtzY29yZSArPSA1O31cbiAgXG4gIHJldHVybiBNYXRoLm1pbigxMDAsIHNjb3JlKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHNlY3VyaXR5Q29uZmlnLFxuICBnZXRTU0xDb25maWcsXG4gIHZhbGlkYXRlUGFzc3dvcmQsXG4gIGNhbGN1bGF0ZVBhc3N3b3JkU3RyZW5ndGgsXG4gIGdlbmVyYXRlU3Ryb25nUGFzc3dvcmQsXG4gIGdldFBvb2xDb25maWcsXG4gIHZhbGlkYXRlU2VjdXJpdHlDb25maWcsXG4gIGNhbGN1bGF0ZVNlY3VyaXR5U2NvcmVcbn07Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTUEsRUFBRSxHQUFHQyxPQUFPLENBQUMsSUFBSSxDQUFDO0FBQ3hCLE1BQU1DLElBQUksR0FBR0QsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUM1QixNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxRQUFRLENBQUM7O0FBRWhDO0FBQ0EsTUFBTUcsYUFBYSxHQUFHRixJQUFJLENBQUNHLElBQUksQ0FBQ0MsT0FBTyxDQUFDQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsWUFBWSxDQUFDO0FBQzVFLE1BQU1DLFlBQVksR0FBR04sSUFBSSxDQUFDRyxJQUFJLENBQUNDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLFlBQVksQ0FBQztBQUMzRSxNQUFNRSxXQUFXLEdBQUdQLElBQUksQ0FBQ0csSUFBSSxDQUFDQyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxRQUFRLENBQUM7O0FBRXRFO0FBQ0E7QUFDQTtBQUNBLE1BQU1HLGNBQWMsR0FBRztFQUNyQjtFQUNBQyxHQUFHLEVBQUU7SUFDSDtJQUNBQyxXQUFXLEVBQUU7TUFDWEMsT0FBTyxF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