{"version":3,"names":["cov_26ruc71qx4","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","type","locations","undefined","s","f","b","inputSourceMap","file","mappings","names","sources","sourcesContent","version","_coverageSchema","coverage","actualCoverage","server_1","require","api_route_wrapper_1","api_helper_1","runtime_1","agent_manager_1","exports","POST","createApiRoute","RouteConfigs","protectedPost","req","params","validatedBody","validatedQuery","user","requestId","body","json","threadId","runId","appId","apiKey","messages","tools","state","config","ApiResponseWrapper","error","status","agentManager","AgUIAgentManager","agent","createAgentFromFastGPT","runtime","AgUIRuntime","debug","process","env","NODE_ENV","apiEndpoint","setAgent","stream","ReadableStream","controller","subscription","getEventStream","subscribe","next","event","data","JSON","stringify","enqueue","TextEncoder","encode","console","errorEvent","message","details","timestamp","Date","now","close","complete","run","catch","unsubscribe","dispose","NextResponse","headers","Connection"],"sources":["E:\\zk-agent\\app\\api\\ag-ui\\standard\\chat\\route.ts"],"sourcesContent":["/**\n * @file ag-ui\\standard\\chat\\route.ts\n * @description Migrated API route with global error handling\n * @author ZK-Agent Team\n * @date 2025-06-25\n */\n\nimport { NextRequest, NextResponse } from 'next/server';\nimport { createApiRoute, RouteConfigs, CommonValidations } from '@/lib/middleware/api-route-wrapper';\nimport { ApiResponseWrapper } from '@/lib/utils/api-helper';\nimport { AgUIRuntime } from \"@/lib/ag-ui/protocol/runtime\"\nimport { AgUIAgentManager } from \"@/lib/ag-ui/protocol/agent-manager\"\n\nexport const POST = createApiRoute(\n  RouteConfigs.protectedPost(),\n  async (req: NextRequest, { params, validatedBody, validatedQuery, user, requestId }) => {\n    try {\n      const body = await req.json()\n      const { threadId, runId, appId, apiKey, messages, tools, state, config } = body\n    \n      // 验证必需参数\n      if (!threadId || !runId || !appId || !messages) {\n        return ApiResponseWrapper.error(\n          \"Missing required parameters: threadId, runId, appId, messages\",\n          { status: 400 }\n        )\n      }\n    \n        // 创建智能体管理器\n        const agentManager = new AgUIAgentManager()\n    \n        // 从FastGPT创建智能体定义\n        const agent = await agentManager.createAgentFromFastGPT(appId, apiKey)\n    \n        // 创建运行时\n        const runtime = new AgUIRuntime({\n          threadId,\n          debug: process.env.NODE_ENV === \"development\",\n          apiEndpoint: \"/api/fastgpt/chat\",\n        })\n    \n        // 设置智能体\n        runtime.setAgent(agent)\n    \n        // 创建可读流用于SSE\n        const stream = new ReadableStream({\n          start(controller) {\n            // 订阅事件流\n            const subscription = runtime.getEventStream().subscribe({\n              next: (event) => {\n                // 发送AG-UI事件\n                const data = `data: ${JSON.stringify(event)}\\n\\n`\n                controller.enqueue(new TextEncoder().encode(data))\n              },\n              error: (error) => {\n                console.error('Runtime error:', error)\n                const errorEvent = {\n                  type: \"run-error\",\n                  threadId,\n                  runId,\n                  error: {\n                    message: error.message,\n                    details: error,\n                  },\n                  timestamp: Date.now(),\n                }\n                const data = `data: ${JSON.stringify(errorEvent)}\\n\\n`\n                controller.enqueue(new TextEncoder().encode(data))\n                controller.close()\n              },\n              complete: () => {\n                controller.close()\n              },\n            })\n    \n            // 执行运行\n            runtime\n              .run(\n                {\n                  threadId,\n                  runId,\n                  messages,\n                  tools: tools || agent.tools,\n                  state: state || {},\n                },\n                config,\n              )\n              .catch((error) => {\n                console.error('Runtime execution error:', error)\n                const errorEvent = {\n                  type: \"run-error\",\n                  threadId,\n                  runId,\n                  error: {\n                    message: error.message,\n                    details: error,\n                  },\n                  timestamp: Date.now(),\n                }\n                const data = `data: ${JSON.stringify(errorEvent)}\\n\\n`\n                controller.enqueue(new TextEncoder().encode(data))\n                controller.close()\n              })\n    \n            // 清理函数\n            return () => {\n              subscription.unsubscribe()\n              runtime.dispose()\n            }\n          },\n        })\n    \n        // 返回SSE响应\n        return new NextResponse(stream, {\n          headers: {\n            \"Content-Type\": \"text/event-stream\",\n            \"Cache-Control\": \"no-cache\",\n            Connection: \"keep-alive\",\n            \"Access-Control-Allow-Origin\": \"*\",\n            \"Access-Control-Allow-Methods\": \"GET, POST, PUT, DELETE, OPTIONS\",\n            \"Access-Control-Allow-Headers\": \"Content-Type, Authorization\",\n          },\n        })\n    } catch (error) {\n      return ApiResponseWrapper.error(\n        \"Internal server error\",\n        { status: 500 }\n      )\n    }\n  }\n);\n\n"],"mappings":";;AAAA;;;;;;AAAA;AAAA,SAAAA,eAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,IAAA;EAAA,IAAAC,MAAA,OAAAC,QAAA;EAAA,IAAAC,GAAA;EAAA,IAAAC,YAAA;IAAAL,IAAA;IAAAM,YAAA;MAAA;QAAAC,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UAAAC,IAAA;UAAAC,MAAA;QAAA;QAAAC,GAAA;UAAAF,IAAA;UAAAC,MAAA;QAAA;MAAA;MAAA;QAAAF,KAAA;UA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","ignoreList":[]}