2efae0c6c4db78e9fdab67a9949fe253
"use strict";

/* istanbul ignore next */
function cov_2127y02m6n() {
  var path = "E:\\zk-agent\\lib\\ag-ui\\protocol\\enhanced-runtime.ts";
  var hash = "53c5732e5253abae13ffe9a0200fd0ea85a5d681";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "E:\\zk-agent\\lib\\ag-ui\\protocol\\enhanced-runtime.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 2,
          column: 62
        }
      },
      "1": {
        start: {
          line: 3,
          column: 0
        },
        end: {
          line: 3,
          column: 37
        }
      },
      "2": {
        start: {
          line: 5,
          column: 18
        },
        end: {
          line: 5,
          column: 38
        }
      },
      "3": {
        start: {
          line: 6,
          column: 21
        },
        end: {
          line: 6,
          column: 44
        }
      },
      "4": {
        start: {
          line: 7,
          column: 24
        },
        end: {
          line: 7,
          column: 50
        }
      },
      "5": {
        start: {
          line: 8,
          column: 22
        },
        end: {
          line: 8,
          column: 46
        }
      },
      "6": {
        start: {
          line: 9,
          column: 18
        },
        end: {
          line: 9,
          column: 38
        }
      },
      "7": {
        start: {
          line: 16,
          column: 8
        },
        end: {
          line: 16,
          column: 22
        }
      },
      "8": {
        start: {
          line: 17,
          column: 8
        },
        end: {
          line: 17,
          column: 44
        }
      },
      "9": {
        start: {
          line: 19,
          column: 8
        },
        end: {
          line: 19,
          column: 74
        }
      },
      "10": {
        start: {
          line: 21,
          column: 8
        },
        end: {
          line: 21,
          column: 63
        }
      },
      "11": {
        start: {
          line: 23,
          column: 8
        },
        end: {
          line: 29,
          column: 9
        }
      },
      "12": {
        start: {
          line: 24,
          column: 12
        },
        end: {
          line: 24,
          column: 105
        }
      },
      "13": {
        start: {
          line: 25,
          column: 12
        },
        end: {
          line: 25,
          column: 86
        }
      },
      "14": {
        start: {
          line: 26,
          column: 12
        },
        end: {
          line: 28,
          column: 13
        }
      },
      "15": {
        start: {
          line: 27,
          column: 16
        },
        end: {
          line: 27,
          column: 109
        }
      },
      "16": {
        start: {
          line: 31,
          column: 8
        },
        end: {
          line: 36,
          column: 9
        }
      },
      "17": {
        start: {
          line: 32,
          column: 12
        },
        end: {
          line: 32,
          column: 74
        }
      },
      "18": {
        start: {
          line: 33,
          column: 12
        },
        end: {
          line: 33,
          column: 76
        }
      },
      "19": {
        start: {
          line: 34,
          column: 12
        },
        end: {
          line: 34,
          column: 78
        }
      },
      "20": {
        start: {
          line: 35,
          column: 12
        },
        end: {
          line: 35,
          column: 82
        }
      },
      "21": {
        start: {
          line: 38,
          column: 8
        },
        end: {
          line: 38,
          column: 44
        }
      },
      "22": {
        start: {
          line: 44,
          column: 8
        },
        end: {
          line: 61,
          column: 9
        }
      },
      "23": {
        start: {
          line: 46,
          column: 12
        },
        end: {
          line: 50,
          column: 13
        }
      },
      "24": {
        start: {
          line: 47,
          column: 16
        },
        end: {
          line: 49,
          column: 17
        }
      },
      "25": {
        start: {
          line: 48,
          column: 20
        },
        end: {
          line: 48,
          column: 191
        }
      },
      "26": {
        start: {
          line: 52,
          column: 12
        },
        end: {
          line: 56,
          column: 13
        }
      },
      "27": {
        start: {
          line: 53,
          column: 16
        },
        end: {
          line: 55,
          column: 17
        }
      },
      "28": {
        start: {
          line: 54,
          column: 20
        },
        end: {
          line: 54,
          column: 85
        }
      },
      "29": {
        start: {
          line: 57,
          column: 12
        },
        end: {
          line: 57,
          column: 34
        }
      },
      "30": {
        start: {
          line: 60,
          column: 12
        },
        end: {
          line: 60,
          column: 87
        }
      },
      "31": {
        start: {
          line: 67,
          column: 26
        },
        end: {
          line: 67,
          column: 36
        }
      },
      "32": {
        start: {
          line: 68,
          column: 8
        },
        end: {
          line: 95,
          column: 9
        }
      },
      "33": {
        start: {
          line: 70,
          column: 35
        },
        end: {
          line: 70,
          column: 81
        }
      },
      "34": {
        start: {
          line: 72,
          column: 12
        },
        end: {
          line: 76,
          column: 15
        }
      },
      "35": {
        start: {
          line: 78,
          column: 12
        },
        end: {
          line: 78,
          column: 52
        }
      },
      "36": {
        start: {
          line: 80,
          column: 27
        },
        end: {
          line: 80,
          column: 67
        }
      },
      "37": {
        start: {
          line: 81,
          column: 12
        },
        end: {
          line: 84,
          column: 13
        }
      },
      "38": {
        start: {
          line: 82,
          column: 16
        },
        end: {
          line: 82,
          column: 44
        }
      },
      "39": {
        start: {
          line: 83,
          column: 16
        },
        end: {
          line: 83,
          column: 68
        }
      },
      "40": {
        start: {
          line: 88,
          column: 35
        },
        end: {
          line: 91,
          column: 14
        }
      },
      "41": {
        start: {
          line: 92,
          column: 12
        },
        end: {
          line: 94,
          column: 13
        }
      },
      "42": {
        start: {
          line: 93,
          column: 16
        },
        end: {
          line: 93,
          column: 37
        }
      },
      "43": {
        start: {
          line: 101,
          column: 8
        },
        end: {
          line: 121,
          column: 9
        }
      },
      "44": {
        start: {
          line: 102,
          column: 23
        },
        end: {
          line: 102,
          column: 25
        }
      },
      "45": {
        start: {
          line: 103,
          column: 12
        },
        end: {
          line: 108,
          column: 13
        }
      },
      "46": {
        start: {
          line: 104,
          column: 16
        },
        end: {
          line: 104,
          column: 44
        }
      },
      "47": {
        start: {
          line: 107,
          column: 16
        },
        end: {
          line: 107,
          column: 151
        }
      },
      "48": {
        start: {
          line: 110,
          column: 12
        },
        end: {
          line: 115,
          column: 13
        }
      },
      "49": {
        start: {
          line: 111,
          column: 16
        },
        end: {
          line: 114,
          column: 19
        }
      },
      "50": {
        start: {
          line: 117,
          column: 12
        },
        end: {
          line: 117,
          column: 63
        }
      },
      "51": {
        start: {
          line: 120,
          column: 12
        },
        end: {
          line: 120,
          column: 88
        }
      },
      "52": {
        start: {
          line: 127,
          column: 8
        },
        end: {
          line: 138,
          column: 9
        }
      },
      "53": {
        start: {
          line: 129,
          column: 35
        },
        end: {
          line: 129,
          column: 77
        }
      },
      "54": {
        start: {
          line: 130,
          column: 12
        },
        end: {
          line: 132,
          column: 13
        }
      },
      "55": {
        start: {
          line: 131,
          column: 16
        },
        end: {
          line: 131,
          column: 48
        }
      },
      "56": {
        start: {
          line: 135,
          column: 12
        },
        end: {
          line: 135,
          column: 79
        }
      },
      "57": {
        start: {
          line: 137,
          column: 12
        },
        end: {
          line: 137,
          column: 35
        }
      },
      "58": {
        start: {
          line: 144,
          column: 8
        },
        end: {
          line: 144,
          column: 45
        }
      },
      "59": {
        start: {
          line: 150,
          column: 8
        },
        end: {
          line: 150,
          column: 52
        }
      },
      "60": {
        start: {
          line: 156,
          column: 23
        },
        end: {
          line: 156,
          column: 25
        }
      },
      "61": {
        start: {
          line: 157,
          column: 8
        },
        end: {
          line: 159,
          column: 9
        }
      },
      "62": {
        start: {
          line: 158,
          column: 12
        },
        end: {
          line: 158,
          column: 42
        }
      },
      "63": {
        start: {
          line: 160,
          column: 8
        },
        end: {
          line: 160,
          column: 22
        }
      },
      "64": {
        start: {
          line: 166,
          column: 8
        },
        end: {
          line: 166,
          column: 48
        }
      },
      "65": {
        start: {
          line: 172,
          column: 8
        },
        end: {
          line: 172,
          column: 70
        }
      },
      "66": {
        start: {
          line: 178,
          column: 24
        },
        end: {
          line: 183,
          column: 9
        }
      },
      "67": {
        start: {
          line: 184,
          column: 8
        },
        end: {
          line: 199,
          column: 9
        }
      },
      "68": {
        start: {
          line: 186,
          column: 30
        },
        end: {
          line: 191,
          column: 13
        }
      },
      "69": {
        start: {
          line: 192,
          column: 12
        },
        end: {
          line: 192,
          column: 59
        }
      },
      "70": {
        start: {
          line: 193,
          column: 12
        },
        end: {
          line: 193,
          column: 39
        }
      },
      "71": {
        start: {
          line: 194,
          column: 12
        },
        end: {
          line: 194,
          column: 50
        }
      },
      "72": {
        start: {
          line: 197,
          column: 12
        },
        end: {
          line: 197,
          column: 83
        }
      },
      "73": {
        start: {
          line: 198,
          column: 12
        },
        end: {
          line: 198,
          column: 52
        }
      },
      "74": {
        start: {
          line: 206,
          column: 8
        },
        end: {
          line: 206,
          column: 41
        }
      },
      "75": {
        start: {
          line: 208,
          column: 8
        },
        end: {
          line: 208,
          column: 40
        }
      },
      "76": {
        start: {
          line: 210,
          column: 8
        },
        end: {
          line: 210,
          column: 24
        }
      },
      "77": {
        start: {
          line: 213,
          column: 0
        },
        end: {
          line: 213,
          column: 50
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 15,
            column: 4
          },
          end: {
            line: 15,
            column: 5
          }
        },
        loc: {
          start: {
            line: 15,
            column: 24
          },
          end: {
            line: 39,
            column: 5
          }
        },
        line: 15
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 43,
            column: 4
          },
          end: {
            line: 43,
            column: 5
          }
        },
        loc: {
          start: {
            line: 43,
            column: 20
          },
          end: {
            line: 62,
            column: 5
          }
        },
        line: 43
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 66,
            column: 4
          },
          end: {
            line: 66,
            column: 5
          }
        },
        loc: {
          start: {
            line: 66,
            column: 29
          },
          end: {
            line: 96,
            column: 5
          }
        },
        line: 66
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 100,
            column: 4
          },
          end: {
            line: 100,
            column: 5
          }
        },
        loc: {
          start: {
            line: 100,
            column: 42
          },
          end: {
            line: 122,
            column: 5
          }
        },
        line: 100
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 126,
            column: 4
          },
          end: {
            line: 126,
            column: 5
          }
        },
        loc: {
          start: {
            line: 126,
            column: 21
          },
          end: {
            line: 139,
            column: 5
          }
        },
        line: 126
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 143,
            column: 4
          },
          end: {
            line: 143,
            column: 5
          }
        },
        loc: {
          start: {
            line: 143,
            column: 27
          },
          end: {
            line: 145,
            column: 5
          }
        },
        line: 143
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 149,
            column: 4
          },
          end: {
            line: 149,
            column: 5
          }
        },
        loc: {
          start: {
            line: 149,
            column: 35
          },
          end: {
            line: 151,
            column: 5
          }
        },
        line: 149
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 155,
            column: 4
          },
          end: {
            line: 155,
            column: 5
          }
        },
        loc: {
          start: {
            line: 155,
            column: 28
          },
          end: {
            line: 161,
            column: 5
          }
        },
        line: 155
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 165,
            column: 4
          },
          end: {
            line: 165,
            column: 5
          }
        },
        loc: {
          start: {
            line: 165,
            column: 24
          },
          end: {
            line: 167,
            column: 5
          }
        },
        line: 165
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 171,
            column: 4
          },
          end: {
            line: 171,
            column: 5
          }
        },
        loc: {
          start: {
            line: 171,
            column: 21
          },
          end: {
            line: 173,
            column: 5
          }
        },
        line: 171
      },
      "10": {
        name: "(anonymous_10)",
        decl: {
          start: {
            line: 177,
            column: 4
          },
          end: {
            line: 177,
            column: 5
          }
        },
        loc: {
          start: {
            line: 177,
            column: 24
          },
          end: {
            line: 200,
            column: 5
          }
        },
        line: 177
      },
      "11": {
        name: "(anonymous_11)",
        decl: {
          start: {
            line: 204,
            column: 4
          },
          end: {
            line: 204,
            column: 5
          }
        },
        loc: {
          start: {
            line: 204,
            column: 14
          },
          end: {
            line: 211,
            column: 5
          }
        },
        line: 204
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 23,
            column: 8
          },
          end: {
            line: 29,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 23,
            column: 8
          },
          end: {
            line: 29,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 23
      },
      "1": {
        loc: {
          start: {
            line: 26,
            column: 12
          },
          end: {
            line: 28,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 26,
            column: 12
          },
          end: {
            line: 28,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 26
      },
      "2": {
        loc: {
          start: {
            line: 31,
            column: 8
          },
          end: {
            line: 36,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 31,
            column: 8
          },
          end: {
            line: 36,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 31
      },
      "3": {
        loc: {
          start: {
            line: 46,
            column: 12
          },
          end: {
            line: 50,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 46,
            column: 12
          },
          end: {
            line: 50,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 46
      },
      "4": {
        loc: {
          start: {
            line: 47,
            column: 16
          },
          end: {
            line: 49,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 47,
            column: 16
          },
          end: {
            line: 49,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 47
      },
      "5": {
        loc: {
          start: {
            line: 53,
            column: 16
          },
          end: {
            line: 55,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 53,
            column: 16
          },
          end: {
            line: 55,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 53
      },
      "6": {
        loc: {
          start: {
            line: 81,
            column: 12
          },
          end: {
            line: 84,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 81,
            column: 12
          },
          end: {
            line: 84,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 81
      },
      "7": {
        loc: {
          start: {
            line: 92,
            column: 12
          },
          end: {
            line: 94,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 92,
            column: 12
          },
          end: {
            line: 94,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 92
      },
      "8": {
        loc: {
          start: {
            line: 110,
            column: 12
          },
          end: {
            line: 115,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 110,
            column: 12
          },
          end: {
            line: 115,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 110
      },
      "9": {
        loc: {
          start: {
            line: 130,
            column: 12
          },
          end: {
            line: 132,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 130,
            column: 12
          },
          end: {
            line: 132,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 130
      },
      "10": {
        loc: {
          start: {
            line: 197,
            column: 28
          },
          end: {
            line: 197,
            column: 82
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 197,
            column: 53
          },
          end: {
            line: 197,
            column: 66
          }
        }, {
          start: {
            line: 197,
            column: 69
          },
          end: {
            line: 197,
            column: 82
          }
        }],
        line: 197
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0,
      "60": 0,
      "61": 0,
      "62": 0,
      "63": 0,
      "64": 0,
      "65": 0,
      "66": 0,
      "67": 0,
      "68": 0,
      "69": 0,
      "70": 0,
      "71": 0,
      "72": 0,
      "73": 0,
      "74": 0,
      "75": 0,
      "76": 0,
      "77": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0]
    },
    inputSourceMap: {
      file: "E:\\zk-agent\\lib\\ag-ui\\protocol\\enhanced-runtime.ts",
      mappings: "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",
      names: [],
      sources: ["E:\\zk-agent\\lib\\ag-ui\\protocol\\enhanced-runtime.ts"],
      sourcesContent: ["// @ts-nocheck\nimport { AgUIRuntime } from \"./runtime\"\nimport { AgUIMiddlewareManager, LoggingMiddleware, PerformanceMiddleware, SecurityMiddleware } from \"./middleware\"\nimport { ToolRegistry, WeatherTool, WebSearchTool, CADAnalysisTool, PosterGeneratorTool } from \"./tool-registry\"\nimport { AgUIErrorCode, ErrorHandler } from \"./error-codes\"\nimport { VersionCompatibility } from \"./version\"\nimport type { AgUIEvent, RunInput, RunConfig, AgentDefinition } from \"./types\"\n\n/**\n * \u589E\u5F3A\u7248AG-UI\u8FD0\u884C\u65F6\n * \u96C6\u6210\u6240\u6709\u534F\u8BAE\u7279\u6027\n */\nexport class EnhancedAgUIRuntime extends AgUIRuntime {\n  private middlewareManager: AgUIMiddlewareManager\n  private toolRegistry: ToolRegistry\n  private performanceMetrics: Map<string, any> = new Map()\n\n  constructor(config: {\n    threadId: string\n    debug?: boolean\n    apiEndpoint?: string\n    enableMiddleware?: boolean\n    enableBuiltinTools?: boolean\n    securityOptions?: {\n      allowedTools?: string[]\n      maxMessageLength?: number\n      rateLimitPerMinute?: number\n    }\n  }) {\n    super(config)\n\n    // \u521D\u59CB\u5316\u4E2D\u95F4\u4EF6\u7BA1\u7406\u5668\n    this.middlewareManager = new AgUIMiddlewareManager()\n\n    // \u521D\u59CB\u5316\u5DE5\u5177\u6CE8\u518C\u8868\n    this.toolRegistry = new ToolRegistry()\n\n    // \u6CE8\u518C\u5185\u7F6E\u4E2D\u95F4\u4EF6\n    if (config.enableMiddleware !== false) {\n      this.middlewareManager.register(new LoggingMiddleware({ debug: config.debug }))\n      this.middlewareManager.register(new PerformanceMiddleware())\n\n      if (config.securityOptions) {\n        this.middlewareManager.register(new SecurityMiddleware(config.securityOptions))\n      }\n    }\n\n    // \u6CE8\u518C\u5185\u7F6E\u5DE5\u5177\n    if (config.enableBuiltinTools !== false) {\n      this.toolRegistry.register(new WeatherTool())\n      this.toolRegistry.register(new WebSearchTool())\n      this.toolRegistry.register(new CADAnalysisTool())\n      this.toolRegistry.register(new PosterGeneratorTool())\n    }\n\n    // \u521D\u59CB\u5316\u4E2D\u95F4\u4EF6\n    this.middlewareManager.initialize()\n  }\n\n  /**\n   * \u8BBE\u7F6E\u667A\u80FD\u4F53\uFF08\u589E\u5F3A\u7248\uFF09\n   */\n  setAgent(agent: AgentDefinition): void {\n    try {\n      // \u7248\u672C\u517C\u5BB9\u6027\u68C0\u67E5\n      if (agent.metadata?.protocolVersion) {\n        if (!VersionCompatibility.isCompatible(agent.metadata.protocolVersion)) {\n          throw ErrorHandler.createError(\n            AgUIErrorCode.AGENT_INVALID_CONFIG,\n            { protocolVersion: agent.metadata.protocolVersion },\n            { agentId: agent.id },\n          )\n        }\n      }\n\n      // \u9A8C\u8BC1\u5DE5\u5177\u5B9A\u4E49\n      for (const tool of agent.tools) {\n        if (!this.toolRegistry.has(tool.function.name)) {\n          console.warn(`Tool ${tool.function.name} not found in registry`)\n        }\n      }\n\n      super.setAgent(agent)\n    } catch (error) {\n      throw ErrorHandler.handleError(error, { agentId: agent.id })\n    }\n  }\n\n  /**\n   * \u6267\u884C\u8FD0\u884C\uFF08\u589E\u5F3A\u7248\uFF09\n   */\n  async run(input: RunInput, config?: RunConfig): Promise<void> {\n    const startTime = Date.now()\n\n    try {\n      // \u901A\u8FC7\u4E2D\u95F4\u4EF6\u5904\u7406\u8F93\u5165\n      const processedInput = await this.middlewareManager.processRun(input)\n\n      // \u8BB0\u5F55\u6027\u80FD\u6307\u6807\n      this.performanceMetrics.set(input.runId, {\n        startTime,\n        input: processedInput,\n        config,\n      })\n\n      // \u6267\u884C\u8FD0\u884C\n      await super.run(processedInput, config)\n\n      // \u66F4\u65B0\u6027\u80FD\u6307\u6807\n      const metric = this.performanceMetrics.get(input.runId)\n      if (metric) {\n        metric.endTime = Date.now()\n        metric.duration = metric.endTime - metric.startTime\n      }\n    } catch (error) {\n      // \u901A\u8FC7\u4E2D\u95F4\u4EF6\u5904\u7406\u9519\u8BEF\n      const processedError = this.middlewareManager.processError(ErrorHandler.handleError(error), {\n        runId: input.runId,\n        threadId: input.threadId,\n      })\n\n      if (processedError) {\n        throw processedError\n      }\n    }\n  }\n\n  /**\n   * \u6267\u884C\u5DE5\u5177\uFF08\u589E\u5F3A\u7248\uFF09\n   */\n  protected async executeTool(toolName: string, argsJson: string): Promise<any> {\n    try {\n      let args: any = {}\n      try {\n        args = JSON.parse(argsJson)\n      } catch (e) {\n        throw ErrorHandler.createError(AgUIErrorCode.TOOL_INVALID_ARGS, { argsJson, parseError: e }, { toolName })\n      }\n\n      // \u4F7F\u7528\u5DE5\u5177\u6CE8\u518C\u8868\u6267\u884C\n      if (this.toolRegistry.has(toolName)) {\n        return await this.toolRegistry.execute(toolName, args, {\n          threadId: this.config.threadId,\n          timestamp: Date.now(),\n        })\n      }\n\n      // \u56DE\u9000\u5230\u7236\u7C7B\u5B9E\u73B0\n      return await super.executeTool(toolName, argsJson)\n    } catch (error) {\n      throw ErrorHandler.handleError(error, { toolName, argsJson })\n    }\n  }\n\n  /**\n   * \u53D1\u9001\u4E8B\u4EF6\uFF08\u589E\u5F3A\u7248\uFF09\n   */\n  protected emitEvent(event: AgUIEvent): void {\n    try {\n      // \u901A\u8FC7\u4E2D\u95F4\u4EF6\u5904\u7406\u4E8B\u4EF6\n      const processedEvent = this.middlewareManager.processEvent(event)\n\n      if (processedEvent) {\n        super.emitEvent(processedEvent)\n      }\n    } catch (error) {\n      console.error(\"Error processing event through middleware:\", error)\n      // \u5373\u4F7F\u4E2D\u95F4\u4EF6\u51FA\u9519\uFF0C\u4E5F\u8981\u53D1\u9001\u539F\u59CB\u4E8B\u4EF6\n      super.emitEvent(event)\n    }\n  }\n\n  /**\n   * \u6CE8\u518C\u81EA\u5B9A\u4E49\u5DE5\u5177\n   */\n  registerTool(executor: any): void {\n    this.toolRegistry.register(executor)\n  }\n\n  /**\n   * \u6CE8\u518C\u4E2D\u95F4\u4EF6\n   */\n  registerMiddleware(middleware: any): void {\n    this.middlewareManager.register(middleware)\n  }\n\n  /**\n   * \u83B7\u53D6\u6027\u80FD\u6307\u6807\n   */\n  getPerformanceMetrics(): Record<string, any> {\n    const result: Record<string, any> = {}\n    for (const [runId, metric] of this.performanceMetrics.entries()) {\n      result[runId] = { ...metric }\n    }\n    return result\n  }\n\n  /**\n   * \u83B7\u53D6\u5DE5\u5177\u5217\u8868\n   */\n  getAvailableTools(): string[] {\n    return this.toolRegistry.getToolNames()\n  }\n\n  /**\n   * \u83B7\u53D6\u7248\u672C\u4FE1\u606F\n   */\n  getVersionInfo() {\n    return VersionCompatibility.getCurrentVersionInfo()\n  }\n\n  /**\n   * \u5065\u5EB7\u68C0\u67E5\n   */\n  async healthCheck(): Promise<{\n    status: \"healthy\" | \"degraded\" | \"unhealthy\"\n    details: Record<string, any>\n  }> {\n    const details: Record<string, any> = {\n      version: VersionCompatibility.getCurrentVersionInfo(),\n      tools: this.toolRegistry.getToolNames(),\n      middleware: Array.from((this.middlewareManager as any).middlewares.keys()),\n      metrics: Object.keys(this.performanceMetrics).length,\n    }\n\n    try {\n      // \u6D4B\u8BD5\u57FA\u672C\u529F\u80FD\n      const testEvent: AgUIEvent = {\n        type: \"custom\",\n        name: \"health-check\",\n        data: { timestamp: Date.now() },\n        timestamp: Date.now(),\n      }\n\n      this.middlewareManager.processEvent(testEvent)\n\n      details.status = \"healthy\"\n      return { status: \"healthy\", details }\n    } catch (error) {\n      details.error = error instanceof Error ? error.message : String(error)\n      return { status: \"unhealthy\", details }\n    }\n  }\n\n  /**\n   * \u6E05\u7406\u8D44\u6E90\uFF08\u589E\u5F3A\u7248\uFF09\n   */\n  dispose(): void {\n    // \u6E05\u7406\u4E2D\u95F4\u4EF6\n    this.middlewareManager.dispose()\n\n    // \u6E05\u7406\u6027\u80FD\u6307\u6807\n    this.performanceMetrics.clear()\n\n    // \u8C03\u7528\u7236\u7C7B\u6E05\u7406\n    super.dispose()\n  }\n}\n"],
      version: 3
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "53c5732e5253abae13ffe9a0200fd0ea85a5d681"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2127y02m6n = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2127y02m6n();
cov_2127y02m6n().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_2127y02m6n().s[1]++;
exports.EnhancedAgUIRuntime = void 0;
// @ts-nocheck
const runtime_1 =
/* istanbul ignore next */
(cov_2127y02m6n().s[2]++, require("./runtime"));
const middleware_1 =
/* istanbul ignore next */
(cov_2127y02m6n().s[3]++, require("./middleware"));
const tool_registry_1 =
/* istanbul ignore next */
(cov_2127y02m6n().s[4]++, require("./tool-registry"));
const error_codes_1 =
/* istanbul ignore next */
(cov_2127y02m6n().s[5]++, require("./error-codes"));
const version_1 =
/* istanbul ignore next */
(cov_2127y02m6n().s[6]++, require("./version"));
/**
 * 增强版AG-UI运行时
 * 集成所有协议特性
 */
class EnhancedAgUIRuntime extends
/* istanbul ignore next */
(runtime_1.AgUIRuntime) {
  constructor(config) {
    /* istanbul ignore next */
    cov_2127y02m6n().f[0]++;
    cov_2127y02m6n().s[7]++;
    super(config);
    /* istanbul ignore next */
    cov_2127y02m6n().s[8]++;
    this.performanceMetrics = new Map();
    // 初始化中间件管理器
    /* istanbul ignore next */
    cov_2127y02m6n().s[9]++;
    this.middlewareManager = new middleware_1.AgUIMiddlewareManager();
    // 初始化工具注册表
    /* istanbul ignore next */
    cov_2127y02m6n().s[10]++;
    this.toolRegistry = new tool_registry_1.ToolRegistry();
    // 注册内置中间件
    /* istanbul ignore next */
    cov_2127y02m6n().s[11]++;
    if (config.enableMiddleware !== false) {
      /* istanbul ignore next */
      cov_2127y02m6n().b[0][0]++;
      cov_2127y02m6n().s[12]++;
      this.middlewareManager.register(new middleware_1.LoggingMiddleware({
        debug: config.debug
      }));
      /* istanbul ignore next */
      cov_2127y02m6n().s[13]++;
      this.middlewareManager.register(new middleware_1.PerformanceMiddleware());
      /* istanbul ignore next */
      cov_2127y02m6n().s[14]++;
      if (config.securityOptions) {
        /* istanbul ignore next */
        cov_2127y02m6n().b[1][0]++;
        cov_2127y02m6n().s[15]++;
        this.middlewareManager.register(new middleware_1.SecurityMiddleware(config.securityOptions));
      } else
      /* istanbul ignore next */
      {
        cov_2127y02m6n().b[1][1]++;
      }
    } else
    /* istanbul ignore next */
    {
      cov_2127y02m6n().b[0][1]++;
    }
    // 注册内置工具
    cov_2127y02m6n().s[16]++;
    if (config.enableBuiltinTools !== false) {
      /* istanbul ignore next */
      cov_2127y02m6n().b[2][0]++;
      cov_2127y02m6n().s[17]++;
      this.toolRegistry.register(new tool_registry_1.WeatherTool());
      /* istanbul ignore next */
      cov_2127y02m6n().s[18]++;
      this.toolRegistry.register(new tool_registry_1.WebSearchTool());
      /* istanbul ignore next */
      cov_2127y02m6n().s[19]++;
      this.toolRegistry.register(new tool_registry_1.CADAnalysisTool());
      /* istanbul ignore next */
      cov_2127y02m6n().s[20]++;
      this.toolRegistry.register(new tool_registry_1.PosterGeneratorTool());
    } else
    /* istanbul ignore next */
    {
      cov_2127y02m6n().b[2][1]++;
    }
    // 初始化中间件
    cov_2127y02m6n().s[21]++;
    this.middlewareManager.initialize();
  }
  /**
   * 设置智能体（增强版）
   */
  setAgent(agent) {
    /* istanbul ignore next */
    cov_2127y02m6n().f[1]++;
    cov_2127y02m6n().s[22]++;
    try {
      /* istanbul ignore next */
      cov_2127y02m6n().s[23]++;
      // 版本兼容性检查
      if (agent.metadata?.protocolVersion) {
        /* istanbul ignore next */
        cov_2127y02m6n().b[3][0]++;
        cov_2127y02m6n().s[24]++;
        if (!version_1.VersionCompatibility.isCompatible(agent.metadata.protocolVersion)) {
          /* istanbul ignore next */
          cov_2127y02m6n().b[4][0]++;
          cov_2127y02m6n().s[25]++;
          throw error_codes_1.ErrorHandler.createError(error_codes_1.AgUIErrorCode.AGENT_INVALID_CONFIG, {
            protocolVersion: agent.metadata.protocolVersion
          }, {
            agentId: agent.id
          });
        } else
        /* istanbul ignore next */
        {
          cov_2127y02m6n().b[4][1]++;
        }
      } else
      /* istanbul ignore next */
      {
        cov_2127y02m6n().b[3][1]++;
      }
      // 验证工具定义
      cov_2127y02m6n().s[26]++;
      for (const tool of agent.tools) {
        /* istanbul ignore next */
        cov_2127y02m6n().s[27]++;
        if (!this.toolRegistry.has(tool.function.name)) {
          /* istanbul ignore next */
          cov_2127y02m6n().b[5][0]++;
          cov_2127y02m6n().s[28]++;
          console.warn(`Tool ${tool.function.name} not found in registry`);
        } else
        /* istanbul ignore next */
        {
          cov_2127y02m6n().b[5][1]++;
        }
      }
      /* istanbul ignore next */
      cov_2127y02m6n().s[29]++;
      super.setAgent(agent);
    } catch (error) {
      /* istanbul ignore next */
      cov_2127y02m6n().s[30]++;
      throw error_codes_1.ErrorHandler.handleError(error, {
        agentId: agent.id
      });
    }
  }
  /**
   * 执行运行（增强版）
   */
  async run(input, config) {
    /* istanbul ignore next */
    cov_2127y02m6n().f[2]++;
    const startTime =
    /* istanbul ignore next */
    (cov_2127y02m6n().s[31]++, Date.now());
    /* istanbul ignore next */
    cov_2127y02m6n().s[32]++;
    try {
      // 通过中间件处理输入
      const processedInput =
      /* istanbul ignore next */
      (cov_2127y02m6n().s[33]++, await this.middlewareManager.processRun(input));
      // 记录性能指标
      /* istanbul ignore next */
      cov_2127y02m6n().s[34]++;
      this.performanceMetrics.set(input.runId, {
        startTime,
        input: processedInput,
        config
      });
      // 执行运行
      /* istanbul ignore next */
      cov_2127y02m6n().s[35]++;
      await super.run(processedInput, config);
      // 更新性能指标
      const metric =
      /* istanbul ignore next */
      (cov_2127y02m6n().s[36]++, this.performanceMetrics.get(input.runId));
      /* istanbul ignore next */
      cov_2127y02m6n().s[37]++;
      if (metric) {
        /* istanbul ignore next */
        cov_2127y02m6n().b[6][0]++;
        cov_2127y02m6n().s[38]++;
        metric.endTime = Date.now();
        /* istanbul ignore next */
        cov_2127y02m6n().s[39]++;
        metric.duration = metric.endTime - metric.startTime;
      } else
      /* istanbul ignore next */
      {
        cov_2127y02m6n().b[6][1]++;
      }
    } catch (error) {
      // 通过中间件处理错误
      const processedError =
      /* istanbul ignore next */
      (cov_2127y02m6n().s[40]++, this.middlewareManager.processError(error_codes_1.ErrorHandler.handleError(error), {
        runId: input.runId,
        threadId: input.threadId
      }));
      /* istanbul ignore next */
      cov_2127y02m6n().s[41]++;
      if (processedError) {
        /* istanbul ignore next */
        cov_2127y02m6n().b[7][0]++;
        cov_2127y02m6n().s[42]++;
        throw processedError;
      } else
      /* istanbul ignore next */
      {
        cov_2127y02m6n().b[7][1]++;
      }
    }
  }
  /**
   * 执行工具（增强版）
   */
  async executeTool(toolName, argsJson) {
    /* istanbul ignore next */
    cov_2127y02m6n().f[3]++;
    cov_2127y02m6n().s[43]++;
    try {
      let args =
      /* istanbul ignore next */
      (cov_2127y02m6n().s[44]++, {});
      /* istanbul ignore next */
      cov_2127y02m6n().s[45]++;
      try {
        /* istanbul ignore next */
        cov_2127y02m6n().s[46]++;
        args = JSON.parse(argsJson);
      } catch (e) {
        /* istanbul ignore next */
        cov_2127y02m6n().s[47]++;
        throw error_codes_1.ErrorHandler.createError(error_codes_1.AgUIErrorCode.TOOL_INVALID_ARGS, {
          argsJson,
          parseError: e
        }, {
          toolName
        });
      }
      // 使用工具注册表执行
      /* istanbul ignore next */
      cov_2127y02m6n().s[48]++;
      if (this.toolRegistry.has(toolName)) {
        /* istanbul ignore next */
        cov_2127y02m6n().b[8][0]++;
        cov_2127y02m6n().s[49]++;
        return await this.toolRegistry.execute(toolName, args, {
          threadId: this.config.threadId,
          timestamp: Date.now()
        });
      } else
      /* istanbul ignore next */
      {
        cov_2127y02m6n().b[8][1]++;
      }
      // 回退到父类实现
      cov_2127y02m6n().s[50]++;
      return await super.executeTool(toolName, argsJson);
    } catch (error) {
      /* istanbul ignore next */
      cov_2127y02m6n().s[51]++;
      throw error_codes_1.ErrorHandler.handleError(error, {
        toolName,
        argsJson
      });
    }
  }
  /**
   * 发送事件（增强版）
   */
  emitEvent(event) {
    /* istanbul ignore next */
    cov_2127y02m6n().f[4]++;
    cov_2127y02m6n().s[52]++;
    try {
      // 通过中间件处理事件
      const processedEvent =
      /* istanbul ignore next */
      (cov_2127y02m6n().s[53]++, this.middlewareManager.processEvent(event));
      /* istanbul ignore next */
      cov_2127y02m6n().s[54]++;
      if (processedEvent) {
        /* istanbul ignore next */
        cov_2127y02m6n().b[9][0]++;
        cov_2127y02m6n().s[55]++;
        super.emitEvent(processedEvent);
      } else
      /* istanbul ignore next */
      {
        cov_2127y02m6n().b[9][1]++;
      }
    } catch (error) {
      /* istanbul ignore next */
      cov_2127y02m6n().s[56]++;
      console.error("Error processing event through middleware:", error);
      // 即使中间件出错，也要发送原始事件
      /* istanbul ignore next */
      cov_2127y02m6n().s[57]++;
      super.emitEvent(event);
    }
  }
  /**
   * 注册自定义工具
   */
  registerTool(executor) {
    /* istanbul ignore next */
    cov_2127y02m6n().f[5]++;
    cov_2127y02m6n().s[58]++;
    this.toolRegistry.register(executor);
  }
  /**
   * 注册中间件
   */
  registerMiddleware(middleware) {
    /* istanbul ignore next */
    cov_2127y02m6n().f[6]++;
    cov_2127y02m6n().s[59]++;
    this.middlewareManager.register(middleware);
  }
  /**
   * 获取性能指标
   */
  getPerformanceMetrics() {
    /* istanbul ignore next */
    cov_2127y02m6n().f[7]++;
    const result =
    /* istanbul ignore next */
    (cov_2127y02m6n().s[60]++, {});
    /* istanbul ignore next */
    cov_2127y02m6n().s[61]++;
    for (const [runId, metric] of this.performanceMetrics.entries()) {
      /* istanbul ignore next */
      cov_2127y02m6n().s[62]++;
      result[runId] = {
        ...metric
      };
    }
    /* istanbul ignore next */
    cov_2127y02m6n().s[63]++;
    return result;
  }
  /**
   * 获取工具列表
   */
  getAvailableTools() {
    /* istanbul ignore next */
    cov_2127y02m6n().f[8]++;
    cov_2127y02m6n().s[64]++;
    return this.toolRegistry.getToolNames();
  }
  /**
   * 获取版本信息
   */
  getVersionInfo() {
    /* istanbul ignore next */
    cov_2127y02m6n().f[9]++;
    cov_2127y02m6n().s[65]++;
    return version_1.VersionCompatibility.getCurrentVersionInfo();
  }
  /**
   * 健康检查
   */
  async healthCheck() {
    /* istanbul ignore next */
    cov_2127y02m6n().f[10]++;
    const details =
    /* istanbul ignore next */
    (cov_2127y02m6n().s[66]++, {
      version: version_1.VersionCompatibility.getCurrentVersionInfo(),
      tools: this.toolRegistry.getToolNames(),
      middleware: Array.from(this.middlewareManager.middlewares.keys()),
      metrics: Object.keys(this.performanceMetrics).length
    });
    /* istanbul ignore next */
    cov_2127y02m6n().s[67]++;
    try {
      // 测试基本功能
      const testEvent =
      /* istanbul ignore next */
      (cov_2127y02m6n().s[68]++, {
        type: "custom",
        name: "health-check",
        data: {
          timestamp: Date.now()
        },
        timestamp: Date.now()
      });
      /* istanbul ignore next */
      cov_2127y02m6n().s[69]++;
      this.middlewareManager.processEvent(testEvent);
      /* istanbul ignore next */
      cov_2127y02m6n().s[70]++;
      details.status = "healthy";
      /* istanbul ignore next */
      cov_2127y02m6n().s[71]++;
      return {
        status: "healthy",
        details
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_2127y02m6n().s[72]++;
      details.error = error instanceof Error ?
      /* istanbul ignore next */
      (cov_2127y02m6n().b[10][0]++, error.message) :
      /* istanbul ignore next */
      (cov_2127y02m6n().b[10][1]++, String(error));
      /* istanbul ignore next */
      cov_2127y02m6n().s[73]++;
      return {
        status: "unhealthy",
        details
      };
    }
  }
  /**
   * 清理资源（增强版）
   */
  dispose() {
    /* istanbul ignore next */
    cov_2127y02m6n().f[11]++;
    cov_2127y02m6n().s[74]++;
    // 清理中间件
    this.middlewareManager.dispose();
    // 清理性能指标
    /* istanbul ignore next */
    cov_2127y02m6n().s[75]++;
    this.performanceMetrics.clear();
    // 调用父类清理
    /* istanbul ignore next */
    cov_2127y02m6n().s[76]++;
    super.dispose();
  }
}
/* istanbul ignore next */
cov_2127y02m6n().s[77]++;
exports.EnhancedAgUIRuntime = EnhancedAgUIRuntime;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMjEyN3kwMm02biIsImFjdHVhbENvdmVyYWdlIiwicyIsInJ1bnRpbWVfMSIsInJlcXVpcmUiLCJtaWRkbGV3YXJlXzEiLCJ0b29sX3JlZ2lzdHJ5XzEiLCJlcnJvcl9jb2Rlc18xIiwidmVyc2lvbl8xIiwiRW5oYW5jZWRBZ1VJUnVudGltZSIsIkFnVUlSdW50aW1lIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJmIiwicGVyZm9ybWFuY2VNZXRyaWNzIiwiTWFwIiwibWlkZGxld2FyZU1hbmFnZXIiLCJBZ1VJTWlkZGxld2FyZU1hbmFnZXIiLCJ0b29sUmVnaXN0cnkiLCJUb29sUmVnaXN0cnkiLCJlbmFibGVNaWRkbGV3YXJlIiwiYiIsInJlZ2lzdGVyIiwiTG9nZ2luZ01pZGRsZXdhcmUiLCJkZWJ1ZyIsIlBlcmZvcm1hbmNlTWlkZGxld2FyZSIsInNlY3VyaXR5T3B0aW9ucyIsIlNlY3VyaXR5TWlkZGxld2FyZSIsImVuYWJsZUJ1aWx0aW5Ub29scyIsIldlYXRoZXJUb29sIiwiV2ViU2VhcmNoVG9vbCIsIkNBREFuYWx5c2lzVG9vbCIsIlBvc3RlckdlbmVyYXRvclRvb2wiLCJpbml0aWFsaXplIiwic2V0QWdlbnQiLCJhZ2VudCIsIm1ldGFkYXRhIiwicHJvdG9jb2xWZXJzaW9uIiwiVmVyc2lvbkNvbXBhdGliaWxpdHkiLCJpc0NvbXBhdGlibGUiLCJFcnJvckhhbmRsZXIiLCJjcmVhdGVFcnJvciIsIkFnVUlFcnJvckNvZGUiLCJBR0VOVF9JTlZBTElEX0NPTkZJRyIsImFnZW50SWQiLCJpZCIsInRvb2wiLCJ0b29scyIsImhhcyIsImZ1bmN0aW9uIiwibmFtZSIsImNvbnNvbGUiLCJ3YXJuIiwiZXJyb3IiLCJoYW5kbGVFcnJvciIsInJ1biIsImlucHV0Iiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsInByb2Nlc3NlZElucHV0IiwicHJvY2Vzc1J1biIsInNldCIsInJ1bklkIiwibWV0cmljIiwiZ2V0IiwiZW5kVGltZSIsImR1cmF0aW9uIiwicHJvY2Vzc2VkRXJyb3IiLCJwcm9jZXNzRXJyb3IiLCJ0aHJlYWRJZCIsImV4ZWN1dGVUb29sIiwidG9vbE5hbWUiLCJhcmdzSnNvbiIsImFyZ3MiLCJKU09OIiwicGFyc2UiLCJlIiwiVE9PTF9JTlZBTElEX0FSR1MiLCJwYXJzZUVycm9yIiwiZXhlY3V0ZSIsInRpbWVzdGFtcCIsImVtaXRFdmVudCIsImV2ZW50IiwicHJvY2Vzc2VkRXZlbnQiLCJwcm9jZXNzRXZlbnQiLCJyZWdpc3RlclRvb2wiLCJleGVjdXRvciIsInJlZ2lzdGVyTWlkZGxld2FyZSIsIm1pZGRsZXdhcmUiLCJnZXRQZXJmb3JtYW5jZU1ldHJpY3MiLCJyZXN1bHQiLCJlbnRyaWVzIiwiZ2V0QXZhaWxhYmxlVG9vbHMiLCJnZXRUb29sTmFtZXMiLCJnZXRWZXJzaW9uSW5mbyIsImdldEN1cnJlbnRWZXJzaW9uSW5mbyIsImhlYWx0aENoZWNrIiwiZGV0YWlscyIsInZlcnNpb24iLCJBcnJheSIsImZyb20iLCJtaWRkbGV3YXJlcyIsImtleXMiLCJtZXRyaWNzIiwiT2JqZWN0IiwibGVuZ3RoIiwidGVzdEV2ZW50IiwidHlwZSIsImRhdGEiLCJzdGF0dXMiLCJFcnJvciIsIm1lc3NhZ2UiLCJTdHJpbmciLCJkaXNwb3NlIiwiY2xlYXIiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiRTpcXHprLWFnZW50XFxsaWJcXGFnLXVpXFxwcm90b2NvbFxcZW5oYW5jZWQtcnVudGltZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAdHMtbm9jaGVja1xuaW1wb3J0IHsgQWdVSVJ1bnRpbWUgfSBmcm9tIFwiLi9ydW50aW1lXCJcbmltcG9ydCB7IEFnVUlNaWRkbGV3YXJlTWFuYWdlciwgTG9nZ2luZ01pZGRsZXdhcmUsIFBlcmZvcm1hbmNlTWlkZGxld2FyZSwgU2VjdXJpdHlNaWRkbGV3YXJlIH0gZnJvbSBcIi4vbWlkZGxld2FyZVwiXG5pbXBvcnQgeyBUb29sUmVnaXN0cnksIFdlYXRoZXJUb29sLCBXZWJTZWFyY2hUb29sLCBDQURBbmFseXNpc1Rvb2wsIFBvc3RlckdlbmVyYXRvclRvb2wgfSBmcm9tIFwiLi90b29sLXJlZ2lzdHJ5XCJcbmltcG9ydCB7IEFnVUlFcnJvckNvZGUsIEVycm9ySGFuZGxlciB9IGZyb20gXCIuL2Vycm9yLWNvZGVzXCJcbmltcG9ydCB7IFZlcnNpb25Db21wYXRpYmlsaXR5IH0gZnJvbSBcIi4vdmVyc2lvblwiXG5pbXBvcnQgdHlwZSB7IEFnVUlFdmVudCwgUnVuSW5wdXQsIFJ1bkNvbmZpZywgQWdlbnREZWZpbml0aW9uIH0gZnJvbSBcIi4vdHlwZXNcIlxuXG4vKipcbiAqIOWinuW8uueJiEFHLVVJ6L+Q6KGM5pe2XG4gKiDpm4bmiJDmiYDmnInljY/orq7nibnmgKdcbiAqL1xuZXhwb3J0IGNsYXNzIEVuaGFuY2VkQWdVSVJ1bnRpbWUgZXh0ZW5kcyBBZ1VJUnVudGltZSB7XG4gIHByaXZhdGUgbWlkZGxld2FyZU1hbmFnZXI6IEFnVUlNaWRkbGV3YXJlTWFuYWdlclxuICBwcml2YXRlIHRvb2xSZWdpc3RyeTogVG9vbFJlZ2lzdHJ5XG4gIHByaXZhdGUgcGVyZm9ybWFuY2VNZXRyaWNzOiBNYXA8c3RyaW5nLCBhbnk+ID0gbmV3IE1hcCgpXG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiB7XG4gICAgdGhyZWFkSWQ6IHN0cmluZ1xuICAgIGRlYnVnPzogYm9vbGVhblxuICAgIGFwaUVuZHBvaW50Pzogc3RyaW5nXG4gICAgZW5hYmxlTWlkZGxld2FyZT86IGJvb2xlYW5cbiAgICBlbmFibGVCdWlsdGluVG9vbHM/OiBib29sZWFuXG4gICAgc2VjdXJpdHlPcHRpb25zPzoge1xuICAgICAgYWxsb3dlZFRvb2xzPzogc3RyaW5nW11cbiAgICAgIG1heE1lc3NhZ2VMZW5ndGg/OiBudW1iZXJcbiAgICAgIHJhdGVMaW1pdFBlck1pbnV0ZT86IG51bWJlclxuICAgIH1cbiAgfSkge1xuICAgIHN1cGVyKGNvbmZpZylcblxuICAgIC8vIOWIneWni+WMluS4remXtOS7tueuoeeQhuWZqFxuICAgIHRoaXMubWlkZGxld2FyZU1hbmFnZXIgPSBuZXcgQWdVSU1pZGRsZXdhcmVNYW5hZ2VyKClcblxuICAgIC8vIOWIneWni+WMluW3peWFt+azqOWGjOihqFxuICAgIHRoaXMudG9vbFJlZ2lzdHJ5ID0gbmV3IFRvb2xSZWdpc3RyeSgpXG5cbiAgICAvLyDms6jlhozlhoXnva7kuK3pl7Tku7ZcbiAgICBpZiAoY29uZmlnLmVuYWJsZU1pZGRsZXdhcmUgIT09IGZhbHNlKSB7XG4gICAgICB0aGlzLm1pZGRsZXdhcmVNYW5hZ2VyLnJlZ2lzdGVyKG5ldyBMb2dnaW5nTWlkZGxld2FyZSh7IGRlYnVnOiBjb25maWcuZGVidWcgfSkpXG4gICAgICB0aGlzLm1pZGRsZXdhcmVNYW5hZ2VyLnJlZ2lzdGVyKG5ldyBQZXJmb3JtYW5jZU1pZGRsZXdhcmUoKSlcblxuICAgICAgaWYgKGNvbmZpZy5zZWN1cml0eU9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5taWRkbGV3YXJlTWFuYWdlci5yZWdpc3RlcihuZXcgU2VjdXJpdHlNaWRkbGV3YXJlKGNvbmZpZy5zZWN1cml0eU9wdGlvbnMpKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIOazqOWGjOWGhee9ruW3peWFt1xuICAgIGlmIChjb25maWcuZW5hYmxlQnVpbHRpblRvb2xzICE9PSBmYWxzZSkge1xuICAgICAgdGhpcy50b29sUmVnaXN0cnkucmVnaXN0ZXIobmV3IFdlYXRoZXJUb29sKCkpXG4gICAgICB0aGlzLnRvb2xSZWdpc3RyeS5yZWdpc3RlcihuZXcgV2ViU2VhcmNoVG9vbCgpKVxuICAgICAgdGhpcy50b29sUmVnaXN0cnkucmVnaXN0ZXIobmV3IENBREFuYWx5c2lzVG9vbCgpKVxuICAgICAgdGhpcy50b29sUmVnaXN0cnkucmVnaXN0ZXIobmV3IFBvc3RlckdlbmVyYXRvclRvb2woKSlcbiAgICB9XG5cbiAgICAvLyDliJ3lp4vljJbkuK3pl7Tku7ZcbiAgICB0aGlzLm1pZGRsZXdhcmVNYW5hZ2VyLmluaXRpYWxpemUoKVxuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruaZuuiDveS9k++8iOWinuW8uueJiO+8iVxuICAgKi9cbiAgc2V0QWdlbnQoYWdlbnQ6IEFnZW50RGVmaW5pdGlvbik6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICAvLyDniYjmnKzlhbzlrrnmgKfmo4Dmn6VcbiAgICAgIGlmIChhZ2VudC5tZXRhZGF0YT8ucHJvdG9jb2xWZXJzaW9uKSB7XG4gICAgICAgIGlmICghVmVyc2lvbkNvbXBhdGliaWxpdHkuaXNDb21wYXRpYmxlKGFnZW50Lm1ldGFkYXRhLnByb3RvY29sVmVyc2lvbikpIHtcbiAgICAgICAgICB0aHJvdyBFcnJvckhhbmRsZXIuY3JlYXRlRXJyb3IoXG4gICAgICAgICAgICBBZ1VJRXJyb3JDb2RlLkFHRU5UX0lOVkFMSURfQ09ORklHLFxuICAgICAgICAgICAgeyBwcm90b2NvbFZlcnNpb246IGFnZW50Lm1ldGFkYXRhLnByb3RvY29sVmVyc2lvbiB9LFxuICAgICAgICAgICAgeyBhZ2VudElkOiBhZ2VudC5pZCB9LFxuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyDpqozor4Hlt6XlhbflrprkuYlcbiAgICAgIGZvciAoY29uc3QgdG9vbCBvZiBhZ2VudC50b29scykge1xuICAgICAgICBpZiAoIXRoaXMudG9vbFJlZ2lzdHJ5Lmhhcyh0b29sLmZ1bmN0aW9uLm5hbWUpKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGBUb29sICR7dG9vbC5mdW5jdGlvbi5uYW1lfSBub3QgZm91bmQgaW4gcmVnaXN0cnlgKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHN1cGVyLnNldEFnZW50KGFnZW50KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBFcnJvckhhbmRsZXIuaGFuZGxlRXJyb3IoZXJyb3IsIHsgYWdlbnRJZDogYWdlbnQuaWQgfSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5omn6KGM6L+Q6KGM77yI5aKe5by654mI77yJXG4gICAqL1xuICBhc3luYyBydW4oaW5wdXQ6IFJ1bklucHV0LCBjb25maWc/OiBSdW5Db25maWcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpXG5cbiAgICB0cnkge1xuICAgICAgLy8g6YCa6L+H5Lit6Ze05Lu25aSE55CG6L6T5YWlXG4gICAgICBjb25zdCBwcm9jZXNzZWRJbnB1dCA9IGF3YWl0IHRoaXMubWlkZGxld2FyZU1hbmFnZXIucHJvY2Vzc1J1bihpbnB1dClcblxuICAgICAgLy8g6K6w5b2V5oCn6IO95oyH5qCHXG4gICAgICB0aGlzLnBlcmZvcm1hbmNlTWV0cmljcy5zZXQoaW5wdXQucnVuSWQsIHtcbiAgICAgICAgc3RhcnRUaW1lLFxuICAgICAgICBpbnB1dDogcHJvY2Vzc2VkSW5wdXQsXG4gICAgICAgIGNvbmZpZyxcbiAgICAgIH0pXG5cbiAgICAgIC8vIOaJp+ihjOi/kOihjFxuICAgICAgYXdhaXQgc3VwZXIucnVuKHByb2Nlc3NlZElucHV0LCBjb25maWcpXG5cbiAgICAgIC8vIOabtOaWsOaAp+iDveaMh+agh1xuICAgICAgY29uc3QgbWV0cmljID0gdGhpcy5wZXJmb3JtYW5jZU1ldHJpY3MuZ2V0KGlucHV0LnJ1bklkKVxuICAgICAgaWYgKG1ldHJpYykge1xuICAgICAgICBtZXRyaWMuZW5kVGltZSA9IERhdGUubm93KClcbiAgICAgICAgbWV0cmljLmR1cmF0aW9uID0gbWV0cmljLmVuZFRpbWUgLSBtZXRyaWMuc3RhcnRUaW1lXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIOmAmui/h+S4remXtOS7tuWkhOeQhumUmeivr1xuICAgICAgY29uc3QgcHJvY2Vzc2VkRXJyb3IgPSB0aGlzLm1pZGRsZXdhcmVNYW5hZ2VyLnByb2Nlc3NFcnJvcihFcnJvckhhbmRsZXIuaGFuZGxlRXJyb3IoZXJyb3IpLCB7XG4gICAgICAgIHJ1bklkOiBpbnB1dC5ydW5JZCxcbiAgICAgICAgdGhyZWFkSWQ6IGlucHV0LnRocmVhZElkLFxuICAgICAgfSlcblxuICAgICAgaWYgKHByb2Nlc3NlZEVycm9yKSB7XG4gICAgICAgIHRocm93IHByb2Nlc3NlZEVycm9yXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaJp+ihjOW3peWFt++8iOWinuW8uueJiO+8iVxuICAgKi9cbiAgcHJvdGVjdGVkIGFzeW5jIGV4ZWN1dGVUb29sKHRvb2xOYW1lOiBzdHJpbmcsIGFyZ3NKc29uOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgIHRyeSB7XG4gICAgICBsZXQgYXJnczogYW55ID0ge31cbiAgICAgIHRyeSB7XG4gICAgICAgIGFyZ3MgPSBKU09OLnBhcnNlKGFyZ3NKc29uKVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBFcnJvckhhbmRsZXIuY3JlYXRlRXJyb3IoQWdVSUVycm9yQ29kZS5UT09MX0lOVkFMSURfQVJHUywgeyBhcmdzSnNvbiwgcGFyc2VFcnJvcjogZSB9LCB7IHRvb2xOYW1lIH0pXG4gICAgICB9XG5cbiAgICAgIC8vIOS9v+eUqOW3peWFt+azqOWGjOihqOaJp+ihjFxuICAgICAgaWYgKHRoaXMudG9vbFJlZ2lzdHJ5Lmhhcyh0b29sTmFtZSkpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMudG9vbFJlZ2lzdHJ5LmV4ZWN1dGUodG9vbE5hbWUsIGFyZ3MsIHtcbiAgICAgICAgICB0aHJlYWRJZDogdGhpcy5jb25maWcudGhyZWFkSWQsXG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICB9KVxuICAgICAgfVxuXG4gICAgICAvLyDlm57pgIDliLDniLbnsbvlrp7njrBcbiAgICAgIHJldHVybiBhd2FpdCBzdXBlci5leGVjdXRlVG9vbCh0b29sTmFtZSwgYXJnc0pzb24pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IEVycm9ySGFuZGxlci5oYW5kbGVFcnJvcihlcnJvciwgeyB0b29sTmFtZSwgYXJnc0pzb24gfSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Y+R6YCB5LqL5Lu277yI5aKe5by654mI77yJXG4gICAqL1xuICBwcm90ZWN0ZWQgZW1pdEV2ZW50KGV2ZW50OiBBZ1VJRXZlbnQpOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgLy8g6YCa6L+H5Lit6Ze05Lu25aSE55CG5LqL5Lu2XG4gICAgICBjb25zdCBwcm9jZXNzZWRFdmVudCA9IHRoaXMubWlkZGxld2FyZU1hbmFnZXIucHJvY2Vzc0V2ZW50KGV2ZW50KVxuXG4gICAgICBpZiAocHJvY2Vzc2VkRXZlbnQpIHtcbiAgICAgICAgc3VwZXIuZW1pdEV2ZW50KHByb2Nlc3NlZEV2ZW50KVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgcHJvY2Vzc2luZyBldmVudCB0aHJvdWdoIG1pZGRsZXdhcmU6XCIsIGVycm9yKVxuICAgICAgLy8g5Y2z5L2/5Lit6Ze05Lu25Ye66ZSZ77yM5Lmf6KaB5Y+R6YCB5Y6f5aeL5LqL5Lu2XG4gICAgICBzdXBlci5lbWl0RXZlbnQoZXZlbnQpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOazqOWGjOiHquWumuS5ieW3peWFt1xuICAgKi9cbiAgcmVnaXN0ZXJUb29sKGV4ZWN1dG9yOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLnRvb2xSZWdpc3RyeS5yZWdpc3RlcihleGVjdXRvcilcbiAgfVxuXG4gIC8qKlxuICAgKiDms6jlhozkuK3pl7Tku7ZcbiAgICovXG4gIHJlZ2lzdGVyTWlkZGxld2FyZShtaWRkbGV3YXJlOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLm1pZGRsZXdhcmVNYW5hZ2VyLnJlZ2lzdGVyKG1pZGRsZXdhcmUpXG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5oCn6IO95oyH5qCHXG4gICAqL1xuICBnZXRQZXJmb3JtYW5jZU1ldHJpY3MoKTogUmVjb3JkPHN0cmluZywgYW55PiB7XG4gICAgY29uc3QgcmVzdWx0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge31cbiAgICBmb3IgKGNvbnN0IFtydW5JZCwgbWV0cmljXSBvZiB0aGlzLnBlcmZvcm1hbmNlTWV0cmljcy5lbnRyaWVzKCkpIHtcbiAgICAgIHJlc3VsdFtydW5JZF0gPSB7IC4uLm1ldHJpYyB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHRcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blt6XlhbfliJfooahcbiAgICovXG4gIGdldEF2YWlsYWJsZVRvb2xzKCk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gdGhpcy50b29sUmVnaXN0cnkuZ2V0VG9vbE5hbWVzKClcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bniYjmnKzkv6Hmga9cbiAgICovXG4gIGdldFZlcnNpb25JbmZvKCkge1xuICAgIHJldHVybiBWZXJzaW9uQ29tcGF0aWJpbGl0eS5nZXRDdXJyZW50VmVyc2lvbkluZm8oKVxuICB9XG5cbiAgLyoqXG4gICAqIOWBpeW6t+ajgOafpVxuICAgKi9cbiAgYXN5bmMgaGVhbHRoQ2hlY2soKTogUHJvbWlzZTx7XG4gICAgc3RhdHVzOiBcImhlYWx0aHlcIiB8IFwiZGVncmFkZWRcIiB8IFwidW5oZWFsdGh5XCJcbiAgICBkZXRhaWxzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4gIH0+IHtcbiAgICBjb25zdCBkZXRhaWxzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge1xuICAgICAgdmVyc2lvbjogVmVyc2lvbkNvbXBhdGliaWxpdHkuZ2V0Q3VycmVudFZlcnNpb25JbmZvKCksXG4gICAgICB0b29sczogdGhpcy50b29sUmVnaXN0cnkuZ2V0VG9vbE5hbWVzKCksXG4gICAgICBtaWRkbGV3YXJlOiBBcnJheS5mcm9tKCh0aGlzLm1pZGRsZXdhcmVNYW5hZ2VyIGFzIGFueSkubWlkZGxld2FyZXMua2V5cygpKSxcbiAgICAgIG1ldHJpY3M6IE9iamVjdC5rZXlzKHRoaXMucGVyZm9ybWFuY2VNZXRyaWNzKS5sZW5ndGgsXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIOa1i+ivleWfuuacrOWKn+iDvVxuICAgICAgY29uc3QgdGVzdEV2ZW50OiBBZ1VJRXZlbnQgPSB7XG4gICAgICAgIHR5cGU6IFwiY3VzdG9tXCIsXG4gICAgICAgIG5hbWU6IFwiaGVhbHRoLWNoZWNrXCIsXG4gICAgICAgIGRhdGE6IHsgdGltZXN0YW1wOiBEYXRlLm5vdygpIH0sXG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgIH1cblxuICAgICAgdGhpcy5taWRkbGV3YXJlTWFuYWdlci5wcm9jZXNzRXZlbnQodGVzdEV2ZW50KVxuXG4gICAgICBkZXRhaWxzLnN0YXR1cyA9IFwiaGVhbHRoeVwiXG4gICAgICByZXR1cm4geyBzdGF0dXM6IFwiaGVhbHRoeVwiLCBkZXRhaWxzIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgZGV0YWlscy5lcnJvciA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKVxuICAgICAgcmV0dXJuIHsgc3RhdHVzOiBcInVuaGVhbHRoeVwiLCBkZXRhaWxzIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5riF55CG6LWE5rqQ77yI5aKe5by654mI77yJXG4gICAqL1xuICBkaXNwb3NlKCk6IHZvaWQge1xuICAgIC8vIOa4heeQhuS4remXtOS7tlxuICAgIHRoaXMubWlkZGxld2FyZU1hbmFnZXIuZGlzcG9zZSgpXG5cbiAgICAvLyDmuIXnkIbmgKfog73mjIfmoIdcbiAgICB0aGlzLnBlcmZvcm1hbmNlTWV0cmljcy5jbGVhcigpXG5cbiAgICAvLyDosIPnlKjniLbnsbvmuIXnkIZcbiAgICBzdXBlci5kaXNwb3NlKClcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQTZCSTtJQUFBQSxjQUFBLFlBQUFBLENBQUE7TUFBQSxPQUFBQyxjQUFBO0lBQUE7RUFBQTtFQUFBLE9BQUFBLGNBQUE7QUFBQTtBQUFBRCxjQUFBO0FBQUFBLGNBQUEsR0FBQUUsQ0FBQTs7Ozs7OztBQTdCSjtBQUNBLE1BQUFDLFNBQUE7QUFBQTtBQUFBLENBQUFILGNBQUEsR0FBQUUsQ0FBQSxPQUFBRSxPQUFBO0FBQ0EsTUFBQUMsWUFBQTtBQUFBO0FBQUEsQ0FBQUwsY0FBQSxHQUFBRSxDQUFBLE9BQUFFLE9BQUE7QUFDQSxNQUFBRSxlQUFBO0FBQUE7QUFBQSxDQUFBTixjQUFBLEdBQUFFLENBQUEsT0FBQUUsT0FBQTtBQUNBLE1BQUFHLGFBQUE7QUFBQTtBQUFBLENBQUFQLGNBQUEsR0FBQUUsQ0FBQSxPQUFBRSxPQUFBO0FBQ0EsTUFBQUksU0FBQTtBQUFBO0FBQUEsQ0FBQVIsY0FBQSxHQUFBRSxDQUFBLE9BQUFFLE9BQUE7QUFHQTs7OztBQUlBLE1BQWFLLG1CQUFvQjtBQUFBO0FBQUEsQ0FBUU4sU0FBQSxDQUFBTyxXQUFXO0VBS2xEQyxZQUFZQyxNQVdYO0lBQUE7SUFBQVosY0FBQSxHQUFBYSxDQUFBO0lBQUFiLGNBQUEsR0FBQUUsQ0FBQTtJQUNDLEtBQUssQ0FBQ1UsTUFBTSxDQUFDO0lBQUE7SUFBQVosY0FBQSxHQUFBRSxDQUFBO0lBZFAsS0FBQVksa0JBQWtCLEdBQXFCLElBQUlDLEdBQUcsRUFBRTtJQWdCdEQ7SUFBQTtJQUFBZixjQUFBLEdBQUFFLENBQUE7SUFDQSxJQUFJLENBQUNjLGlCQUFpQixHQUFHLElBQUlYLFlBQUEsQ0FBQVkscUJBQXFCLEVBQUU7SUFFcEQ7SUFBQTtJQUFBakIsY0FBQSxHQUFBRSxDQUFBO0lBQ0EsSUFBSSxDQUFDZ0IsWUFBWSxHQUFHLElBQUlaLGVBQUEsQ0FBQWEsWUFBWSxFQUFFO0lBRXRDO0lBQUE7SUFBQW5CLGNBQUEsR0FBQUUsQ0FBQTtJQUNBLElBQUlVLE1BQU0sQ0FBQ1EsZ0JBQWdCLEtBQUssS0FBSyxFQUFFO01BQUE7TUFBQXBCLGNBQUEsR0FBQXFCLENBQUE7TUFBQXJCLGNBQUEsR0FBQUUsQ0FBQTtNQUNyQyxJQUFJLENBQUNjLGlCQUFpQixDQUFDTSxRQUFRLENBQUMsSUFBSWpCLFlBQUEsQ0FBQWtCLGlCQUFpQixDQUFDO1FBQUVDLEtBQUssRUFBRVosTUFBTSxDQUFDWTtNQUFLLENBQUUsQ0FBQyxDQUFDO01BQUE7TUFBQXhCLGNBQUEsR0FBQUUsQ0FBQTtNQUMvRSxJQUFJLENBQUNjLGlCQUFpQixDQUFDTSxRQUFRLENBQUMsSUFBSWpCLFlBQUEsQ0FBQW9CLHFCQUFxQixFQUFFLENBQUM7TUFBQTtNQUFBekIsY0FBQSxHQUFBRSxDQUFBO01BRTVELElBQUlVLE1BQU0sQ0FBQ2MsZUFBZSxFQUFFO1FBQUE7UUFBQTFCLGNBQUEsR0FBQXFCLENBQUE7UUFBQXJCLGNBQUEsR0FBQUUsQ0FBQTtRQUMxQixJQUFJLENBQUNjLGlCQUFpQixDQUFDTSxRQUFRLENBQUMsSUFBSWpCLFlBQUEsQ0FBQXNCLGtCQUFrQixDQUFDZixNQUFNLENBQUNjLGVBQWUsQ0FBQyxDQUFDO01BQ2pGLENBQUM7TUFBQTtNQUFBO1FBQUExQixjQUFBLEdBQUFxQixDQUFBO01BQUE7SUFDSCxDQUFDO0lBQUE7SUFBQTtNQUFBckIsY0FBQSxHQUFBcUIsQ0FBQTtJQUFBO0lBRUQ7SUFBQXJCLGNBQUEsR0FBQUUsQ0FBQTtJQUNBLElBQUlVLE1BQU0sQ0FBQ2dCLGtCQUFrQixLQUFLLEtBQUssRUFBRTtNQUFBO01BQUE1QixjQUFBLEdBQUFxQixDQUFBO01BQUFyQixjQUFBLEdBQUFFLENBQUE7TUFDdkMsSUFBSSxDQUFDZ0IsWUFBWSxDQUFDSSxRQUFRLENBQUMsSUFBSWhCLGVBQUEsQ0FBQXVCLFdBQVcsRUFBRSxDQUFDO01BQUE7TUFBQTdCLGNBQUEsR0FBQUUsQ0FBQTtNQUM3QyxJQUFJLENBQUNnQixZQUFZLENBQUNJLFFBQVEsQ0FBQyxJQUFJaEIsZUFBQSxDQUFBd0IsYUFBYSxFQUFFLENBQUM7TUFBQTtNQUFBOUIsY0FBQSxHQUFBRSxDQUFBO01BQy9DLElBQUksQ0FBQ2dCLFlBQVksQ0FBQ0ksUUFBUSxDQUFDLElBQUloQixlQUFBLENBQUF5QixlQUFlLEVBQUUsQ0FBQztNQUFBO01BQUEvQixjQUFBLEdBQUFFLENBQUE7TUFDakQsSUFBSSxDQUFDZ0IsWUFBWSxDQUFDSSxRQUFRLENBQUMsSUFBSWhCLGVBQUEsQ0FBQTBCLG1CQUFtQixFQUFFLENBQUM7SUFDdkQsQ0FBQztJQUFBO0lBQUE7TUFBQWhDLGNBQUEsR0FBQXFCLENBQUE7SUFBQTtJQUVEO0lBQUFyQixjQUFBLEdBQUFFLENBQUE7SUFDQSxJQUFJLENBQUNjLGlCQUFpQixDQUFDaUIsVUFBVSxFQUFFO0VBQ3JDO0VBRUE7OztFQUdBQyxRQUFRQSxDQUFDQyxLQUFzQjtJQUFBO0lBQUFuQyxjQUFBLEdBQUFhLENBQUE7SUFBQWIsY0FBQSxHQUFBRSxDQUFBO0lBQzdCLElBQUk7TUFBQTtNQUFBRixjQUFBLEdBQUFFLENBQUE7TUFDRjtNQUNBLElBQUlpQyxLQUFLLENBQUNDLFFBQVEsRUFBRUMsZUFBZSxFQUFFO1FBQUE7UUFBQXJDLGNBQUEsR0FBQXFCLENBQUE7UUFBQXJCLGNBQUEsR0FBQUUsQ0FBQTtRQUNuQyxJQUFJLENBQUNNLFNBQUEsQ0FBQThCLG9CQUFvQixDQUFDQyxZQUFZLENBQUNKLEtBQUssQ0FBQ0MsUUFBUSxDQUFDQyxlQUFlLENBQUMsRUFBRTtVQUFBO1VBQUFyQyxjQUFBLEdBQUFxQixDQUFBO1VBQUFyQixjQUFBLEdBQUFFLENBQUE7VUFDdEUsTUFBTUssYUFBQSxDQUFBaUMsWUFBWSxDQUFDQyxXQUFXLENBQzVCbEMsYUFBQSxDQUFBbUMsYUFBYSxDQUFDQyxvQkFBb0IsRUFDbEM7WUFBRU4sZUFBZSxFQUFFRixLQUFLLENBQUNDLFFBQVEsQ0FBQ0M7VUFBZSxDQUFFLEVBQ25EO1lBQUVPLE9BQU8sRUFBRVQsS0FBSyxDQUFDVTtVQUFFLENBQUUsQ0FDdEI7UUFDSCxDQUFDO1FBQUE7UUFBQTtVQUFBN0MsY0FBQSxHQUFBcUIsQ0FBQTtRQUFBO01BQ0gsQ0FBQztNQUFBO01BQUE7UUFBQXJCLGNBQUEsR0FBQXFCLENBQUE7TUFBQTtNQUVEO01BQUFyQixjQUFBLEdBQUFFLENBQUE7TUFDQSxLQUFLLE1BQU00QyxJQUFJLElBQUlYLEtBQUssQ0FBQ1ksS0FBSyxFQUFFO1FBQUE7UUFBQS9DLGNBQUEsR0FBQUUsQ0FBQTtRQUM5QixJQUFJLENBQUMsSUFBSSxDQUFDZ0IsWUFBWSxDQUFDOEIsR0FBRyxDQUFDRixJQUFJLENBQUNHLFFBQVEsQ0FBQ0MsSUFBSSxDQUFDLEVBQUU7VUFBQTtVQUFBbEQsY0FBQSxHQUFBcUIsQ0FBQTtVQUFBckIsY0FBQSxHQUFBRSxDQUFBO1VBQzlDaUQsT0FBTyxDQUFDQyxJQUFJLENBQUMsUUFBUU4sSUFBSSxDQUFDRyxRQUFRLENBQUNDLElBQUksd0JBQXdCLENBQUM7UUFDbEUsQ0FBQztRQUFBO1FBQUE7VUFBQWxELGNBQUEsR0FBQXFCLENBQUE7UUFBQTtNQUNIO01BQUM7TUFBQXJCLGNBQUEsR0FBQUUsQ0FBQTtNQUVELEtBQUssQ0FBQ2dDLFFBQVEsQ0FBQ0MsS0FBSyxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxPQUFPa0IsS0FBSyxFQUFFO01BQUE7TUFBQXJELGNBQUEsR0FBQUUsQ0FBQTtNQUNkLE1BQU1LLGFBQUEsQ0FBQWlDLFlBQVksQ0FBQ2MsV0FBVyxDQUFDRCxLQUFLLEVBQUU7UUFBRVQsT0FBTyxFQUFFVCxLQUFLLENBQUNVO01BQUUsQ0FBRSxDQUFDO0lBQzlEO0VBQ0Y7RUFFQTs7O0VBR0EsTUFBTVUsR0FBR0EsQ0FBQ0MsS0FBZSxFQUFFNUMsTUFBa0I7SUFBQTtJQUFBWixjQUFBLEdBQUFhLENBQUE7SUFDM0MsTUFBTTRDLFNBQVM7SUFBQTtJQUFBLENBQUF6RCxjQUFBLEdBQUFFLENBQUEsUUFBR3dELElBQUksQ0FBQ0MsR0FBRyxFQUFFO0lBQUE7SUFBQTNELGNBQUEsR0FBQUUsQ0FBQTtJQUU1QixJQUFJO01BQ0Y7TUFDQSxNQUFNMEQsY0FBYztNQUFBO01BQUEsQ0FBQTVELGNBQUEsR0FBQUUsQ0FBQSxRQUFHLE1BQU0sSUFBSSxDQUFDYyxpQkFBaUIsQ0FBQzZDLFVBQVUsQ0FBQ0wsS0FBSyxDQUFDO01BRXJFO01BQUE7TUFBQXhELGNBQUEsR0FBQUUsQ0FBQTtNQUNBLElBQUksQ0FBQ1ksa0JBQWtCLENBQUNnRCxHQUFHLENBQUNOLEtBQUssQ0FBQ08sS0FBSyxFQUFFO1FBQ3ZDTixTQUFTO1FBQ1RELEtBQUssRUFBRUksY0FBYztRQUNyQmhEO09BQ0QsQ0FBQztNQUVGO01BQUE7TUFBQVosY0FBQSxHQUFBRSxDQUFBO01BQ0EsTUFBTSxLQUFLLENBQUNxRCxHQUFHLENBQUNLLGNBQWMsRUFBRWhELE1BQU0sQ0FBQztNQUV2QztNQUNBLE1BQU1vRCxNQUFNO01BQUE7TUFBQSxDQUFBaEUsY0FBQSxHQUFBRSxDQUFBLFFBQUcsSUFBSSxDQUFDWSxrQkFBa0IsQ0FBQ21ELEdBQUcsQ0FBQ1QsS0FBSyxDQUFDTyxLQUFLLENBQUM7TUFBQTtNQUFBL0QsY0FBQSxHQUFBRSxDQUFBO01BQ3ZELElBQUk4RCxNQUFNLEVBQUU7UUFBQTtRQUFBaEUsY0FBQSxHQUFBcUIsQ0FBQTtRQUFBckIsY0FBQSxHQUFBRSxDQUFBO1FBQ1Y4RCxNQUFNLENBQUNFLE9BQU8sR0FBR1IsSUFBSSxDQUFDQyxHQUFHLEVBQUU7UUFBQTtRQUFBM0QsY0FBQSxHQUFBRSxDQUFBO1FBQzNCOEQsTUFBTSxDQUFDRyxRQUFRLEdBQUdILE1BQU0sQ0FBQ0UsT0FBTyxHQUFHRixNQUFNLENBQUNQLFNBQVM7TUFDckQsQ0FBQztNQUFBO01BQUE7UUFBQXpELGNBQUEsR0FBQXFCLENBQUE7TUFBQTtJQUNILENBQUMsQ0FBQyxPQUFPZ0MsS0FBSyxFQUFFO01BQ2Q7TUFDQSxNQUFNZSxjQUFjO01BQUE7TUFBQSxDQUFBcEUsY0FBQSxHQUFBRSxDQUFBLFFBQUcsSUFBSSxDQUFDYyxpQkFBaUIsQ0FBQ3FELFlBQVksQ0FBQzlELGFBQUEsQ0FBQWlDLFlBQVksQ0FBQ2MsV0FBVyxDQUFDRCxLQUFLLENBQUMsRUFBRTtRQUMxRlUsS0FBSyxFQUFFUCxLQUFLLENBQUNPLEtBQUs7UUFDbEJPLFFBQVEsRUFBRWQsS0FBSyxDQUFDYztPQUNqQixDQUFDO01BQUE7TUFBQXRFLGNBQUEsR0FBQUUsQ0FBQTtNQUVGLElBQUlrRSxjQUFjLEVBQUU7UUFBQTtRQUFBcEUsY0FBQSxHQUFBcUIsQ0FBQTtRQUFBckIsY0FBQSxHQUFBRSxDQUFBO1FBQ2xCLE1BQU1rRSxjQUFjO01BQ3RCLENBQUM7TUFBQTtNQUFBO1FBQUFwRSxjQUFBLEdBQUFxQixDQUFBO01BQUE7SUFDSDtFQUNGO0VBRUE7OztFQUdVLE1BQU1rRCxXQUFXQSxDQUFDQyxRQUFnQixFQUFFQyxRQUFnQjtJQUFBO0lBQUF6RSxjQUFBLEdBQUFhLENBQUE7SUFBQWIsY0FBQSxHQUFBRSxDQUFBO0lBQzVELElBQUk7TUFDRixJQUFJd0UsSUFBSTtNQUFBO01BQUEsQ0FBQTFFLGNBQUEsR0FBQUUsQ0FBQSxRQUFRLEVBQUU7TUFBQTtNQUFBRixjQUFBLEdBQUFFLENBQUE7TUFDbEIsSUFBSTtRQUFBO1FBQUFGLGNBQUEsR0FBQUUsQ0FBQTtRQUNGd0UsSUFBSSxHQUFHQyxJQUFJLENBQUNDLEtBQUssQ0FBQ0gsUUFBUSxDQUFDO01BQzdCLENBQUMsQ0FBQyxPQUFPSSxDQUFDLEVBQUU7UUFBQTtRQUFBN0UsY0FBQSxHQUFBRSxDQUFBO1FBQ1YsTUFBTUssYUFBQSxDQUFBaUMsWUFBWSxDQUFDQyxXQUFXLENBQUNsQyxhQUFBLENBQUFtQyxhQUFhLENBQUNvQyxpQkFBaUIsRUFBRTtVQUFFTCxRQUFRO1VBQUVNLFVBQVUsRUFBRUY7UUFBQyxDQUFFLEVBQUU7VUFBRUw7UUFBUSxDQUFFLENBQUM7TUFDNUc7TUFFQTtNQUFBO01BQUF4RSxjQUFBLEdBQUFFLENBQUE7TUFDQSxJQUFJLElBQUksQ0FBQ2dCLFlBQVksQ0FBQzhCLEdBQUcsQ0FBQ3dCLFFBQVEsQ0FBQyxFQUFFO1FBQUE7UUFBQXhFLGNBQUEsR0FBQXFCLENBQUE7UUFBQXJCLGNBQUEsR0FBQUUsQ0FBQTtRQUNuQyxPQUFPLE1BQU0sSUFBSSxDQUFDZ0IsWUFBWSxDQUFDOEQsT0FBTyxDQUFDUixRQUFRLEVBQUVFLElBQUksRUFBRTtVQUNyREosUUFBUSxFQUFFLElBQUksQ0FBQzFELE1BQU0sQ0FBQzBELFFBQVE7VUFDOUJXLFNBQVMsRUFBRXZCLElBQUksQ0FBQ0MsR0FBRztTQUNwQixDQUFDO01BQ0osQ0FBQztNQUFBO01BQUE7UUFBQTNELGNBQUEsR0FBQXFCLENBQUE7TUFBQTtNQUVEO01BQUFyQixjQUFBLEdBQUFFLENBQUE7TUFDQSxPQUFPLE1BQU0sS0FBSyxDQUFDcUUsV0FBVyxDQUFDQyxRQUFRLEVBQUVDLFFBQVEsQ0FBQztJQUNwRCxDQUFDLENBQUMsT0FBT3BCLEtBQUssRUFBRTtNQUFBO01BQUFyRCxjQUFBLEdBQUFFLENBQUE7TUFDZCxNQUFNSyxhQUFBLENBQUFpQyxZQUFZLENBQUNjLFdBQVcsQ0FBQ0QsS0FBSyxFQUFFO1FBQUVtQixRQUFRO1FBQUVDO01BQVEsQ0FBRSxDQUFDO0lBQy9EO0VBQ0Y7RUFFQTs7O0VBR1VTLFNBQVNBLENBQUNDLEtBQWdCO0lBQUE7SUFBQW5GLGNBQUEsR0FBQWEsQ0FBQTtJQUFBYixjQUFBLEdBQUFFLENBQUE7SUFDbEMsSUFBSTtNQUNGO01BQ0EsTUFBTWtGLGNBQWM7TUFBQTtNQUFBLENBQUFwRixjQUFBLEdBQUFFLENBQUEsUUFBRyxJQUFJLENBQUNjLGlCQUFpQixDQUFDcUUsWUFBWSxDQUFDRixLQUFLLENBQUM7TUFBQTtNQUFBbkYsY0FBQSxHQUFBRSxDQUFBO01BRWpFLElBQUlrRixjQUFjLEVBQUU7UUFBQTtRQUFBcEYsY0FBQSxHQUFBcUIsQ0FBQTtRQUFBckIsY0FBQSxHQUFBRSxDQUFBO1FBQ2xCLEtBQUssQ0FBQ2dGLFNBQVMsQ0FBQ0UsY0FBYyxDQUFDO01BQ2pDLENBQUM7TUFBQTtNQUFBO1FBQUFwRixjQUFBLEdBQUFxQixDQUFBO01BQUE7SUFDSCxDQUFDLENBQUMsT0FBT2dDLEtBQUssRUFBRTtNQUFBO01BQUFyRCxjQUFBLEdBQUFFLENBQUE7TUFDZGlELE9BQU8sQ0FBQ0UsS0FBSyxDQUFDLDRDQUE0QyxFQUFFQSxLQUFLLENBQUM7TUFDbEU7TUFBQTtNQUFBckQsY0FBQSxHQUFBRSxDQUFBO01BQ0EsS0FBSyxDQUFDZ0YsU0FBUyxDQUFDQyxLQUFLLENBQUM7SUFDeEI7RUFDRjtFQUVBOzs7RUFHQUcsWUFBWUEsQ0FBQ0MsUUFBYTtJQUFBO0lBQUF2RixjQUFBLEdBQUFhLENBQUE7SUFBQWIsY0FBQSxHQUFBRSxDQUFBO0lBQ3hCLElBQUksQ0FBQ2dCLFlBQVksQ0FBQ0ksUUFBUSxDQUFDaUUsUUFBUSxDQUFDO0VBQ3RDO0VBRUE7OztFQUdBQyxrQkFBa0JBLENBQUNDLFVBQWU7SUFBQTtJQUFBekYsY0FBQSxHQUFBYSxDQUFBO0lBQUFiLGNBQUEsR0FBQUUsQ0FBQTtJQUNoQyxJQUFJLENBQUNjLGlCQUFpQixDQUFDTSxRQUFRLENBQUNtRSxVQUFVLENBQUM7RUFDN0M7RUFFQTs7O0VBR0FDLHFCQUFxQkEsQ0FBQTtJQUFBO0lBQUExRixjQUFBLEdBQUFhLENBQUE7SUFDbkIsTUFBTThFLE1BQU07SUFBQTtJQUFBLENBQUEzRixjQUFBLEdBQUFFLENBQUEsUUFBd0IsRUFBRTtJQUFBO0lBQUFGLGNBQUEsR0FBQUUsQ0FBQTtJQUN0QyxLQUFLLE1BQU0sQ0FBQzZELEtBQUssRUFBRUMsTUFBTSxDQUFDLElBQUksSUFBSSxDQUFDbEQsa0JBQWtCLENBQUM4RSxPQUFPLEVBQUUsRUFBRTtNQUFBO01BQUE1RixjQUFBLEdBQUFFLENBQUE7TUFDL0R5RixNQUFNLENBQUM1QixLQUFLLENBQUMsR0FBRztRQUFFLEdBQUdDO01BQU0sQ0FBRTtJQUMvQjtJQUFDO0lBQUFoRSxjQUFBLEdBQUFFLENBQUE7SUFDRCxPQUFPeUYsTUFBTTtFQUNmO0VBRUE7OztFQUdBRSxpQkFBaUJBLENBQUE7SUFBQTtJQUFBN0YsY0FBQSxHQUFBYSxDQUFBO0lBQUFiLGNBQUEsR0FBQUUsQ0FBQTtJQUNmLE9BQU8sSUFBSSxDQUFDZ0IsWUFBWSxDQUFDNEUsWUFBWSxFQUFFO0VBQ3pDO0VBRUE7OztFQUdBQyxjQUFjQSxDQUFBO0lBQUE7SUFBQS9GLGNBQUEsR0FBQWEsQ0FBQTtJQUFBYixjQUFBLEdBQUFFLENBQUE7SUFDWixPQUFPTSxTQUFBLENBQUE4QixvQkFBb0IsQ0FBQzBELHFCQUFxQixFQUFFO0VBQ3JEO0VBRUE7OztFQUdBLE1BQU1DLFdBQVdBLENBQUE7SUFBQTtJQUFBakcsY0FBQSxHQUFBYSxDQUFBO0lBSWYsTUFBTXFGLE9BQU87SUFBQTtJQUFBLENBQUFsRyxjQUFBLEdBQUFFLENBQUEsUUFBd0I7TUFDbkNpRyxPQUFPLEVBQUUzRixTQUFBLENBQUE4QixvQkFBb0IsQ0FBQzBELHFCQUFxQixFQUFFO01BQ3JEakQsS0FBSyxFQUFFLElBQUksQ0FBQzdCLFlBQVksQ0FBQzRFLFlBQVksRUFBRTtNQUN2Q0wsVUFBVSxFQUFFVyxLQUFLLENBQUNDLElBQUksQ0FBRSxJQUFJLENBQUNyRixpQkFBeUIsQ0FBQ3NGLFdBQVcsQ0FBQ0MsSUFBSSxFQUFFLENBQUM7TUFDMUVDLE9BQU8sRUFBRUMsTUFBTSxDQUFDRixJQUFJLENBQUMsSUFBSSxDQUFDekYsa0JBQWtCLENBQUMsQ0FBQzRGO0tBQy9DO0lBQUE7SUFBQTFHLGNBQUEsR0FBQUUsQ0FBQTtJQUVELElBQUk7TUFDRjtNQUNBLE1BQU15RyxTQUFTO01BQUE7TUFBQSxDQUFBM0csY0FBQSxHQUFBRSxDQUFBLFFBQWM7UUFDM0IwRyxJQUFJLEVBQUUsUUFBUTtRQUNkMUQsSUFBSSxFQUFFLGNBQWM7UUFDcEIyRCxJQUFJLEVBQUU7VUFBRTVCLFNBQVMsRUFBRXZCLElBQUksQ0FBQ0MsR0FBRztRQUFFLENBQUU7UUFDL0JzQixTQUFTLEVBQUV2QixJQUFJLENBQUNDLEdBQUc7T0FDcEI7TUFBQTtNQUFBM0QsY0FBQSxHQUFBRSxDQUFBO01BRUQsSUFBSSxDQUFDYyxpQkFBaUIsQ0FBQ3FFLFlBQVksQ0FBQ3NCLFNBQVMsQ0FBQztNQUFBO01BQUEzRyxjQUFBLEdBQUFFLENBQUE7TUFFOUNnRyxPQUFPLENBQUNZLE1BQU0sR0FBRyxTQUFTO01BQUE7TUFBQTlHLGNBQUEsR0FBQUUsQ0FBQTtNQUMxQixPQUFPO1FBQUU0RyxNQUFNLEVBQUUsU0FBUztRQUFFWjtNQUFPLENBQUU7SUFDdkMsQ0FBQyxDQUFDLE9BQU83QyxLQUFLLEVBQUU7TUFBQTtNQUFBckQsY0FBQSxHQUFBRSxDQUFBO01BQ2RnRyxPQUFPLENBQUM3QyxLQUFLLEdBQUdBLEtBQUssWUFBWTBELEtBQUs7TUFBQTtNQUFBLENBQUEvRyxjQUFBLEdBQUFxQixDQUFBLFdBQUdnQyxLQUFLLENBQUMyRCxPQUFPO01BQUE7TUFBQSxDQUFBaEgsY0FBQSxHQUFBcUIsQ0FBQSxXQUFHNEYsTUFBTSxDQUFDNUQsS0FBSyxDQUFDO01BQUE7TUFBQXJELGNBQUEsR0FBQUUsQ0FBQTtNQUN0RSxPQUFPO1FBQUU0RyxNQUFNLEVBQUUsV0FBVztRQUFFWjtNQUFPLENBQUU7SUFDekM7RUFDRjtFQUVBOzs7RUFHQWdCLE9BQU9BLENBQUE7SUFBQTtJQUFBbEgsY0FBQSxHQUFBYSxDQUFBO0lBQUFiLGNBQUEsR0FBQUUsQ0FBQTtJQUNMO0lBQ0EsSUFBSSxDQUFDYyxpQkFBaUIsQ0FBQ2tHLE9BQU8sRUFBRTtJQUVoQztJQUFBO0lBQUFsSCxjQUFBLEdBQUFFLENBQUE7SUFDQSxJQUFJLENBQUNZLGtCQUFrQixDQUFDcUcsS0FBSyxFQUFFO0lBRS9CO0lBQUE7SUFBQW5ILGNBQUEsR0FBQUUsQ0FBQTtJQUNBLEtBQUssQ0FBQ2dILE9BQU8sRUFBRTtFQUNqQjs7QUFDRDtBQUFBbEgsY0FBQSxHQUFBRSxDQUFBO0FBclBEa0gsT0FBQSxDQUFBM0csbUJBQUEsR0FBQUEsbUJBQUEiLCJpZ25vcmVMaXN0IjpbXX0=