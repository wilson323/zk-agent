{"version":3,"names":["cov_2asuj2vwch","actualCoverage","s","exports","GET","server_1","require","prom_client_1","req","f","metrics","register","NextResponse","status","headers","contentType","error","console"],"sources":["E:\\zk-agent\\app\\api\\metrics\\route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { register } from 'prom-client';\nimport { databaseMonitor } from '@/lib/database/monitoring';\nimport { aiModelManager } from '@/lib/ai-models/model-manager';\n\nexport async function GET(req: NextRequest) {\n  try {\n    // Ensure metrics are collected before exposing\n    // This might involve calling methods on databaseMonitor and aiModelManager\n    // to update their internal metrics that are then exposed by prom-client\n\n    // Example: Manually trigger metric collection if not already automated\n    // databaseMonitor.collectMetrics(); \n    // aiModelManager.collectMetrics(); \n\n    const metrics = await register.metrics();\n    return new NextResponse(metrics, {\n      status: 200,\n      headers: {\n        'Content-Type': register.contentType,\n      },\n    });\n  } catch (error) {\n    console.error('Error generating Prometheus metrics:', error);\n    return new NextResponse('Error generating metrics', { status: 500 });\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAiBM;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAAAA,cAAA,GAAAE,CAAA;;;;;;AAZNC,OAAA,CAAAC,GAAA,GAAAA,GAAA;AALA,MAAAC,QAAA;AAAA;AAAA,CAAAL,cAAA,GAAAE,CAAA,OAAAI,OAAA;AACA,MAAAC,aAAA;AAAA;AAAA,CAAAP,cAAA,GAAAE,CAAA,OAAAI,OAAA;AAIO,eAAeF,GAAGA,CAACI,GAAgB;EAAA;EAAAR,cAAA,GAAAS,CAAA;EAAAT,cAAA,GAAAE,CAAA;EACxC,IAAI;IACF;IACA;IACA;IAEA;IACA;IACA;IAEA,MAAMQ,OAAO;IAAA;IAAA,CAAAV,cAAA,GAAAE,CAAA,OAAG,MAAMK,aAAA,CAAAI,QAAQ,CAACD,OAAO,EAAE;IAAC;IAAAV,cAAA,GAAAE,CAAA;IACzC,OAAO,IAAIG,QAAA,CAAAO,YAAY,CAACF,OAAO,EAAE;MAC/BG,MAAM,EAAE,GAAG;MACXC,OAAO,EAAE;QACP,cAAc,EAAEP,aAAA,CAAAI,QAAQ,CAACI;;KAE5B,CAAC;EACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;IAAA;IAAAhB,cAAA,GAAAE,CAAA;IACde,OAAO,CAACD,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;IAAC;IAAAhB,cAAA,GAAAE,CAAA;IAC7D,OAAO,IAAIG,QAAA,CAAAO,YAAY,CAAC,0BAA0B,EAAE;MAAEC,MAAM,EAAE;IAAG,CAAE,CAAC;EACtE;AACF","ignoreList":[]}