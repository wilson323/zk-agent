{"version":3,"names":["cov_1f71kdxnc3","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","type","locations","undefined","s","f","b","inputSourceMap","file","mappings","names","sources","sourcesContent","version","_coverageSchema","coverage","actualCoverage","EnhancedShareManager","generateSharePoster","config","response","fetch","method","headers","body","JSON","stringify","result","json","success","shareId","imageUrl","downloadUrl","error","downloadShare","format","ok","blob","url","window","URL","createObjectURL","link","document","createElement","href","download","appendChild","click","removeChild","revokeObjectURL","console","exports","enhancedShareManager"],"sources":["E:\\zk-agent\\lib\\sharing\\enhanced-share-manager.ts"],"sourcesContent":["// @ts-nocheck\n/**\n * 增强分享管理器\n * 专注于海报图片分享功能\n */\n\nexport interface ShareConfig {\n  type: \"poster\" | \"cad_report\" | \"chat_export\"\n  title: string\n  description?: string\n  imageUrl?: string\n  watermark?: boolean\n  quality?: \"web\" | \"print\" | \"high\"\n}\n\nexport interface ShareResult {\n  success: boolean\n  shareId?: string\n  imageUrl?: string\n  downloadUrl?: string\n  error?: string\n}\n\nexport class EnhancedShareManager {\n  /**\n   * 生成分享海报\n   */\n  async generateSharePoster(config: ShareConfig): Promise<ShareResult> {\n    try {\n      const response = await fetch(\"/api/sharing/generate-poster\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(config),\n      })\n\n      const result = await response.json()\n\n      if (result.success) {\n        return {\n          success: true,\n          shareId: result.shareId,\n          imageUrl: result.imageUrl,\n          downloadUrl: result.downloadUrl,\n        }\n      }\n\n      return { success: false, error: result.error }\n    } catch (error) {\n      return { success: false, error: \"生成分享海报失败\" }\n    }\n  }\n\n  /**\n   * 下载分享内容\n   */\n  async downloadShare(shareId: string, format: \"jpg\" | \"png\" | \"pdf\" = \"jpg\"): Promise<void> {\n    try {\n      const response = await fetch(`/api/sharing/${shareId}/download?format=${format}`)\n\n      if (response.ok) {\n        const blob = await response.blob()\n        const url = window.URL.createObjectURL(blob)\n        const link = document.createElement(\"a\")\n        link.href = url\n        link.download = `share-${shareId}.${format}`\n        document.body.appendChild(link)\n        link.click()\n        document.body.removeChild(link)\n        window.URL.revokeObjectURL(url)\n      }\n    } catch (error) {\n      console.error(\"下载失败:\", error)\n    }\n  }\n}\n\nexport const enhancedShareManager = new EnhancedShareManager()\n"],"mappings":"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","ignoreList":[]}