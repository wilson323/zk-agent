23eaa48a39469b32c7e399c62e1b0012
"use strict";
// ÁÆÄÂåñÁöÑÂÖ®Â±ÄÈîôËØØÂ§ÑÁêÜÂô®ÊµãËØï
// ÈÅøÂÖçNext.js‰æùËµñÈóÆÈ¢òÔºå‰∏ìÊ≥®‰∫éÊ†∏ÂøÉÈÄªËæëÊµãËØï
Object.defineProperty(exports, "__esModule", { value: true });
const vitest_1 = require("vitest");
// Mock Next.js dependencies
const mockNextResponse = {
    json: vitest_1.vi.fn((data, options) => ({
        json: async () => data,
        status: options?.status || 200,
        headers: options?.headers || {}
    }))
};
vitest_1.vi.mock('next/server', () => ({
    NextResponse: mockNextResponse,
    NextRequest: vitest_1.vi.fn()
}));
vitest_1.vi.mock('../../lib/utils/api-logger', () => ({
    ApiLogger: {
        error: vitest_1.vi.fn(),
        info: vitest_1.vi.fn(),
        warn: vitest_1.vi.fn()
    }
}));
vitest_1.vi.mock('../../lib/types/api-response', () => ({
    ErrorCode: {
        VALIDATION_ERROR: 'VALIDATION_ERROR',
        NETWORK_ERROR: 'NETWORK_ERROR',
        SERVICE_UNAVAILABLE: 'SERVICE_UNAVAILABLE',
        INTERNAL_ERROR: 'INTERNAL_ERROR'
    }
}));
// ÁÆÄÂåñÁöÑÈîôËØØÁ±ªÂûãÂÆö‰πâ
var AgentErrorType;
(function (AgentErrorType) {
    AgentErrorType["VALIDATION_ERROR"] = "VALIDATION_ERROR";
    AgentErrorType["NETWORK_ERROR"] = "NETWORK_ERROR";
    AgentErrorType["SYSTEM_ERROR"] = "SYSTEM_ERROR";
    AgentErrorType["SERVICE_UNAVAILABLE"] = "SERVICE_UNAVAILABLE";
})(AgentErrorType || (AgentErrorType = {}));
// ÁÆÄÂåñÁöÑAgentErrorÁ±ª
class AgentError extends Error {
    constructor(type, message, context, statusCode) {
        super(message);
        this.name = 'AgentError';
        this.id = Math.random().toString(36).substr(2, 9);
        this.type = type;
        this.context = context;
        this.timestamp = new Date().toISOString();
        this.statusCode = statusCode || this.getDefaultStatusCode(type);
        this.userMessage = this.getUserMessage(type);
        this.retryable = this.isRetryableError(type);
    }
    getDefaultStatusCode(type) {
        switch (type) {
            case AgentErrorType.VALIDATION_ERROR:
                return 400;
            case AgentErrorType.NETWORK_ERROR:
                return 502;
            case AgentErrorType.SERVICE_UNAVAILABLE:
                return 503;
            default:
                return 500;
        }
    }
    getUserMessage(type) {
        switch (type) {
            case AgentErrorType.VALIDATION_ERROR:
                return 'ËØ∑Ê±ÇÂèÇÊï∞ÊúâËØØÔºåËØ∑Ê£ÄÊü•ÂêéÈáçËØï';
            case AgentErrorType.NETWORK_ERROR:
                return 'ÁΩëÁªúËøûÊé•ÂºÇÂ∏∏ÔºåËØ∑Á®çÂêéÈáçËØï';
            case AgentErrorType.SERVICE_UNAVAILABLE:
                return 'ÊúçÂä°ÊöÇÊó∂‰∏çÂèØÁî®ÔºåËØ∑Á®çÂêéÈáçËØï';
            default:
                return 'Á≥ªÁªüÂÜÖÈÉ®ÈîôËØØÔºåËØ∑ËÅîÁ≥ªÁÆ°ÁêÜÂëò';
        }
    }
    isRetryableError(type) {
        return [AgentErrorType.NETWORK_ERROR, AgentErrorType.SERVICE_UNAVAILABLE].includes(type);
    }
}
// ÁÆÄÂåñÁöÑÂÖ®Â±ÄÈîôËØØÂ§ÑÁêÜÂô®
class GlobalErrorHandler {
    constructor() {
        this.errorCount = 0;
        this.lastErrorTime = 0;
        this.circuitBreakerOpen = false;
        this.circuitBreakerTimeout = 60000;
        this.timeWindowMs = 60000;
        this.errorThreshold = parseInt(process.env.ERROR_THRESHOLD || '50');
    }
    static getInstance() {
        if (!GlobalErrorHandler.instance) {
            GlobalErrorHandler.instance = new GlobalErrorHandler();
        }
        return GlobalErrorHandler.instance;
    }
    handleError(error, context) {
        try {
            let agentError;
            if (error instanceof AgentError) {
                agentError = error;
            }
            else {
                // ÂàÜÁ±ªÊôÆÈÄöÈîôËØØ
                const errorType = this.classifyError(error);
                agentError = new AgentError(errorType, error.message, context);
            }
            // ËÆ∞ÂΩïÈîôËØØ
            this.recordError(agentError);
            // Ê£ÄÊü•Êó∂Èó¥Á™óÂè£Âπ∂Êõ¥Êñ∞ÁªüËÆ°
            this.checkTimeWindowAndUpdateStats();
            // Ê£ÄÊü•Êñ≠Ë∑ØÂô®
            if (this.errorCount >= this.errorThreshold) {
                this.openCircuitBreaker();
            }
            return this.createErrorResponse(agentError);
        }
        catch (handlerError) {
            console.error('Error in error handler:', handlerError);
            return this.createFallbackResponse();
        }
    }
    classifyError(error) {
        if (error.name === 'ValidationError' || error.message.includes('validation')) {
            return AgentErrorType.VALIDATION_ERROR;
        }
        if (error.name === 'NetworkError' || error.message.includes('network')) {
            return AgentErrorType.NETWORK_ERROR;
        }
        return AgentErrorType.SYSTEM_ERROR;
    }
    recordError(error) {
        console.error('Error recorded:', {
            id: error.id,
            type: error.type,
            message: error.message,
            timestamp: error.timestamp
        });
    }
    updateErrorStats() {
        const now = Date.now();
        this.errorCount++;
        this.lastErrorTime = now;
    }
    checkTimeWindowAndUpdateStats() {
        const now = Date.now();
        // Ê£ÄÊü•Êó∂Èó¥Á™óÂè£ÊòØÂê¶ËøáÊúü
        if (this.lastErrorTime > 0 && now - this.lastErrorTime > this.timeWindowMs) {
            this.errorCount = 0;
        }
        // Êõ¥Êñ∞ÁªüËÆ°
        this.errorCount++;
        this.lastErrorTime = now;
    }
    shouldTriggerCircuitBreaker() {
        const now = Date.now();
        if (now - this.lastErrorTime > this.timeWindowMs) {
            this.errorCount = 0;
            this.lastErrorTime = now;
        }
        return this.errorCount >= this.errorThreshold;
    }
    openCircuitBreaker() {
        if (this.circuitBreakerOpen) {
            return;
        }
        this.circuitBreakerOpen = true;
        console.warn('üö® Circuit breaker opened due to high error rate');
        if (this.circuitBreakerResetTimer) {
            clearTimeout(this.circuitBreakerResetTimer);
        }
        this.circuitBreakerResetTimer = setTimeout(() => {
            this.circuitBreakerOpen = false;
            this.errorCount = 0;
            this.lastErrorTime = 0;
            console.info('‚úÖ Circuit breaker closed, service restored');
        }, this.circuitBreakerTimeout);
    }
    createErrorResponse(error) {
        return mockNextResponse.json({
            success: false,
            error: {
                code: error.type,
                message: error.userMessage,
                type: error.type
            },
            requestId: error.id,
            timestamp: error.timestamp
        }, { status: error.statusCode });
    }
    createFallbackResponse() {
        return mockNextResponse.json({
            success: false,
            error: {
                code: 'INTERNAL_ERROR',
                message: 'Á≥ªÁªüÂÜÖÈÉ®ÈîôËØØ',
                type: 'SYSTEM_ERROR'
            },
            timestamp: new Date().toISOString()
        }, { status: 500 });
    }
    isCircuitBreakerOpen() {
        return this.circuitBreakerOpen;
    }
    getErrorStats() {
        return {
            errorCount: this.errorCount,
            lastErrorTime: this.lastErrorTime,
            circuitBreakerOpen: this.circuitBreakerOpen,
            errorThreshold: this.errorThreshold,
            timeWindowMs: this.timeWindowMs
        };
    }
    // ÈáçÁΩÆÂÆû‰æãÔºàÁî®‰∫éÊµãËØïÔºâ
    static resetInstance() {
        GlobalErrorHandler.instance = undefined;
    }
}
(0, vitest_1.describe)('GlobalErrorHandler', () => {
    let errorHandler;
    (0, vitest_1.beforeEach)(() => {
        GlobalErrorHandler.resetInstance();
        errorHandler = GlobalErrorHandler.getInstance();
        delete process.env.ERROR_THRESHOLD;
        vitest_1.vi.clearAllMocks();
        vitest_1.vi.spyOn(console, 'error').mockImplementation(() => { });
        vitest_1.vi.spyOn(console, 'warn').mockImplementation(() => { });
        vitest_1.vi.spyOn(console, 'info').mockImplementation(() => { });
    });
    (0, vitest_1.afterEach)(() => {
        vitest_1.vi.restoreAllMocks();
    });
    (0, vitest_1.describe)('Singleton Pattern', () => {
        (0, vitest_1.it)('should return the same instance', () => {
            const instance1 = GlobalErrorHandler.getInstance();
            const instance2 = GlobalErrorHandler.getInstance();
            (0, vitest_1.expect)(instance1).toBe(instance2);
        });
    });
    (0, vitest_1.describe)('Error Classification', () => {
        (0, vitest_1.it)('should classify validation errors correctly', () => {
            const validationError = new Error('Validation failed');
            validationError.name = 'ValidationError';
            const result = errorHandler.handleError(validationError);
            (0, vitest_1.expect)(result).toBeDefined();
            (0, vitest_1.expect)(mockNextResponse.json).toHaveBeenCalled();
        });
        (0, vitest_1.it)('should classify network errors correctly', () => {
            const networkError = new Error('Network timeout');
            networkError.name = 'NetworkError';
            const result = errorHandler.handleError(networkError);
            (0, vitest_1.expect)(result).toBeDefined();
        });
        (0, vitest_1.it)('should handle AgentError instances', () => {
            const agentError = new AgentError(AgentErrorType.VALIDATION_ERROR, 'Test validation error', { field: 'email' });
            const result = errorHandler.handleError(agentError);
            (0, vitest_1.expect)(result).toBeDefined();
        });
    });
    (0, vitest_1.describe)('Circuit Breaker', () => {
        (0, vitest_1.it)('should not trigger circuit breaker with few errors', () => {
            for (let i = 0; i < 10; i++) {
                errorHandler.handleError(new Error(`Error ${i}`));
            }
            (0, vitest_1.expect)(errorHandler.isCircuitBreakerOpen()).toBe(false);
        });
        (0, vitest_1.it)('should trigger circuit breaker with many errors', () => {
            process.env.ERROR_THRESHOLD = '5';
            GlobalErrorHandler.resetInstance();
            errorHandler = GlobalErrorHandler.getInstance();
            for (let i = 0; i < 6; i++) {
                errorHandler.handleError(new Error(`Error ${i}`));
            }
            (0, vitest_1.expect)(errorHandler.isCircuitBreakerOpen()).toBe(true);
        });
        (0, vitest_1.it)('should reset error count after time window', () => {
            errorHandler.handleError(new Error('Test error'));
            const stats = errorHandler.getErrorStats();
            (0, vitest_1.expect)(stats.errorCount).toBe(1);
            vitest_1.vi.useFakeTimers();
            vitest_1.vi.advanceTimersByTime(61000);
            errorHandler.handleError(new Error('Another error'));
            const newStats = errorHandler.getErrorStats();
            (0, vitest_1.expect)(newStats.errorCount).toBe(1);
            vitest_1.vi.useRealTimers();
        });
    });
    (0, vitest_1.describe)('Error Statistics', () => {
        (0, vitest_1.it)('should track error statistics correctly', () => {
            const initialStats = errorHandler.getErrorStats();
            (0, vitest_1.expect)(initialStats.errorCount).toBe(0);
            errorHandler.handleError(new Error('Test error'));
            const updatedStats = errorHandler.getErrorStats();
            (0, vitest_1.expect)(updatedStats.errorCount).toBe(1);
            (0, vitest_1.expect)(updatedStats.lastErrorTime).toBeGreaterThan(0);
        });
        (0, vitest_1.it)('should include configuration in stats', () => {
            const stats = errorHandler.getErrorStats();
            (0, vitest_1.expect)(stats).toHaveProperty('errorThreshold');
            (0, vitest_1.expect)(stats).toHaveProperty('timeWindowMs');
            (0, vitest_1.expect)(stats.timeWindowMs).toBe(60000);
        });
    });
    (0, vitest_1.describe)('Error Response Format', () => {
        (0, vitest_1.it)('should create properly formatted error responses', async () => {
            const error = new AgentError(AgentErrorType.VALIDATION_ERROR, 'Test validation error', { field: 'email' });
            const response = errorHandler.handleError(error);
            const responseBody = await response.json();
            (0, vitest_1.expect)(responseBody).toHaveProperty('success', false);
            (0, vitest_1.expect)(responseBody).toHaveProperty('error');
            (0, vitest_1.expect)(responseBody).toHaveProperty('requestId');
            (0, vitest_1.expect)(responseBody).toHaveProperty('timestamp');
            (0, vitest_1.expect)(responseBody.error).toHaveProperty('code');
            (0, vitest_1.expect)(responseBody.error).toHaveProperty('message');
            (0, vitest_1.expect)(responseBody.error).toHaveProperty('type');
        });
    });
    (0, vitest_1.describe)('Error Recording', () => {
        (0, vitest_1.it)('should record errors to monitoring system', () => {
            const consoleSpy = vitest_1.vi.spyOn(console, 'error');
            const error = new AgentError(AgentErrorType.SYSTEM_ERROR, 'Test system error');
            errorHandler.handleError(error);
            (0, vitest_1.expect)(consoleSpy).toHaveBeenCalledWith('Error recorded:', vitest_1.expect.objectContaining({
                id: vitest_1.expect.any(String),
                type: AgentErrorType.SYSTEM_ERROR,
                message: 'Test system error',
                timestamp: vitest_1.expect.any(String)
            }));
        });
    });
    (0, vitest_1.describe)('Fallback Error Handling', () => {
        (0, vitest_1.it)('should handle errors within the error handler', () => {
            // Ê®°ÊãüÈîôËØØÂ§ÑÁêÜÂô®ÂÜÖÈÉ®ÈîôËØØ
            const originalRecordError = errorHandler.recordError;
            errorHandler.recordError = () => {
                throw new Error('Recording failed');
            };
            const result = errorHandler.handleError(new Error('Test error'));
            (0, vitest_1.expect)(result).toBeDefined();
            // ÊÅ¢Â§çÂéüÊñπÊ≥ï
            errorHandler.recordError = originalRecordError;
        });
    });
});
// ÈõÜÊàêÊµãËØï
(0, vitest_1.describe)('GlobalErrorHandler Integration', () => {
    (0, vitest_1.it)('should handle complete error flow', async () => {
        const errorHandler = GlobalErrorHandler.getInstance();
        const error = new Error('Database connection failed');
        const result = errorHandler.handleError(error);
        (0, vitest_1.expect)(result).toBeDefined();
        (0, vitest_1.expect)(result.status).toBeGreaterThanOrEqual(400);
        const responseBody = await result.json();
        (0, vitest_1.expect)(responseBody.success).toBe(false);
        (0, vitest_1.expect)(responseBody.error).toBeDefined();
        (0, vitest_1.expect)(responseBody.requestId).toBeDefined();
    });
    (0, vitest_1.it)('should maintain circuit breaker state across multiple errors', () => {
        process.env.ERROR_THRESHOLD = '3';
        GlobalErrorHandler.resetInstance();
        const errorHandler = GlobalErrorHandler.getInstance();
        // Ëß¶ÂèëÊñ≠Ë∑ØÂô®
        for (let i = 0; i < 4; i++) {
            errorHandler.handleError(new Error(`Error ${i}`));
        }
        (0, vitest_1.expect)(errorHandler.isCircuitBreakerOpen()).toBe(true);
        const stats = errorHandler.getErrorStats();
        (0, vitest_1.expect)(stats.circuitBreakerOpen).toBe(true);
        (0, vitest_1.expect)(stats.errorCount).toBeGreaterThanOrEqual(3);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiRTpcXHprLWFnZW50XFx0ZXN0c1xcbWlkZGxld2FyZVxcZ2xvYmFsLWVycm9yLWhhbmRsZXIudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUEsZUFBZTtBQUNmLDBCQUEwQjs7QUFFMUIsbUNBQXlFO0FBRXpFLDRCQUE0QjtBQUM1QixNQUFNLGdCQUFnQixHQUFHO0lBQ3ZCLElBQUksRUFBRSxXQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBUyxFQUFFLE9BQWEsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUN6QyxJQUFJLEVBQUUsS0FBSyxJQUFJLEVBQUUsQ0FBQyxJQUFJO1FBQ3RCLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTSxJQUFJLEdBQUc7UUFDOUIsT0FBTyxFQUFFLE9BQU8sRUFBRSxPQUFPLElBQUksRUFBRTtLQUNoQyxDQUFDLENBQUM7Q0FDSixDQUFDO0FBRUYsV0FBRSxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUM1QixZQUFZLEVBQUUsZ0JBQWdCO0lBQzlCLFdBQVcsRUFBRSxXQUFFLENBQUMsRUFBRSxFQUFFO0NBQ3JCLENBQUMsQ0FBQyxDQUFDO0FBRUosV0FBRSxDQUFDLElBQUksQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQzNDLFNBQVMsRUFBRTtRQUNULEtBQUssRUFBRSxXQUFFLENBQUMsRUFBRSxFQUFFO1FBQ2QsSUFBSSxFQUFFLFdBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDYixJQUFJLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtLQUNkO0NBQ0YsQ0FBQyxDQUFDLENBQUM7QUFFSixXQUFFLENBQUMsSUFBSSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDN0MsU0FBUyxFQUFFO1FBQ1QsZ0JBQWdCLEVBQUUsa0JBQWtCO1FBQ3BDLGFBQWEsRUFBRSxlQUFlO1FBQzlCLG1CQUFtQixFQUFFLHFCQUFxQjtRQUMxQyxjQUFjLEVBQUUsZ0JBQWdCO0tBQ2pDO0NBQ0YsQ0FB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YUFBYSxFQUFFLENBQUM7UUFDbkMsTUFBTSxZQUFZLEdBQUcsa0JBQWtCLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFdEQsUUFBUTtRQUNSLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUMzQixZQUFZLENBQUMsV0FBVyxDQUFDLElBQUksS0FBSyxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3BELENBQUM7UUFFRCxJQUFBLGVBQU0sRUFBQyxZQUFZLENBQUMsb0JBQW9CLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUV2RCxNQUFNLEtBQUssR0FBRyxZQUFZLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDM0MsSUFBQSxlQUFNLEVBQUMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzVDLElBQUEsZUFBTSxFQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNyRCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkU6XFx6ay1hZ2VudFxcdGVzdHNcXG1pZGRsZXdhcmVcXGdsb2JhbC1lcnJvci1oYW5kbGVyLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8g566A5YyW55qE5YWo5bGA6ZSZ6K+v5aSE55CG5Zmo5rWL6K+VXG4vLyDpgb/lhY1OZXh0Lmpz5L6d6LWW6Zeu6aKY77yM5LiT5rOo5LqO5qC45b+D6YC76L6R5rWL6K+VXG5cbmltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBiZWZvcmVFYWNoLCBhZnRlckVhY2gsIHZpIH0gZnJvbSAndml0ZXN0JztcblxuLy8gTW9jayBOZXh0LmpzIGRlcGVuZGVuY2llc1xuY29uc3QgbW9ja05leHRSZXNwb25zZSA9IHtcbiAganNvbjogdmkuZm4oKGRhdGE6IGFueSwgb3B0aW9ucz86IGFueSkgPT4gKHtcbiAgICBqc29uOiBhc3luYyAoKSA9PiBkYXRhLFxuICAgIHN0YXR1czogb3B0aW9ucz8uc3RhdHVzIHx8IDIwMCxcbiAgICBoZWFkZXJzOiBvcHRpb25zPy5oZWFkZXJzIHx8IHt9XG4gIH0pKVxufTtcblxudmkubW9jaygnbmV4dC9zZXJ2ZXInLCAoKSA9PiAoe1xuICBOZXh0UmVzcG9uc2U6IG1vY2tOZXh0UmVzcG9uc2UsXG4gIE5leHRSZXF1ZXN0OiB2aS5mbigpXG59KSk7XG5cbnZpLm1vY2soJy4uLy4uL2xpYi91dGlscy9hcGktbG9nZ2VyJywgKCkgPT4gKHtcbiAgQXBpTG9nZ2VyOiB7XG4gICAgZXJyb3I6IHZpLmZuKCksXG4gICAgaW5mbzogdmkuZm4oKSxcbiAgICB3YXJuOiB2aS5mbigpXG4gIH1cbn0pKTtcblxudmkubW9jaygnLi4vLi4vbGliL3R5cGVzL2FwaS1yZXNwb25zZScsICgpID0+ICh7XG4gIEVycm9yQ29kZToge1xuICAgIFZBTElEQVRJT05fRVJST1I6ICdWQUxJREFUSU9OX0VSUk9SJyxcbiAgICBORVRXT1JLX0VSUk9SOiAnTkVUV09SS19FUlJPUicsXG4gICAgU0VSVklDRV9VTkFWQUlMQUJMRTogJ1NFUlZJQ0VfVU5BVkFJTEFCTEUnLFxuICAgIElOVEVSTkFMX0VSUk9SOiAnSU5URVJOQUxfRVJST1InXG4gIH1cbn0pKTtcblxuLy8g566A5YyW55qE6ZSZ6K+v57G75Z6L5a6a5LmJXG5lbnVtIEFnZW50RXJyb3JUeXBlIHtcbiAgVkFMSURBVElPTl9FUlJPUiA9ICdWQUxJREFUSU9OX0VSUk9SJyxcbiAgTkVUV09SS19FUlJPUiA9ICdORVRXT1JLX0VSUk9SJyxcbiAgU1lTVEVNX0VSUk9SID0gJ1NZU1RFTV9FUlJPUicsXG4gIFNFUlZJQ0VfVU5BVkFJTEFCTEUgPSAnU0VSVklDRV9VTkFWQUlMQUJMRSdcbn1cblxuLy8g566A5YyW55qEQWdlbnRFcnJvcuexu1xuY2xhc3MgQWdlbnRFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgcHVibGljIHJlYWRvbmx5IGlkOiBzdHJpbmc7XG4gIHB1YmxpYyByZWFkb25seSB0eXBlOiBBZ2VudEVycm9yVHlwZTtcbiAgcHVibGljIHJlYWRvbmx5IHN0YXR1c0NvZGU6IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IHVzZXJNZXNzYWdlOiBzdHJpbmc7XG4gIHB1YmxpYyByZWFkb25seSByZXRyeWFibGU6IGJvb2xlYW47XG4gIHB1YmxpYyByZWFkb25seSBjb250ZXh0PzogYW55O1xuICBwdWJsaWMgcmVhZG9ubHkgdGltZXN0YW1wOiBzdHJpbmc7XG4gIHB1YmxpYyByZWFkb25seSBzdGFjaz86IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihcbiAgICB0eXBlOiBBZ2VudEVycm9yVHlwZSxcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgY29udGV4dD86IGFueSxcbiAgICBzdGF0dXNDb2RlPzogbnVtYmVyXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMubmFtZSA9ICdBZ2VudEVycm9yJztcbiAgICB0aGlzLmlkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpO1xuICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICB0aGlzLnRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICB0aGlzLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlIHx8IHRoaXMuZ2V0RGVmYXVsdFN0YXR1c0NvZGUodHlwZSk7XG4gICAgdGhpcy51c2VyTWVzc2FnZSA9IHRoaXMuZ2V0VXNlck1lc3NhZ2UodHlwZSk7XG4gICAgdGhpcy5yZXRyeWFibGUgPSB0aGlzLmlzUmV0cnlhYmxlRXJyb3IodHlwZSk7XG4gIH1cblxuICBwcml2YXRlIGdldERlZmF1bHRTdGF0dXNDb2RlKHR5cGU6IEFnZW50RXJyb3JUeXBlKTogbnVtYmVyIHtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgQWdlbnRFcnJvclR5cGUuVkFMSURBVElPTl9FUlJPUjpcbiAgICAgICAgcmV0dXJuIDQwMDtcbiAgICAgIGNhc2UgQWdlbnRFcnJvclR5cGUuTkVUV09SS19FUlJPUjpcbiAgICAgICAgcmV0dXJuIDUwMjtcbiAgICAgIGNhc2UgQWdlbnRFcnJvclR5cGUuU0VSVklDRV9VTkFWQUlMQUJMRTpcbiAgICAgICAgcmV0dXJuIDUwMztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiA1MDA7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRVc2VyTWVzc2FnZSh0eXBlOiBBZ2VudEVycm9yVHlwZSk6IHN0cmluZyB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlIEFnZW50RXJyb3JUeXBlLlZBTElEQVRJT05fRVJST1I6XG4gICAgICAgIHJldHVybiAn6K+35rGC5Y+C5pWw5pyJ6K+v77yM6K+35qOA5p+l5ZCO6YeN6K+VJztcbiAgICAgIGNhc2UgQWdlbnRFcnJvclR5cGUuTkVUV09SS19FUlJPUjpcbiAgICAgICAgcmV0dXJuICfnvZHnu5zov57mjqXlvILluLjvvIzor7fnqI3lkI7ph43or5UnO1xuICAgICAgY2FzZSBBZ2VudEVycm9yVHlwZS5TRVJWSUNFX1VOQVZBSUxBQkxFOlxuICAgICAgICByZXR1cm4gJ+acjeWKoeaaguaXtuS4jeWPr+eUqO+8jOivt+eojeWQjumHjeivlSc7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gJ+ezu+e7n+WGhemDqOmUmeivr++8jOivt+iBlOezu+euoeeQhuWRmCc7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBpc1JldHJ5YWJsZUVycm9yKHR5cGU6IEFnZW50RXJyb3JUeXBlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIFtBZ2VudEVycm9yVHlwZS5ORVRXT1JLX0VSUk9SLCBBZ2VudEVycm9yVHlwZS5TRVJWSUNFX1VOQVZBSUxBQkxFXS5pbmNsdWRlcyh0eXBlKTtcbiAgfVxufVxuXG4vLyDnroDljJbnmoTlhajlsYDplJnor6/lpITnkIblmahcbmNsYXNzIEdsb2JhbEVycm9ySGFuZGxlciB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBHbG9iYWxFcnJvckhhbmRsZXI7XG4gIHByaXZhdGUgZXJyb3JDb3VudCA9IDA7XG4gIHByaXZhdGUgbGFzdEVycm9yVGltZSA9IDA7XG4gIHByaXZhdGUgY2lyY3VpdEJyZWFrZXJPcGVuID0gZmFsc2U7XG4gIHByaXZhdGUgcmVhZG9ubHkgY2lyY3VpdEJyZWFrZXJUaW1lb3V0ID0gNjAwMDA7XG4gIHByaXZhdGUgcmVhZG9ubHkgdGltZVdpbmRvd01zID0gNjAwMDA7XG4gIHByaXZhdGUgcmVhZG9ubHkgZXJyb3JUaHJlc2hvbGQgPSBwYXJzZUludChwcm9jZXNzLmVudi5FUlJPUl9USFJFU0hPTEQgfHwgJzUwJyk7XG4gIHByaXZhdGUgY2lyY3VpdEJyZWFrZXJSZXNldFRpbWVyPzogTm9kZUpTLlRpbWVvdXQ7XG5cbiAgc3RhdGljIGdldEluc3RhbmNlKCk6IEdsb2JhbEVycm9ySGFuZGxlciB7XG4gICAgaWYgKCFHbG9iYWxFcnJvckhhbmRsZXIuaW5zdGFuY2UpIHtcbiAgICAgIEdsb2JhbEVycm9ySGFuZGxlci5pbnN0YW5jZSA9IG5ldyBHbG9iYWxFcnJvckhhbmRsZXIoKTtcbiAgICB9XG4gICAgcmV0dXJuIEdsb2JhbEVycm9ySGFuZGxlci5pbnN0YW5jZTtcbiAgfVxuXG4gIGhhbmRsZUVycm9yKGVycm9yOiBFcnJvciB8IEFnZW50RXJyb3IsIGNvbnRleHQ/OiBhbnkpOiBhbnkge1xuICAgIHRyeSB7XG4gICAgICBsZXQgYWdlbnRFcnJvcjogQWdlbnRFcnJvcjtcbiAgICAgIFxuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgQWdlbnRFcnJvcikge1xuICAgICAgICBhZ2VudEVycm9yID0gZXJyb3I7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyDliIbnsbvmma7pgJrplJnor69cbiAgICAgICAgY29uc3QgZXJyb3JUeXBlID0gdGhpcy5jbGFzc2lmeUVycm9yKGVycm9yKTtcbiAgICAgICAgYWdlbnRFcnJvciA9IG5ldyBBZ2VudEVycm9yKGVycm9yVHlwZSwgZXJyb3IubWVzc2FnZSwgY29udGV4dCk7XG4gICAgICB9XG5cbiAgICAgIC8vIOiusOW9lemUmeivr1xuICAgICAgdGhpcy5yZWNvcmRFcnJvcihhZ2VudEVycm9yKTtcbiAgICAgIFxuICAgICAgLy8g5qOA5p+l5pe26Ze056qX5Y+j5bm25pu05paw57uf6K6hXG4gICAgICB0aGlzLmNoZWNrVGltZVdpbmRvd0FuZFVwZGF0ZVN0YXRzKCk7XG4gICAgICBcbiAgICAgIC8vIOajgOafpeaWrei3r+WZqFxuICAgICAgaWYgKHRoaXMuZXJyb3JDb3VudCA+PSB0aGlzLmVycm9yVGhyZXNob2xkKSB7XG4gICAgICAgIHRoaXMub3BlbkNpcmN1aXRCcmVha2VyKCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUVycm9yUmVzcG9uc2UoYWdlbnRFcnJvcik7XG4gICAgfSBjYXRjaCAoaGFuZGxlckVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBlcnJvciBoYW5kbGVyOicsIGhhbmRsZXJFcnJvcik7XG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVGYWxsYmFja1Jlc3BvbnNlKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjbGFzc2lmeUVycm9yKGVycm9yOiBFcnJvcik6IEFnZW50RXJyb3JUeXBlIHtcbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ1ZhbGlkYXRpb25FcnJvcicgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygndmFsaWRhdGlvbicpKSB7XG4gICAgICByZXR1cm4gQWdlbnRFcnJvclR5cGUuVkFMSURBVElPTl9FUlJPUjtcbiAgICB9XG4gICAgaWYgKGVycm9yLm5hbWUgPT09ICdOZXR3b3JrRXJyb3InIHx8IGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ25ldHdvcmsnKSkge1xuICAgICAgcmV0dXJuIEFnZW50RXJyb3JUeXBlLk5FVFdPUktfRVJST1I7XG4gICAgfVxuICAgIHJldHVybiBBZ2VudEVycm9yVHlwZS5TWVNURU1fRVJST1I7XG4gIH1cblxuICBwcml2YXRlIHJlY29yZEVycm9yKGVycm9yOiBBZ2VudEVycm9yKTogdm9pZCB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVjb3JkZWQ6Jywge1xuICAgICAgaWQ6IGVycm9yLmlkLFxuICAgICAgdHlwZTogZXJyb3IudHlwZSxcbiAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICB0aW1lc3RhbXA6IGVycm9yLnRpbWVzdGFtcFxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVFcnJvclN0YXRzKCk6IHZvaWQge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgdGhpcy5lcnJvckNvdW50Kys7XG4gICAgdGhpcy5sYXN0RXJyb3JUaW1lID0gbm93O1xuICB9XG5cbiAgcHJpdmF0ZSBjaGVja1RpbWVXaW5kb3dBbmRVcGRhdGVTdGF0cygpOiB2b2lkIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIFxuICAgIC8vIOajgOafpeaXtumXtOeql+WPo+aYr+WQpui/h+acn1xuICAgIGlmICh0aGlzLmxhc3RFcnJvclRpbWUgPiAwICYmIG5vdyAtIHRoaXMubGFzdEVycm9yVGltZSA+IHRoaXMudGltZVdpbmRvd01zKSB7XG4gICAgICB0aGlzLmVycm9yQ291bnQgPSAwO1xuICAgIH1cbiAgICBcbiAgICAvLyDmm7TmlrDnu5/orqFcbiAgICB0aGlzLmVycm9yQ291bnQrKztcbiAgICB0aGlzLmxhc3RFcnJvclRpbWUgPSBub3c7XG4gIH1cblxuICBwcml2YXRlIHNob3VsZFRyaWdnZXJDaXJjdWl0QnJlYWtlcigpOiBib29sZWFuIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIFxuICAgIGlmIChub3cgLSB0aGlzLmxhc3RFcnJvclRpbWUgPiB0aGlzLnRpbWVXaW5kb3dNcykge1xuICAgICAgdGhpcy5lcnJvckNvdW50ID0gMDtcbiAgICAgIHRoaXMubGFzdEVycm9yVGltZSA9IG5vdztcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRoaXMuZXJyb3JDb3VudCA+PSB0aGlzLmVycm9yVGhyZXNob2xkO1xuICB9XG5cbiAgcHJpdmF0ZSBvcGVuQ2lyY3VpdEJyZWFrZXIoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY2lyY3VpdEJyZWFrZXJPcGVuKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIHRoaXMuY2lyY3VpdEJyZWFrZXJPcGVuID0gdHJ1ZTtcbiAgICBjb25zb2xlLndhcm4oJ/CfmqggQ2lyY3VpdCBicmVha2VyIG9wZW5lZCBkdWUgdG8gaGlnaCBlcnJvciByYXRlJyk7XG4gICAgXG4gICAgaWYgKHRoaXMuY2lyY3VpdEJyZWFrZXJSZXNldFRpbWVyKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5jaXJjdWl0QnJlYWtlclJlc2V0VGltZXIpO1xuICAgIH1cbiAgICBcbiAgICB0aGlzLmNpcmN1aXRCcmVha2VyUmVzZXRUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5jaXJjdWl0QnJlYWtlck9wZW4gPSBmYWxzZTtcbiAgICAgIHRoaXMuZXJyb3JDb3VudCA9IDA7XG4gICAgICB0aGlzLmxhc3RFcnJvclRpbWUgPSAwO1xuICAgICAgY29uc29sZS5pbmZvKCfinIUgQ2lyY3VpdCBicmVha2VyIGNsb3NlZCwgc2VydmljZSByZXN0b3JlZCcpO1xuICAgIH0sIHRoaXMuY2lyY3VpdEJyZWFrZXJUaW1lb3V0KTtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlRXJyb3JSZXNwb25zZShlcnJvcjogQWdlbnRFcnJvcik6IGFueSB7XG4gICAgcmV0dXJuIG1vY2tOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6IGVycm9yLnR5cGUsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yLnVzZXJNZXNzYWdlLFxuICAgICAgICB0eXBlOiBlcnJvci50eXBlXG4gICAgICB9LFxuICAgICAgcmVxdWVzdElkOiBlcnJvci5pZCxcbiAgICAgIHRpbWVzdGFtcDogZXJyb3IudGltZXN0YW1wXG4gICAgfSwgeyBzdGF0dXM6IGVycm9yLnN0YXR1c0NvZGUgfSk7XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZUZhbGxiYWNrUmVzcG9uc2UoKTogYW55IHtcbiAgICByZXR1cm4gbW9ja05leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ0lOVEVSTkFMX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogJ+ezu+e7n+WGhemDqOmUmeivrycsXG4gICAgICAgIHR5cGU6ICdTWVNURU1fRVJST1InXG4gICAgICB9LFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG5cbiAgaXNDaXJjdWl0QnJlYWtlck9wZW4oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuY2lyY3VpdEJyZWFrZXJPcGVuO1xuICB9XG5cbiAgZ2V0RXJyb3JTdGF0cygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZXJyb3JDb3VudDogdGhpcy5lcnJvckNvdW50LFxuICAgICAgbGFzdEVycm9yVGltZTogdGhpcy5sYXN0RXJyb3JUaW1lLFxuICAgICAgY2lyY3VpdEJyZWFrZXJPcGVuOiB0aGlzLmNpcmN1aXRCcmVha2VyT3BlbixcbiAgICAgIGVycm9yVGhyZXNob2xkOiB0aGlzLmVycm9yVGhyZXNob2xkLFxuICAgICAgdGltZVdpbmRvd01zOiB0aGlzLnRpbWVXaW5kb3dNc1xuICAgIH07XG4gIH1cblxuICAvLyDph43nva7lrp7kvovvvIjnlKjkuo7mtYvor5XvvIlcbiAgc3RhdGljIHJlc2V0SW5zdGFuY2UoKTogdm9pZCB7XG4gICAgR2xvYmFsRXJyb3JIYW5kbGVyLmluc3RhbmNlID0gdW5kZWZpbmVkIGFzIGFueTtcbiAgfVxufVxuXG5kZXNjcmliZSgnR2xvYmFsRXJyb3JIYW5kbGVyJywgKCkgPT4ge1xuICBsZXQgZXJyb3JIYW5kbGVyOiBHbG9iYWxFcnJvckhhbmRsZXI7XG4gIFxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBHbG9iYWxFcnJvckhhbmRsZXIucmVzZXRJbnN0YW5jZSgpO1xuICAgIGVycm9ySGFuZGxlciA9IEdsb2JhbEVycm9ySGFuZGxlci5nZXRJbnN0YW5jZSgpO1xuICAgIGRlbGV0ZSBwcm9jZXNzLmVudi5FUlJPUl9USFJFU0hPTEQ7XG4gICAgdmkuY2xlYXJBbGxNb2NrcygpO1xuICAgIHZpLnNweU9uKGNvbnNvbGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XG4gICAgdmkuc3B5T24oY29uc29sZSwgJ3dhcm4nKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pO1xuICAgIHZpLnNweU9uKGNvbnNvbGUsICdpbmZvJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KTtcbiAgfSk7XG4gIFxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIHZpLnJlc3RvcmVBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2luZ2xldG9uIFBhdHRlcm4nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdGhlIHNhbWUgaW5zdGFuY2UnLCAoKSA9PiB7XG4gICAgICBjb25zdCBpbnN0YW5jZTEgPSBHbG9iYWxFcnJvckhhbmRsZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICAgIGNvbnN0IGluc3RhbmNlMiA9IEdsb2JhbEVycm9ySGFuZGxlci5nZXRJbnN0YW5jZSgpO1xuICAgICAgZXhwZWN0KGluc3RhbmNlMSkudG9CZShpbnN0YW5jZTIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgQ2xhc3NpZmljYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjbGFzc2lmeSB2YWxpZGF0aW9uIGVycm9ycyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCB2YWxpZGF0aW9uRXJyb3IgPSBuZXcgRXJyb3IoJ1ZhbGlkYXRpb24gZmFpbGVkJyk7XG4gICAgICB2YWxpZGF0aW9uRXJyb3IubmFtZSA9ICdWYWxpZGF0aW9uRXJyb3InO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBlcnJvckhhbmRsZXIuaGFuZGxlRXJyb3IodmFsaWRhdGlvbkVycm9yKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QobW9ja05leHRSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNsYXNzaWZ5IG5ldHdvcmsgZXJyb3JzIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IG5ldHdvcmtFcnJvciA9IG5ldyBFcnJvcignTmV0d29yayB0aW1lb3V0Jyk7XG4gICAgICBuZXR3b3JrRXJyb3IubmFtZSA9ICdOZXR3b3JrRXJyb3InO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBlcnJvckhhbmRsZXIuaGFuZGxlRXJyb3IobmV0d29ya0Vycm9yKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBBZ2VudEVycm9yIGluc3RhbmNlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGFnZW50RXJyb3IgPSBuZXcgQWdlbnRFcnJvcihcbiAgICAgICAgQWdlbnRFcnJvclR5cGUuVkFMSURBVElPTl9FUlJPUixcbiAgICAgICAgJ1Rlc3QgdmFsaWRhdGlvbiBlcnJvcicsXG4gICAgICAgIHsgZmllbGQ6ICdlbWFpbCcgfVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKGFnZW50RXJyb3IpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NpcmN1aXQgQnJlYWtlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG5vdCB0cmlnZ2VyIGNpcmN1aXQgYnJlYWtlciB3aXRoIGZldyBlcnJvcnMnLCAoKSA9PiB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKG5ldyBFcnJvcihgRXJyb3IgJHtpfWApKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgZXhwZWN0KGVycm9ySGFuZGxlci5pc0NpcmN1aXRCcmVha2VyT3BlbigpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdHJpZ2dlciBjaXJjdWl0IGJyZWFrZXIgd2l0aCBtYW55IGVycm9ycycsICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52LkVSUk9SX1RIUkVTSE9MRCA9ICc1JztcbiAgICAgIEdsb2JhbEVycm9ySGFuZGxlci5yZXNldEluc3RhbmNlKCk7XG4gICAgICBlcnJvckhhbmRsZXIgPSBHbG9iYWxFcnJvckhhbmRsZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICAgIFxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA2OyBpKyspIHtcbiAgICAgICAgZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKG5ldyBFcnJvcihgRXJyb3IgJHtpfWApKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgZXhwZWN0KGVycm9ySGFuZGxlci5pc0NpcmN1aXRCcmVha2VyT3BlbigpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXNldCBlcnJvciBjb3VudCBhZnRlciB0aW1lIHdpbmRvdycsICgpID0+IHtcbiAgICAgIGVycm9ySGFuZGxlci5oYW5kbGVFcnJvcihuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHN0YXRzID0gZXJyb3JIYW5kbGVyLmdldEVycm9yU3RhdHMoKTtcbiAgICAgIGV4cGVjdChzdGF0cy5lcnJvckNvdW50KS50b0JlKDEpO1xuICAgICAgXG4gICAgICB2aS51c2VGYWtlVGltZXJzKCk7XG4gICAgICB2aS5hZHZhbmNlVGltZXJzQnlUaW1lKDYxMDAwKTtcbiAgICAgIFxuICAgICAgZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKG5ldyBFcnJvcignQW5vdGhlciBlcnJvcicpKTtcbiAgICAgIFxuICAgICAgY29uc3QgbmV3U3RhdHMgPSBlcnJvckhhbmRsZXIuZ2V0RXJyb3JTdGF0cygpO1xuICAgICAgZXhwZWN0KG5ld1N0YXRzLmVycm9yQ291bnQpLnRvQmUoMSk7XG4gICAgICBcbiAgICAgIHZpLnVzZVJlYWxUaW1lcnMoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIFN0YXRpc3RpY3MnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB0cmFjayBlcnJvciBzdGF0aXN0aWNzIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IGluaXRpYWxTdGF0cyA9IGVycm9ySGFuZGxlci5nZXRFcnJvclN0YXRzKCk7XG4gICAgICBleHBlY3QoaW5pdGlhbFN0YXRzLmVycm9yQ291bnQpLnRvQmUoMCk7XG4gICAgICBcbiAgICAgIGVycm9ySGFuZGxlci5oYW5kbGVFcnJvcihuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHVwZGF0ZWRTdGF0cyA9IGVycm9ySGFuZGxlci5nZXRFcnJvclN0YXRzKCk7XG4gICAgICBleHBlY3QodXBkYXRlZFN0YXRzLmVycm9yQ291bnQpLnRvQmUoMSk7XG4gICAgICBleHBlY3QodXBkYXRlZFN0YXRzLmxhc3RFcnJvclRpbWUpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBjb25maWd1cmF0aW9uIGluIHN0YXRzJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhdHMgPSBlcnJvckhhbmRsZXIuZ2V0RXJyb3JTdGF0cygpO1xuICAgICAgZXhwZWN0KHN0YXRzKS50b0hhdmVQcm9wZXJ0eSgnZXJyb3JUaHJlc2hvbGQnKTtcbiAgICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ3RpbWVXaW5kb3dNcycpO1xuICAgICAgZXhwZWN0KHN0YXRzLnRpbWVXaW5kb3dNcykudG9CZSg2MDAwMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFcnJvciBSZXNwb25zZSBGb3JtYXQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgcHJvcGVybHkgZm9ybWF0dGVkIGVycm9yIHJlc3BvbnNlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEFnZW50RXJyb3IoXG4gICAgICAgIEFnZW50RXJyb3JUeXBlLlZBTElEQVRJT05fRVJST1IsXG4gICAgICAgICdUZXN0IHZhbGlkYXRpb24gZXJyb3InLFxuICAgICAgICB7IGZpZWxkOiAnZW1haWwnIH1cbiAgICAgICk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKGVycm9yKTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlQm9keSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3BvbnNlQm9keSkudG9IYXZlUHJvcGVydHkoJ3N1Y2Nlc3MnLCBmYWxzZSk7XG4gICAgICBleHBlY3QocmVzcG9uc2VCb2R5KS50b0hhdmVQcm9wZXJ0eSgnZXJyb3InKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZUJvZHkpLnRvSGF2ZVByb3BlcnR5KCdyZXF1ZXN0SWQnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZUJvZHkpLnRvSGF2ZVByb3BlcnR5KCd0aW1lc3RhbXAnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZUJvZHkuZXJyb3IpLnRvSGF2ZVByb3BlcnR5KCdjb2RlJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2VCb2R5LmVycm9yKS50b0hhdmVQcm9wZXJ0eSgnbWVzc2FnZScpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlQm9keS5lcnJvcikudG9IYXZlUHJvcGVydHkoJ3R5cGUnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIFJlY29yZGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlY29yZCBlcnJvcnMgdG8gbW9uaXRvcmluZyBzeXN0ZW0nLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb25zb2xlU3B5ID0gdmkuc3B5T24oY29uc29sZSwgJ2Vycm9yJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEFnZW50RXJyb3IoXG4gICAgICAgIEFnZW50RXJyb3JUeXBlLlNZU1RFTV9FUlJPUixcbiAgICAgICAgJ1Rlc3Qgc3lzdGVtIGVycm9yJ1xuICAgICAgKTtcbiAgICAgIFxuICAgICAgZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKGVycm9yKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNvbnNvbGVTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnRXJyb3IgcmVjb3JkZWQ6JyxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIGlkOiBleHBlY3QuYW55KFN0cmluZyksXG4gICAgICAgICAgdHlwZTogQWdlbnRFcnJvclR5cGUuU1lTVEVNX0VSUk9SLFxuICAgICAgICAgIG1lc3NhZ2U6ICdUZXN0IHN5c3RlbSBlcnJvcicsXG4gICAgICAgICAgdGltZXN0YW1wOiBleHBlY3QuYW55KFN0cmluZylcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGYWxsYmFjayBFcnJvciBIYW5kbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlcnJvcnMgd2l0aGluIHRoZSBlcnJvciBoYW5kbGVyJywgKCkgPT4ge1xuICAgICAgLy8g5qih5ouf6ZSZ6K+v5aSE55CG5Zmo5YaF6YOo6ZSZ6K+vXG4gICAgICBjb25zdCBvcmlnaW5hbFJlY29yZEVycm9yID0gKGVycm9ySGFuZGxlciBhcyBhbnkpLnJlY29yZEVycm9yO1xuICAgICAgKGVycm9ySGFuZGxlciBhcyBhbnkpLnJlY29yZEVycm9yID0gKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlY29yZGluZyBmYWlsZWQnKTtcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGVycm9ySGFuZGxlci5oYW5kbGVFcnJvcihuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKSk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgXG4gICAgICAvLyDmgaLlpI3ljp/mlrnms5VcbiAgICAgIChlcnJvckhhbmRsZXIgYXMgYW55KS5yZWNvcmRFcnJvciA9IG9yaWdpbmFsUmVjb3JkRXJyb3I7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbi8vIOmbhuaIkOa1i+ivlVxuZGVzY3JpYmUoJ0dsb2JhbEVycm9ySGFuZGxlciBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxldGUgZXJyb3IgZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBlcnJvckhhbmRsZXIgPSBHbG9iYWxFcnJvckhhbmRsZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICBcbiAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnKTtcbiAgICBjb25zdCByZXN1bHQgPSBlcnJvckhhbmRsZXIuaGFuZGxlRXJyb3IoZXJyb3IpO1xuICAgIFxuICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgZXhwZWN0KHJlc3VsdC5zdGF0dXMpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoNDAwKTtcbiAgICBcbiAgICBjb25zdCByZXNwb25zZUJvZHkgPSBhd2FpdCByZXN1bHQuanNvbigpO1xuICAgIGV4cGVjdChyZXNwb25zZUJvZHkuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KHJlc3BvbnNlQm9keS5lcnJvcikudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3QocmVzcG9uc2VCb2R5LnJlcXVlc3RJZCkudG9CZURlZmluZWQoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBtYWludGFpbiBjaXJjdWl0IGJyZWFrZXIgc3RhdGUgYWNyb3NzIG11bHRpcGxlIGVycm9ycycsICgpID0+IHtcbiAgICBwcm9jZXNzLmVudi5FUlJPUl9USFJFU0hPTEQgPSAnMyc7XG4gICAgR2xvYmFsRXJyb3JIYW5kbGVyLnJlc2V0SW5zdGFuY2UoKTtcbiAgICBjb25zdCBlcnJvckhhbmRsZXIgPSBHbG9iYWxFcnJvckhhbmRsZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICBcbiAgICAvLyDop6blj5Hmlq3ot6/lmahcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKG5ldyBFcnJvcihgRXJyb3IgJHtpfWApKTtcbiAgICB9XG4gICAgXG4gICAgZXhwZWN0KGVycm9ySGFuZGxlci5pc0NpcmN1aXRCcmVha2VyT3BlbigpKS50b0JlKHRydWUpO1xuICAgIFxuICAgIGNvbnN0IHN0YXRzID0gZXJyb3JIYW5kbGVyLmdldEVycm9yU3RhdHMoKTtcbiAgICBleHBlY3Qoc3RhdHMuY2lyY3VpdEJyZWFrZXJPcGVuKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChzdGF0cy5lcnJvckNvdW50KS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDMpO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==