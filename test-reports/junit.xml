<?xml version="1.0" encoding="UTF-8"?>
<testsuites name="jest tests" tests="285" failures="81" errors="0" time="54.961">
  <testsuite name="简单测试套件" errors="0" failures="0" skipped="0" timestamp="2025-06-26T09:32:15" time="3.238" tests="10">
    <testcase classname="简单测试套件" name="基础数学运算" time="0.016">
    </testcase>
    <testcase classname="简单测试套件" name="字符串操作" time="0.022">
    </testcase>
    <testcase classname="简单测试套件" name="数组操作" time="0.009">
    </testcase>
    <testcase classname="简单测试套件" name="对象操作" time="0.017">
    </testcase>
    <testcase classname="简单测试套件" name="异步操作" time="0.003">
    </testcase>
    <testcase classname="简单测试套件" name="Mock函数" time="0.003">
    </testcase>
    <testcase classname="简单测试套件" name="环境变量" time="0.003">
    </testcase>
    <testcase classname="简单测试套件" name="全局工具函数" time="0.009">
    </testcase>
    <testcase classname="简单测试套件" name="性能工具函数" time="0.004">
    </testcase>
    <testcase classname="简单测试套件" name="TextEncoder/TextDecoder" time="0.003">
    </testcase>
  </testsuite>
  <testsuite name="Jest 配置验证器" errors="0" failures="0" skipped="0" timestamp="2025-06-26T09:32:19" time="0.882" tests="14">
    <testcase classname="Jest 配置验证器 › validateJestConfig" name="应该成功验证有效的 Jest 配置" time="0.017">
    </testcase>
    <testcase classname="Jest 配置验证器 › validateJestConfig" name="应该检测到缺失的 Jest 配置" time="0.013">
    </testcase>
    <testcase classname="Jest 配置验证器 › validateTestEnvironment" name="应该验证测试环境配置" time="0.005">
    </testcase>
    <testcase classname="Jest 配置验证器 › validateTestEnvironment" name="应该警告非测试环境" time="0.019">
    </testcase>
    <testcase classname="Jest 配置验证器 › safeRequire" name="应该成功加载存在的模块" time="0.003">
    </testcase>
    <testcase classname="Jest 配置验证器 › safeRequire" name="应该处理不存在的模块" time="0.086">
    </testcase>
    <testcase classname="Jest 配置验证器 › safeRequire" name="应该使用自定义回退值" time="0.005">
    </testcase>
    <testcase classname="Jest 配置验证器 › createSafePolyfills" name="should create necessary polyfills" time="0.007">
    </testcase>
    <testcase classname="Jest 配置验证器 › createSafePolyfills" name="should create working TextEncoder polyfill" time="0.008">
    </testcase>
    <testcase classname="Jest 配置验证器 › createSafePolyfills" name="should create working TextDecoder polyfill" time="0.004">
    </testcase>
    <testcase classname="Jest 配置验证器 › applySafePolyfills" name="should apply polyfills safely" time="0.013">
    </testcase>
    <testcase classname="Jest 配置验证器 › applySafePolyfills" name="should not override existing polyfills" time="0.01">
    </testcase>
    <testcase classname="Jest 配置验证器 › applySafePolyfills" name="应该处理应用 polyfills 时的错误" time="0.004">
    </testcase>
    <testcase classname="Jest 配置验证器 › 集成测试" name="应该完整地验证和设置测试环境" time="0.014">
    </testcase>
  </testsuite>
  <testsuite name="RealCloudStorageAdapter" errors="0" failures="3" skipped="0" timestamp="2025-06-26T09:32:20" time="1.34" tests="24">
    <testcase classname="RealCloudStorageAdapter › 单例模式" name="应该返回同一个实例" time="0.01">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 单例模式" name="应该与导出的单例实例相同" time="0.008">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 本地存储功能" name="应该成功上传文件到本地存储" time="0.041">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 本地存储功能" name="应该成功下载已上传的文件" time="0.029">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 本地存储功能" name="应该正确检查文件是否存在" time="0.013">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 本地存储功能" name="应该成功删除文件" time="0.017">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 本地存储功能" name="应该获取正确的文件信息" time="0.019">
      <failure>Error: expect(received).toBe(expected) // Object.is equality

Expected: true
Received: false
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\real-cloud-storage-adapter.test.ts:172:59)</failure>
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 本地存储功能" name="应该列出文件" time="0.07">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 本地存储功能" name="应该生成签名URL" time="0.005">
      <failure>Error: expect(received).toContain(expected) // indexOf

Expected substring: &quot;test-files/sample.txt&quot;
Received string:    &quot;file://uploads\\test-files\\sample.txt&quot;
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\real-cloud-storage-adapter.test.ts:212:31)</failure>
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 本地存储功能" name="应该获取存储统计信息" time="0.022">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 错误处理" name="应该处理下载不存在文件的情况" time="0.009">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 错误处理" name="应该处理获取不存在文件信息的情况" time="0.006">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 错误处理" name="应该安全处理删除不存在文件的情况" time="0.006">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 便捷方法" name="uploadFile 方法应该正常工作" time="0.008">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 便捷方法" name="downloadFile 方法应该正常工作" time="0.013">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 便捷方法" name="fileExists 方法应该正常工作" time="0.007">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 便捷方法" name="deleteFile 方法应该正常工作" time="0.011">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 便捷方法" name="getFileInfo 方法应该正常工作" time="0.008">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 便捷方法" name="listFiles 方法应该正常工作" time="0.015">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 便捷方法" name="getSignedUrl 方法应该正常工作" time="0.003">
      <failure>Error: expect(received).toContain(expected) // indexOf

Expected substring: &quot;test-files/sample.txt&quot;
Received string:    &quot;file://uploads\\test-files\\sample.txt&quot;
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\real-cloud-storage-adapter.test.ts:332:25)</failure>
    </testcase>
    <testcase classname="RealCloudStorageAdapter › AWS S3 集成检查" name="应该在没有AWS凭证时使用本地存储" time="0.005">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › AWS S3 集成检查" name="应该在有AWS凭证时尝试初始化AWS S3" time="0.025">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 性能测试" name="应该在合理时间内完成文件操作" time="0.013">
    </testcase>
    <testcase classname="RealCloudStorageAdapter › 性能测试" name="应该高效处理多个小文件" time="0.043">
    </testcase>
  </testsuite>
  <testsuite name="CloudStorageAdapter" errors="0" failures="14" skipped="0" timestamp="2025-06-26T09:32:22" time="9.136" tests="37">
    <testcase classname="CloudStorageAdapter › 单例模式" name="应该返回同一个实例" time="0.004">
    </testcase>
    <testcase classname="CloudStorageAdapter › 配置管理" name="应该正确配置AWS S3" time="0.002">
    </testcase>
    <testcase classname="CloudStorageAdapter › 配置管理" name="应该正确配置阿里云OSS" time="0.002">
    </testcase>
    <testcase classname="CloudStorageAdapter › 配置管理" name="应该拒绝不支持的提供商" time="0.002">
    </testcase>
    <testcase classname="CloudStorageAdapter › 配置管理" name="应该设置主要和备用提供商" time="0.006">
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件上传" name="应该成功上传文件" time="0.371">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;set&apos;)
    at CloudStorageAdapter.upload (E:\zk-agent\lib\storage\cloud-storage-adapter.ts:544:66)
    at async Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:215:28)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件上传" name="应该处理上传选项" time="0.377">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;set&apos;)
    at CloudStorageAdapter.upload (E:\zk-agent\lib\storage\cloud-storage-adapter.ts:544:66)
    at async Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:234:28)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件上传" name="应该在主提供商失败时使用备用提供商" time="0.29">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;set&apos;)
    at CloudStorageAdapter.upload (E:\zk-agent\lib\storage\cloud-storage-adapter.ts:544:66)
    at async Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:267:28)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件上传" name="应该缓存上传结果" time="0.498">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;set&apos;)
    at CloudStorageAdapter.upload (E:\zk-agent\lib\storage\cloud-storage-adapter.ts:544:66)
    at async Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:275:13)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件下载" name="应该成功下载文件" time="0.005">
      <failure>TypeError: adapter.getClient is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:305:40)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件下载" name="应该支持下载选项" time="0.005">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;get&apos;)
    at CloudStorageAdapter.download (E:\zk-agent\lib\storage\cloud-storage-adapter.ts:579:73)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:319:72)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件下载" name="应该从缓存返回文件" time="0.004">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;get&apos;)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:325:34)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件下载" name="应该缓存小文件下载结果" time="0.006">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;get&apos;)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:335:34)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件删除" name="应该成功删除文件" time="1.61">
      <failure>Error: expect(received).resolves.not.toThrow()

Received promise rejected instead of resolved
Rejected to value: [Error: Delete failed on all providers: Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;)]
    at expect (E:\zk-agent\node_modules\expect\build\index.js:113:15)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:367:19)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件删除" name="应该清除相关缓存" time="1.798">
      <failure>Error: Delete failed on all providers: Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;)
    at CloudStorageAdapter.delete (E:\zk-agent\lib\storage\cloud-storage-adapter.ts:665:19)
    at async Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:378:13)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件删除" name="应该在所有提供商上删除文件" time="1.648">
      <failure>Error: expect(received).resolves.not.toThrow()

Received promise rejected instead of resolved
Rejected to value: [Error: Delete failed on all providers: Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;), Cannot read properties of undefined (reading &apos;delete&apos;)]
    at expect (E:\zk-agent\node_modules\expect\build\index.js:113:15)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:407:19)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件存在检查" name="应该检查文件是否存在" time="0.107">
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件存在检查" name="应该处理检查错误" time="0.092">
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件信息获取" name="应该获取文件信息" time="0.11">
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件信息获取" name="应该包含CDN URL（如果启用）" time="0.123">
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件列表" name="应该列出文件" time="0.18">
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件列表" name="应该支持前缀过滤" time="0.117">
    </testcase>
    <testcase classname="CloudStorageAdapter › 文件列表" name="应该支持最大数量限制" time="0.133">
    </testcase>
    <testcase classname="CloudStorageAdapter › 签名URL生成" name="应该生成GET签名URL" time="0.063">
    </testcase>
    <testcase classname="CloudStorageAdapter › 签名URL生成" name="应该生成PUT签名URL" time="0.034">
    </testcase>
    <testcase classname="CloudStorageAdapter › 签名URL生成" name="应该支持自定义过期时间" time="0.046">
    </testcase>
    <testcase classname="CloudStorageAdapter › 存储统计" name="应该获取存储统计" time="0.083">
    </testcase>
    <testcase classname="CloudStorageAdapter › 健康状态检查" name="应该检查所有提供商的健康状态" time="0.158">
    </testcase>
    <testcase classname="CloudStorageAdapter › 熔断器机制" name="应该在多次失败后触发熔断器" time="0.003">
    </testcase>
    <testcase classname="CloudStorageAdapter › 错误处理" name="应该处理没有配置客户端的情况" time="0.002">
    </testcase>
    <testcase classname="CloudStorageAdapter › 错误处理" name="应该处理网络错误" time="0.001">
    </testcase>
    <testcase classname="CloudStorageAdapter › 环境变量配置" name="应该从环境变量读取AWS配置" time="0.003">
    </testcase>
    <testcase classname="CloudStorageAdapter › 环境变量配置" name="应该从环境变量读取阿里云配置" time="0.004">
    </testcase>
    <testcase classname="CloudStorageAdapter › 性能测试" name="应该在合理时间内完成文件操作" time="0.351">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;set&apos;)
    at CloudStorageAdapter.upload (E:\zk-agent\lib\storage\cloud-storage-adapter.ts:544:66)
    at async Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:726:13)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 性能测试" name="应该高效处理批量操作" time="0.106">
    </testcase>
    <testcase classname="CloudStorageAdapter › 并发安全" name="应该安全处理并发上传" time="0.01">
      <failure>Error: All storage providers failed
    at CloudStorageAdapter.upload (E:\zk-agent\lib\storage\cloud-storage-adapter.ts:573:15)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:770:67)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="CloudStorageAdapter › 并发安全" name="应该安全处理并发下载" time="0.006">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;get&apos;)
    at CloudStorageAdapter.download (E:\zk-agent\lib\storage\cloud-storage-adapter.ts:579:73)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\storage\cloud-storage-adapter.test.ts:781:69)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
  </testsuite>
  <testsuite name="SecurityAuditSystem" errors="0" failures="0" skipped="0" timestamp="2025-06-26T09:32:31" time="1.14" tests="23">
    <testcase classname="SecurityAuditSystem › 单例模式" name="应该返回同一个实例" time="0.001">
    </testcase>
    <testcase classname="SecurityAuditSystem › 单例模式" name="应该与导出的单例实例相同" time="0.001">
    </testcase>
    <testcase classname="SecurityAuditSystem › 安全事件记录" name="应该成功记录安全事件" time="0.006">
    </testcase>
    <testcase classname="SecurityAuditSystem › 安全事件记录" name="应该为高风险事件分配更高的风险评分" time="0.004">
    </testcase>
    <testcase classname="SecurityAuditSystem › 安全事件记录" name="应该处理本地IP地址" time="0.003">
    </testcase>
    <testcase classname="SecurityAuditSystem › 文件安全扫描" name="应该扫描安全的文本文件" time="0.004">
    </testcase>
    <testcase classname="SecurityAuditSystem › 文件安全扫描" name="应该检测不安全的文件类型" time="0.006">
    </testcase>
    <testcase classname="SecurityAuditSystem › 文件安全扫描" name="应该检测过大的文件" time="0.378">
    </testcase>
    <testcase classname="SecurityAuditSystem › 文件安全扫描" name="应该检测危险的文件名" time="0.001">
    </testcase>
    <testcase classname="SecurityAuditSystem › 威胁检测" name="应该检测正常请求" time="0.002">
    </testcase>
    <testcase classname="SecurityAuditSystem › 威胁检测" name="应该检测SQL注入尝试" time="0.002">
    </testcase>
    <testcase classname="SecurityAuditSystem › 威胁检测" name="应该检测XSS尝试" time="0.003">
    </testcase>
    <testcase classname="SecurityAuditSystem › 威胁检测" name="应该检测可疑的User-Agent" time="0.003">
    </testcase>
    <testcase classname="SecurityAuditSystem › 用户行为分析" name="应该分析用户行为模式" time="0.002">
    </testcase>
    <testcase classname="SecurityAuditSystem › 用户行为分析" name="应该检测异常行为" time="0.004">
    </testcase>
    <testcase classname="SecurityAuditSystem › 安全报告生成" name="应该生成安全报告" time="0.004">
    </testcase>
    <testcase classname="SecurityAuditSystem › 便捷方法" name="recordSecurityEvent 方法应该正常工作" time="0.002">
    </testcase>
    <testcase classname="SecurityAuditSystem › 便捷方法" name="scanFile 方法应该正常工作" time="0.003">
    </testcase>
    <testcase classname="SecurityAuditSystem › 便捷方法" name="detectThreats 方法应该正常工作" time="0.003">
    </testcase>
    <testcase classname="SecurityAuditSystem › 便捷方法" name="analyzeUserBehavior 方法应该正常工作" time="0.001">
    </testcase>
    <testcase classname="SecurityAuditSystem › 便捷方法" name="generateSecurityReport 方法应该正常工作" time="0.001">
    </testcase>
    <testcase classname="SecurityAuditSystem › 性能测试" name="应该在合理时间内处理安全事件" time="0.001">
    </testcase>
    <testcase classname="SecurityAuditSystem › 性能测试" name="应该高效处理文件扫描" time="0.004">
    </testcase>
  </testsuite>
  <testsuite name="PosterDatabase" errors="0" failures="6" skipped="0" timestamp="2025-06-26T09:32:32" time="0.659" tests="10">
    <testcase classname="PosterDatabase › getStyles" name="应该成功获取海报风格列表" time="0.015">
      <failure>Error: 获取海报风格失败
    at PosterDatabase.getStyles (E:\zk-agent\lib\database\poster-db.ts:39:19)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\poster-db.test.ts:61:59)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="PosterDatabase › getStyles" name="应该处理获取风格时的错误" time="0.006">
    </testcase>
    <testcase classname="PosterDatabase › getSizes" name="应该成功获取海报尺寸列表" time="0.003">
      <failure>Error: 获取海报尺寸失败
    at PosterDatabase.getSizes (E:\zk-agent\lib\database\poster-db.ts:64:19)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\poster-db.test.ts:107:59)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="PosterDatabase › getSizes" name="应该处理获取尺寸时的错误" time="0.004">
    </testcase>
    <testcase classname="PosterDatabase › getColorPalettes" name="应该成功获取配色方案列表" time="0.004">
      <failure>Error: 获取配色方案失败
    at PosterDatabase.getColorPalettes (E:\zk-agent\lib\database\poster-db.ts:87:19)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\poster-db.test.ts:148:59)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="PosterDatabase › getColorPalettes" name="应该处理获取配色方案时的错误" time="0.009">
    </testcase>
    <testcase classname="PosterDatabase › createPosterTask" name="应该成功创建海报任务" time="0.004">
      <failure>Error: 创建海报任务失败
    at PosterDatabase.createPosterTask (E:\zk-agent\lib\database\poster-db.ts:120:19)
    at async Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\poster-db.test.ts:201:28)</failure>
    </testcase>
    <testcase classname="PosterDatabase › createPosterTask" name="应该处理创建任务时的错误" time="0.003">
    </testcase>
    <testcase classname="PosterDatabase › updatePosterTaskResult" name="应该成功更新海报任务结果" time="0.004">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: {&quot;data&quot;: {&quot;resultImageUrl&quot;: &quot;https://example.com/result.jpg&quot;, &quot;status&quot;: &quot;completed&quot;, &quot;updatedAt&quot;: Any&lt;Date&gt;}, &quot;where&quot;: {&quot;id&quot;: &quot;task123&quot;}}

Number of calls: 0
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\poster-db.test.ts:245:50)</failure>
    </testcase>
    <testcase classname="PosterDatabase › updatePosterTaskResult" name="应该处理更新任务结果时的错误" time="0.002">
      <failure>Error: expect(received).rejects.toThrow()

Received promise resolved instead of rejected
Resolved to value: undefined
    at expect (E:\zk-agent\node_modules\expect\build\index.js:113:15)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\poster-db.test.ts:258:19)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
  </testsuite>
  <testsuite name="DatabaseService" errors="0" failures="11" skipped="0" timestamp="2025-06-26T09:32:34" time="0.676" tests="13">
    <testcase classname="DatabaseService › getInstance" name="应该返回Prisma客户端实例" time="0.004">
      <failure>Error: expect(jest.fn()).toHaveBeenCalled()

Expected number of calls: &gt;= 1
Received number of calls:    0
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\index.test.ts:38:42)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="DatabaseService › getInstance" name="应该返回相同的实例（单例模式）" time="0.003">
    </testcase>
    <testcase classname="DatabaseService › connect" name="应该成功连接数据库" time="0.004">
      <failure>Error: expect(jest.fn()).toHaveBeenCalled()

Expected number of calls: &gt;= 1
Received number of calls:    0
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\index.test.ts:50:49)</failure>
    </testcase>
    <testcase classname="DatabaseService › connect" name="应该处理连接失败的情况" time="0.004">
      <failure>Error: expect(received).rejects.toThrow()

Received promise resolved instead of rejected
Resolved to value: undefined
    at expect (E:\zk-agent\node_modules\expect\build\index.js:113:15)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\index.test.ts:56:19)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="DatabaseService › disconnect" name="应该成功断开数据库连接" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalled()

Expected number of calls: &gt;= 1
Received number of calls:    0
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\index.test.ts:64:52)</failure>
    </testcase>
    <testcase classname="DatabaseService › disconnect" name="应该处理断开连接失败的情况" time="0.004">
      <failure>Error: expect(received).rejects.toThrow()

Received promise resolved instead of rejected
Resolved to value: undefined
    at expect (E:\zk-agent\node_modules\expect\build\index.js:113:15)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\index.test.ts:70:19)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="DatabaseService › healthCheck" name="应该在数据库健康时返回true" time="0.003">
      <failure>Error: expect(jest.fn()).toHaveBeenCalled()

Expected number of calls: &gt;= 1
Received number of calls:    0
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\index.test.ts:83:50)</failure>
    </testcase>
    <testcase classname="DatabaseService › healthCheck" name="应该在数据库不健康时返回false" time="0.004">
      <failure>Error: expect(received).toBe(expected) // Object.is equality

Expected: false
Received: true
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\index.test.ts:89:28)</failure>
    </testcase>
    <testcase classname="DatabaseService › runTransaction" name="应该成功执行事务" time="0.009">
      <failure>Error: expect(received).toBe(expected) // Object.is equality

Expected: &quot;transaction result&quot;
Received: undefined
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\index.test.ts:98:28)</failure>
    </testcase>
    <testcase classname="DatabaseService › runTransaction" name="应该处理事务执行失败的情况" time="0.004">
      <failure>Error: expect(received).rejects.toThrow()

Received promise resolved instead of rejected
Resolved to value: undefined
    at expect (E:\zk-agent\node_modules\expect\build\index.js:113:15)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\index.test.ts:106:19)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="DatabaseService › cleanup" name="应该调用disconnect方法" time="0.002">
      <failure>Error: expect(jest.fn()).toHaveBeenCalled()

Expected number of calls: &gt;= 1
Received number of calls:    0
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\index.test.ts:113:52)</failure>
    </testcase>
    <testcase classname="DatabaseService › prisma export" name="应该导出prisma实例" time="0.004">
    </testcase>
    <testcase classname="Process Event Listeners" name="应该注册进程退出事件监听器" time="0.004">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;NODE_ENV&apos;)
    at DatabaseService.getInstance (E:\zk-agent\lib\database\index.ts:45:29)
    at Object.&lt;anonymous&gt; (E:\zk-agent\lib\database\index.ts:83:32)
    at Runtime._execModule (E:\zk-agent\node_modules\jest-runtime\build\index.js:1439:24)
    at Runtime._loadModule (E:\zk-agent\node_modules\jest-runtime\build\index.js:1022:12)
    at Runtime.requireModule (E:\zk-agent\node_modules\jest-runtime\build\index.js:882:12)
    at Runtime.requireModuleOrMock (E:\zk-agent\node_modules\jest-runtime\build\index.js:1048:21)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\database\index.test.ts:139:9)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
  </testsuite>
  <testsuite name="ErrorRetryManager - 智能对话错误重试管理" errors="0" failures="18" skipped="0" timestamp="2025-06-26T09:32:35" time="0.536" tests="19">
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 基础功能测试" name="应该正确初始化错误重试管理器" time="0.004">
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 基础功能测试" name="应该正确设置默认配置" time="0.001">
      <failure>TypeError: errorRetryManager.getConfig is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:24:46)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 错误分类测试" name="应该正确识别网络错误" time="0.002">
      <failure>TypeError: errorRetryManager.isRetryableError is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:37:51)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 错误分类测试" name="应该正确识别超时错误" time="0.001">
      <failure>TypeError: errorRetryManager.isRetryableError is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:43:51)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 错误分类测试" name="应该正确识别服务器错误" time="0.001">
      <failure>TypeError: errorRetryManager.isRetryableError is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:49:51)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 错误分类测试" name="应该正确识别不可重试错误" time="0.001">
      <failure>TypeError: errorRetryManager.isRetryableError is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:55:51)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 重试延迟计算测试" name="应该正确计算指数退避延迟" time="0.002">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;baseDelay&apos;)
    at ErrorRetryManager.calculateDelay (E:\zk-agent\lib\chat\error-retry-manager.ts:313:30)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:61:46)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 重试延迟计算测试" name="应该限制最大延迟时间" time="0.002">
      <failure>TypeError: errorRetryManager.getConfig is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:69:48)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 重试延迟计算测试" name="应该添加随机抖动" time="0.002">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;baseDelay&apos;)
    at ErrorRetryManager.calculateDelay (E:\zk-agent\lib\chat\error-retry-manager.ts:313:30)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:74:46)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 重试执行测试" name="应该在成功时立即返回结果" time="0.005">
      <failure>Error: expect(received).toBe(expected) // Object.is equality

Expected: &quot;success&quot;
Received: {&quot;attempts&quot;: [{&quot;attempt&quot;: 1, &quot;duration&quot;: 0, &quot;timestamp&quot;: 2025-06-26T09:32:36.098Z}], &quot;data&quot;: &quot;success&quot;, &quot;success&quot;: true, &quot;totalDuration&quot;: 0, &quot;totalRetries&quot;: 0}
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:85:28)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 重试执行测试" name="应该在可重试错误时进行重试" time="0.004">
      <failure>Error: expect(received).toBe(expected) // Object.is equality

Expected: &quot;success&quot;
Received: {&quot;attempts&quot;: [{&quot;attempt&quot;: 1, &quot;duration&quot;: 0, &quot;error&quot;: {&quot;code&quot;: undefined, &quot;isRetryable&quot;: false, &quot;message&quot;: &quot;Network error&quot;, &quot;metadata&quot;: {&quot;originalError&quot;: [Error: Network error]}, &quot;retryCount&quot;: 0, &quot;statusCode&quot;: undefined, &quot;timestamp&quot;: 2025-06-26T09:32:36.104Z, &quot;type&quot;: &quot;unknown&quot;}, &quot;timestamp&quot;: 2025-06-26T09:32:36.104Z}], &quot;error&quot;: {&quot;code&quot;: undefined, &quot;isRetryable&quot;: false, &quot;message&quot;: &quot;Network error&quot;, &quot;metadata&quot;: {&quot;originalError&quot;: [Error: Network error]}, &quot;retryCount&quot;: 0, &quot;statusCode&quot;: undefined, &quot;timestamp&quot;: 2025-06-26T09:32:36.104Z, &quot;type&quot;: &quot;unknown&quot;}, &quot;success&quot;: false, &quot;totalDuration&quot;: 0, &quot;totalRetries&quot;: 0}
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:91:28)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 重试执行测试" name="应该在达到最大重试次数后抛出错误" time="0.002">
      <failure>Error: expect(received).rejects.toThrow()

Received promise resolved instead of rejected
Resolved to value: {&quot;attempts&quot;: [{&quot;attempt&quot;: 1, &quot;duration&quot;: 0, &quot;error&quot;: {&quot;code&quot;: undefined, &quot;isRetryable&quot;: false, &quot;message&quot;: &quot;Persistent error&quot;, &quot;metadata&quot;: {&quot;originalError&quot;: [Error: Persistent error]}, &quot;retryCount&quot;: 0, &quot;statusCode&quot;: undefined, &quot;timestamp&quot;: 2025-06-26T09:32:36.108Z, &quot;type&quot;: &quot;unknown&quot;}, &quot;timestamp&quot;: 2025-06-26T09:32:36.108Z}], &quot;error&quot;: {&quot;code&quot;: undefined, &quot;isRetryable&quot;: false, &quot;message&quot;: &quot;Persistent error&quot;, &quot;metadata&quot;: {&quot;originalError&quot;: [Error: Persistent error]}, &quot;retryCount&quot;: 0, &quot;statusCode&quot;: undefined, &quot;timestamp&quot;: 2025-06-26T09:32:36.108Z, &quot;type&quot;: &quot;unknown&quot;}, &quot;success&quot;: false, &quot;totalDuration&quot;: 0, &quot;totalRetries&quot;: 0}
    at expect (E:\zk-agent\node_modules\expect\build\index.js:113:15)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:96:19)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 重试执行测试" name="应该在不可重试错误时立即抛出" time="0.003">
      <failure>Error: expect(received).rejects.toThrow()

Received promise resolved instead of rejected
Resolved to value: {&quot;attempts&quot;: [{&quot;attempt&quot;: 1, &quot;duration&quot;: 1, &quot;error&quot;: {&quot;code&quot;: undefined, &quot;isRetryable&quot;: false, &quot;message&quot;: &quot;Unauthorized&quot;, &quot;metadata&quot;: {&quot;originalError&quot;: [AuthError: Unauthorized]}, &quot;retryCount&quot;: 0, &quot;statusCode&quot;: undefined, &quot;timestamp&quot;: 2025-06-26T09:32:36.111Z, &quot;type&quot;: &quot;unknown&quot;}, &quot;timestamp&quot;: 2025-06-26T09:32:36.111Z}], &quot;error&quot;: {&quot;code&quot;: undefined, &quot;isRetryable&quot;: false, &quot;message&quot;: &quot;Unauthorized&quot;, &quot;metadata&quot;: {&quot;originalError&quot;: [AuthError: Unauthorized]}, &quot;retryCount&quot;: 0, &quot;statusCode&quot;: undefined, &quot;timestamp&quot;: 2025-06-26T09:32:36.111Z, &quot;type&quot;: &quot;unknown&quot;}, &quot;success&quot;: false, &quot;totalDuration&quot;: 1, &quot;totalRetries&quot;: 0}
    at expect (E:\zk-agent\node_modules\expect\build\index.js:113:15)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:104:19)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 错误统计测试" name="应该正确记录错误统计" time="0.002">
      <failure>Error: expect(received).toBeGreaterThan(expected)

Matcher error: received value must be a number or bigint

Received has value: undefined
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:117:39)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 错误统计测试" name="应该正确分类错误类型统计" time="0.002">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;NetworkError&apos;)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:130:36)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 配置更新测试" name="应该允许更新重试配置" time="0.001">
      <failure>TypeError: errorRetryManager.updateConfig is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:141:31)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 配置更新测试" name="应该验证配置参数的有效性" time="0.011">
      <failure>Error: expect(received).toThrow(expected)

Expected substring: &quot;Invalid configuration&quot;
Received message:   &quot;errorRetryManager.updateConfig is not a function&quot;

      150 |         // 预期的错误
      151 |       }
    &gt; 152 |       
          |       ^
      153 |       const stats = errorRetryManager.getErrorStats()
      154 |       expect(stats.totalErrors).toBeGreaterThan(0)
      155 |       expect(stats.retryAttempts).toBeGreaterThan(0)

      at __tests__/lib/chat/error-retry-manager.test.ts:152:42
      at Object.&lt;anonymous&gt; (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.&lt;anonymous&gt; (__tests__/lib/chat/error-retry-manager.test.ts:152:71)
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:152:71)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 并发处理测试" name="应该正确处理并发重试请求" time="0.021">
      <failure>Error: expect(received).toEqual(expected) // deep equality

- Expected  -   5
+ Received  + 180

  Array [
-   &quot;Success 0&quot;,
-   &quot;Success 1&quot;,
-   &quot;Success 2&quot;,
-   &quot;Success 3&quot;,
-   &quot;Success 4&quot;,
+   Object {
+     &quot;attempts&quot;: Array [
+       Object {
+         &quot;attempt&quot;: 1,
+         &quot;duration&quot;: 0,
+         &quot;error&quot;: Object {
+           &quot;code&quot;: undefined,
+           &quot;isRetryable&quot;: false,
+           &quot;message&quot;: &quot;Error 0&quot;,
+           &quot;metadata&quot;: Object {
+             &quot;originalError&quot;: [Error: Error 0],
+           },
+           &quot;retryCount&quot;: 0,
+           &quot;statusCode&quot;: undefined,
+           &quot;timestamp&quot;: Date {},
+           &quot;type&quot;: &quot;unknown&quot;,
+         },
+         &quot;timestamp&quot;: Date {},
+       },
+     ],
+     &quot;error&quot;: Object {
+       &quot;code&quot;: undefined,
+       &quot;isRetryable&quot;: false,
+       &quot;message&quot;: &quot;Error 0&quot;,
+       &quot;metadata&quot;: Object {
+         &quot;originalError&quot;: [Error: Error 0],
+       },
+       &quot;retryCount&quot;: 0,
+       &quot;statusCode&quot;: undefined,
+       &quot;timestamp&quot;: Date {},
+       &quot;type&quot;: &quot;unknown&quot;,
+     },
+     &quot;success&quot;: false,
+     &quot;totalDuration&quot;: 1,
+     &quot;totalRetries&quot;: 0,
+   },
+   Object {
+     &quot;attempts&quot;: Array [
+       Object {
+         &quot;attempt&quot;: 1,
+         &quot;duration&quot;: 1,
+         &quot;error&quot;: Object {
+           &quot;code&quot;: undefined,
+           &quot;isRetryable&quot;: false,
+           &quot;message&quot;: &quot;Error 1&quot;,
+           &quot;metadata&quot;: Object {
+             &quot;originalError&quot;: [Error: Error 1],
+           },
+           &quot;retryCount&quot;: 0,
+           &quot;statusCode&quot;: undefined,
+           &quot;timestamp&quot;: Date {},
+           &quot;type&quot;: &quot;unknown&quot;,
+         },
+         &quot;timestamp&quot;: Date {},
+       },
+     ],
+     &quot;error&quot;: Object {
+       &quot;code&quot;: undefined,
+       &quot;isRetryable&quot;: false,
+       &quot;message&quot;: &quot;Error 1&quot;,
+       &quot;metadata&quot;: Object {
+         &quot;originalError&quot;: [Error: Error 1],
+       },
+       &quot;retryCount&quot;: 0,
+       &quot;statusCode&quot;: undefined,
+       &quot;timestamp&quot;: Date {},
+       &quot;type&quot;: &quot;unknown&quot;,
+     },
+     &quot;success&quot;: false,
+     &quot;totalDuration&quot;: 1,
+     &quot;totalRetries&quot;: 0,
+   },
+   Object {
+     &quot;attempts&quot;: Array [
+       Object {
+         &quot;attempt&quot;: 1,
+         &quot;duration&quot;: 1,
+         &quot;error&quot;: Object {
+           &quot;code&quot;: undefined,
+           &quot;isRetryable&quot;: false,
+           &quot;message&quot;: &quot;Error 2&quot;,
+           &quot;metadata&quot;: Object {
+             &quot;originalError&quot;: [Error: Error 2],
+           },
+           &quot;retryCount&quot;: 0,
+           &quot;statusCode&quot;: undefined,
+           &quot;timestamp&quot;: Date {},
+           &quot;type&quot;: &quot;unknown&quot;,
+         },
+         &quot;timestamp&quot;: Date {},
+       },
+     ],
+     &quot;error&quot;: Object {
+       &quot;code&quot;: undefined,
+       &quot;isRetryable&quot;: false,
+       &quot;message&quot;: &quot;Error 2&quot;,
+       &quot;metadata&quot;: Object {
+         &quot;originalError&quot;: [Error: Error 2],
+       },
+       &quot;retryCount&quot;: 0,
+       &quot;statusCode&quot;: undefined,
+       &quot;timestamp&quot;: Date {},
+       &quot;type&quot;: &quot;unknown&quot;,
+     },
+     &quot;success&quot;: false,
+     &quot;totalDuration&quot;: 1,
+     &quot;totalRetries&quot;: 0,
+   },
+   Object {
+     &quot;attempts&quot;: Array [
+       Object {
+         &quot;attempt&quot;: 1,
+         &quot;duration&quot;: 1,
+         &quot;error&quot;: Object {
+           &quot;code&quot;: undefined,
+           &quot;isRetryable&quot;: false,
+           &quot;message&quot;: &quot;Error 3&quot;,
+           &quot;metadata&quot;: Object {
+             &quot;originalError&quot;: [Error: Error 3],
+           },
+           &quot;retryCount&quot;: 0,
+           &quot;statusCode&quot;: undefined,
+           &quot;timestamp&quot;: Date {},
+           &quot;type&quot;: &quot;unknown&quot;,
+         },
+         &quot;timestamp&quot;: Date {},
+       },
+     ],
+     &quot;error&quot;: Object {
+       &quot;code&quot;: undefined,
+       &quot;isRetryable&quot;: false,
+       &quot;message&quot;: &quot;Error 3&quot;,
+       &quot;metadata&quot;: Object {
+         &quot;originalError&quot;: [Error: Error 3],
+       },
+       &quot;retryCount&quot;: 0,
+       &quot;statusCode&quot;: undefined,
+       &quot;timestamp&quot;: Date {},
+       &quot;type&quot;: &quot;unknown&quot;,
+     },
+     &quot;success&quot;: false,
+     &quot;totalDuration&quot;: 1,
+     &quot;totalRetries&quot;: 0,
+   },
+   Object {
+     &quot;attempts&quot;: Array [
+       Object {
+         &quot;attempt&quot;: 1,
+         &quot;duration&quot;: 1,
+         &quot;error&quot;: Object {
+           &quot;code&quot;: undefined,
+           &quot;isRetryable&quot;: false,
+           &quot;message&quot;: &quot;Error 4&quot;,
+           &quot;metadata&quot;: Object {
+             &quot;originalError&quot;: [Error: Error 4],
+           },
+           &quot;retryCount&quot;: 0,
+           &quot;statusCode&quot;: undefined,
+           &quot;timestamp&quot;: Date {},
+           &quot;type&quot;: &quot;unknown&quot;,
+         },
+         &quot;timestamp&quot;: Date {},
+       },
+     ],
+     &quot;error&quot;: Object {
+       &quot;code&quot;: undefined,
+       &quot;isRetryable&quot;: false,
+       &quot;message&quot;: &quot;Error 4&quot;,
+       &quot;metadata&quot;: Object {
+         &quot;originalError&quot;: [Error: Error 4],
+       },
+       &quot;retryCount&quot;: 0,
+       &quot;statusCode&quot;: undefined,
+       &quot;timestamp&quot;: Date {},
+       &quot;type&quot;: &quot;unknown&quot;,
+     },
+     &quot;success&quot;: false,
+     &quot;totalDuration&quot;: 1,
+     &quot;totalRetries&quot;: 0,
+   },
  ]
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:162:29)</failure>
    </testcase>
    <testcase classname="ErrorRetryManager - 智能对话错误重试管理 › 内存管理测试" name="应该正确清理过期的错误记录" time="0.003">
      <failure>TypeError: errorRetryManager.recordError is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\error-retry-manager.test.ts:175:35)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
  </testsuite>
  <testsuite name="UnifiedAIAdapter" errors="0" failures="23" skipped="0" timestamp="2025-06-26T09:32:36" time="0.711" tests="23">
    <testcase classname="UnifiedAIAdapter › 单例模式" name="应该返回相同的实例" time="0.003">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 单例模式" name="应该返回导出的单例实例" time="0.003">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › FastGPT服务调用" name="应该成功调用FastGPT" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › FastGPT服务调用" name="应该处理FastGPT错误响应" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 千问服务调用" name="应该成功调用千问" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 千问服务调用" name="应该处理千问错误响应" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 硅基流动服务调用" name="应该成功调用硅基流动" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 熔断器机制" name="应该在连续失败后触发熔断器" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 熔断器机制" name="应该能够重置熔断器" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 负载均衡" name="应该返回最优的AI提供商" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 负载均衡" name="应该处理没有健康服务的情况" time="0.003">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 健康检查" name="应该返回所有服务的健康状态" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 健康检查" name="应该正确标记不健康的服务" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 配置管理" name="应该返回配置的服务列表" time="0.003">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 配置管理" name="应该验证服务配置" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 错误处理" name="应该处理网络错误" time="0.005">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 错误处理" name="应该处理超时错误" time="0.003">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 错误处理" name="应该处理无效的JSON响应" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 性能测试" name="应该在合理时间内完成调用" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 性能测试" name="应该正确测量响应延迟" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 并发处理" name="应该正确处理并发请求" time="0.002">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 内存管理" name="应该正确管理熔断器状态" time="0.001">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="UnifiedAIAdapter › 流式响应" name="应该支持流式响应处理" time="0.005">
      <failure>TypeError: _unifiedaiadapter.UnifiedAIAdapter.getInstance is not a function
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\ai\unified-ai-adapter.test.ts:19:56)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusHook (E:\zk-agent\node_modules\jest-circus\build\run.js:281:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:246:5)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
  </testsuite>
  <testsuite name="智能对话基础功能测试" errors="0" failures="1" skipped="0" timestamp="2025-06-26T09:32:38" time="0.517" tests="19">
    <testcase classname="智能对话基础功能测试 › 消息处理测试" name="应该正确处理简单文本消息" time="0.003">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 消息处理测试" name="应该正确验证消息格式" time="0.002">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 消息处理测试" name="应该正确处理多种角色的消息" time="0.001">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 会话管理测试" name="应该正确生成会话ID" time="0.003">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 会话管理测试" name="应该正确管理会话状态" time="0.001">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 错误处理测试" name="应该正确处理空消息" time="0.002">
      <failure>Error: expect(received).toBe(expected) // Object.is equality

Expected: false
Received: &quot;&quot;
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\lib\chat\chat-basic.test.js:85:29)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="智能对话基础功能测试 › 错误处理测试" name="应该正确处理超长消息" time="0.001">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 错误处理测试" name="应该正确处理无效角色" time="0.012">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 上下文管理测试" name="应该正确管理对话历史" time="0.002">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 上下文管理测试" name="应该正确限制上下文长度" time="0.002">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 消息验证测试" name="应该正确验证消息内容安全性" time="0.002">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 消息验证测试" name="应该正确过滤敏感内容" time="0.002">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 性能测试" name="应该在合理时间内处理消息" time="0.002">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 性能测试" name="应该正确处理并发消息" time="0.003">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 数据结构测试" name="应该正确定义消息数据结构" time="0.003">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 数据结构测试" name="应该正确定义会话数据结构" time="0.003">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 工具函数测试" name="应该正确生成唯一ID" time="0.002">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 工具函数测试" name="应该正确格式化时间戳" time="0.003">
    </testcase>
    <testcase classname="智能对话基础功能测试 › 工具函数测试" name="应该正确计算消息长度" time="0.002">
    </testcase>
  </testsuite>
  <testsuite name="EnhancedPasswordSecurity" errors="0" failures="0" skipped="0" timestamp="2025-06-26T09:32:38" time="4.07" tests="14">
    <testcase classname="EnhancedPasswordSecurity › 密码验证" name="应该验证强密码" time="0.011">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 密码验证" name="应该拒绝弱密码" time="0.012">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 密码验证" name="应该检测常见密码" time="0.005">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 密码验证" name="应该检测个人信息" time="0.003">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 密码哈希和验证" name="应该成功哈希密码" time="0.739">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 密码哈希和验证" name="应该验证正确的密码" time="0.913">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 密码哈希和验证" name="应该拒绝错误的密码" time="1.586">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 登录尝试跟踪" name="应该记录成功的登录尝试" time="0.005">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 登录尝试跟踪" name="应该记录失败的登录尝试" time="0.006">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 登录尝试跟踪" name="应该在多次失败后锁定账户" time="0.004">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 安全密码生成" name="应该生成指定长度的密码" time="0.006">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 安全密码生成" name="应该生成包含所有字符类型的密码" time="0.004">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 安全密码生成" name="应该生成不同的密码" time="0.02">
    </testcase>
    <testcase classname="EnhancedPasswordSecurity › 安全统计" name="应该返回安全统计信息" time="0.005">
    </testcase>
  </testsuite>
  <testsuite name="Performance Benchmarks" errors="0" failures="1" skipped="0" timestamp="2025-06-26T09:32:50" time="0.434" tests="3">
    <testcase classname="Performance Benchmarks" name="API响应时间应小于100ms" time="0.057">
    </testcase>
    <testcase classname="Performance Benchmarks" name="内存使用应在合理范围内" time="0.003">
      <failure>Error: expect(received).toBeLessThan(expected)

Expected: &lt; 100
Received:   360.17530822753906
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\performance\benchmark.test.js:19:28)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="Performance Benchmarks" name="Bundle大小应符合要求" time="0.001">
    </testcase>
  </testsuite>
  <testsuite name="Performance Report" errors="0" failures="1" skipped="0" timestamp="2025-06-26T09:32:51" time="0.78" tests="4">
    <testcase classname="Performance Report" name="收集API响应时间数据" time="0.238">
    </testcase>
    <testcase classname="Performance Report" name="收集内存使用数据" time="0.001">
      <failure>Error: expect(received).toBeLessThan(expected)

Expected: &lt; 100
Received:   398.6063461303711
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\performance\performance-report.test.js:55:49)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="Performance Report" name="收集CPU性能数据" time="0.065">
    </testcase>
    <testcase classname="Performance Report" name="生成性能报告" time="0.032">
    </testcase>
  </testsuite>
  <testsuite name="Zod验证系统测试" errors="0" failures="0" skipped="0" timestamp="2025-06-26T09:32:51" time="0.55" tests="32">
    <testcase classname="Zod验证系统测试 › CAD文件验证" name="应该验证有效的CAD文件" time="0.004">
    </testcase>
    <testcase classname="Zod验证系统测试 › CAD文件验证" name="应该拒绝不支持的文件格式" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › CAD文件验证" name="应该拒绝过大的文件" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › CAD文件验证" name="应该拒绝空文件名" time="0.002">
    </testcase>
    <testcase classname="Zod验证系统测试 › CAD文件验证" name="应该支持所有CAD文件格式" time="0.002">
    </testcase>
    <testcase classname="Zod验证系统测试 › 聊天消息验证" name="应该验证有效的聊天消息" time="0.004">
    </testcase>
    <testcase classname="Zod验证系统测试 › 聊天消息验证" name="应该拒绝空消息内容" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › 聊天消息验证" name="应该拒绝过长的消息" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › 聊天消息验证" name="应该检测潜在的XSS攻击" time="0.004">
    </testcase>
    <testcase classname="Zod验证系统测试 › 聊天消息验证" name="应该支持所有消息类型和角色" time="0.007">
    </testcase>
    <testcase classname="Zod验证系统测试 › 聊天消息验证" name="应该自动设置默认值" time="0.004">
    </testcase>
    <testcase classname="Zod验证系统测试 › 智能体配置验证" name="应该验证有效的智能体配置" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › 智能体配置验证" name="应该拒绝无效的智能体ID" time="0.002">
    </testcase>
    <testcase classname="Zod验证系统测试 › 智能体配置验证" name="应该支持所有智能体类型" time="0.002">
    </testcase>
    <testcase classname="Zod验证系统测试 › 智能体配置验证" name="应该限制能力数量" time="0.002">
    </testcase>
    <testcase classname="Zod验证系统测试 › 智能体配置验证" name="应该验证优先级范围" time="0.005">
    </testcase>
    <testcase classname="Zod验证系统测试 › 智能体配置验证" name="应该设置默认值" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › 用户输入验证" name="应该验证有效的用户输入" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › 用户输入验证" name="应该拒绝无效的邮箱格式" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › 用户输入验证" name="应该验证密码强度" time="0.004">
    </testcase>
    <testcase classname="Zod验证系统测试 › 用户输入验证" name="应该验证姓名格式" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › CAD分析配置验证" name="应该验证有效的分析配置" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › CAD分析配置验证" name="应该设置默认值" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › CAD分析配置验证" name="应该验证超时时间范围" time="0.003">
    </testcase>
    <testcase classname="Zod验证系统测试 › 响应式配置验证" name="应该验证有效的响应式配置" time="0.002">
    </testcase>
    <testcase classname="Zod验证系统测试 › 响应式配置验证" name="应该验证屏幕尺寸限制" time="0.002">
    </testcase>
    <testcase classname="Zod验证系统测试 › 验证工具函数" name="createValidator应该创建自定义验证器" time="0.006">
    </testcase>
    <testcase classname="Zod验证系统测试 › 验证工具函数" name="sanitizeAndValidate应该清理并验证数据" time="0.001">
    </testcase>
    <testcase classname="Zod验证系统测试 › 验证限制常量" name="应该定义所有必要的限制" time="0.002">
    </testcase>
    <testcase classname="Zod验证系统测试 › 边界值测试" name="应该处理边界值情况" time="0.002">
    </testcase>
    <testcase classname="Zod验证系统测试 › 错误处理" name="应该处理非预期的输入类型" time="0.002">
    </testcase>
    <testcase classname="Zod验证系统测试 › 错误处理" name="应该提供详细的错误信息" time="0.002">
    </testcase>
  </testsuite>
  <testsuite name="Advanced Performance Benchmarks" errors="0" failures="0" skipped="0" timestamp="2025-06-26T09:32:52" time="0.55" tests="5">
    <testcase classname="Advanced Performance Benchmarks" name="数据库连接性能测试" time="0.035">
    </testcase>
    <testcase classname="Advanced Performance Benchmarks" name="文件读取性能测试" time="0.012">
    </testcase>
    <testcase classname="Advanced Performance Benchmarks" name="CPU密集型操作性能测试" time="0.034">
    </testcase>
    <testcase classname="Advanced Performance Benchmarks" name="内存泄漏检测" time="0.003">
    </testcase>
    <testcase classname="Advanced Performance Benchmarks" name="并发处理性能测试" time="0.028">
    </testcase>
  </testsuite>
  <testsuite name="核心工具函数测试" errors="0" failures="1" skipped="0" timestamp="2025-06-26T09:32:53" time="0.454" tests="6">
    <testcase classname="核心工具函数测试" name="环境变量设置正确" time="0.003">
      <failure>Error: expect(received).toContain(expected) // indexOf

Expected substring: &quot;zkagent2&quot;
Received string:    &quot;postgresql://test:test@localhost:5432/test_db&quot;
    at Object.&lt;anonymous&gt; (E:\zk-agent\__tests__\core\utils.test.js:10:42)
    at Promise.then.completed (E:\zk-agent\node_modules\jest-circus\build\utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (E:\zk-agent\node_modules\jest-circus\build\utils.js:231:10)
    at _callCircusTest (E:\zk-agent\node_modules\jest-circus\build\run.js:316:40)
    at async _runTest (E:\zk-agent\node_modules\jest-circus\build\run.js:252:3)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:126:9)
    at async _runTestsForDescribeBlock (E:\zk-agent\node_modules\jest-circus\build\run.js:121:9)
    at async run (E:\zk-agent\node_modules\jest-circus\build\run.js:71:3)
    at async runAndTransformResultsToJestFormat (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
    at async jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="核心工具函数测试" name="全局变量可用" time="0.008">
    </testcase>
    <testcase classname="核心工具函数测试" name="基础数学运算" time="0.003">
    </testcase>
    <testcase classname="核心工具函数测试" name="字符串操作" time="0.001">
    </testcase>
    <testcase classname="核心工具函数测试" name="数组操作" time="0.004">
    </testcase>
    <testcase classname="核心工具函数测试" name="对象操作" time="0.002">
    </testcase>
  </testsuite>
  <testsuite name="增强数据库连接管理器测试" errors="0" failures="2" skipped="0" timestamp="2025-06-26T09:32:55" time="11.603" tests="23">
    <testcase classname="增强数据库连接管理器测试 › 连接管理" name="应该成功连接到数据库" time="0.007">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 连接管理" name="应该处理连接失败" time="0.005">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 连接管理" name="应该成功断开连接" time="0.002">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 重连机制" name="应该在连接失败后自动重连" time="10.015">
      <failure>Error: thrown: &quot;Exceeded timeout of 10000 ms for a test.
Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.&quot;
    at E:\zk-agent\tests\database\enhanced-connection.test.ts:86:25
    at _dispatchDescribe (E:\zk-agent\node_modules\jest-circus\build\index.js:91:26)
    at describe (E:\zk-agent\node_modules\jest-circus\build\index.js:55:5)
    at E:\zk-agent\tests\database\enhanced-connection.test.ts:85:27
    at _dispatchDescribe (E:\zk-agent\node_modules\jest-circus\build\index.js:91:26)
    at describe (E:\zk-agent\node_modules\jest-circus\build\index.js:55:5)
    at Object.&lt;anonymous&gt; (E:\zk-agent\tests\database\enhanced-connection.test.ts:16:23)
    at Runtime._execModule (E:\zk-agent\node_modules\jest-runtime\build\index.js:1439:24)
    at Runtime._loadModule (E:\zk-agent\node_modules\jest-runtime\build\index.js:1022:12)
    at Runtime.requireModule (E:\zk-agent\node_modules\jest-runtime\build\index.js:882:12)
    at jestAdapter (E:\zk-agent\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:77:13)
    at async runTestInternal (E:\zk-agent\node_modules\jest-runner\build\runTest.js:367:16)
    at async runTest (E:\zk-agent\node_modules\jest-runner\build\runTest.js:444:34)</failure>
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 重连机制" name="应该在达到最大重试次数后停止重连" time="0.512">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 健康检查" name="应该定期执行健康检查" time="0.217">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 健康检查" name="应该处理健康检查失败" time="0.207">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 查询执行" name="应该成功执行查询并更新统计信息" time="0.002">
      <failure>Error: expect(received).toBeGreaterThan(expected)

Expected: &gt; 0
Received:   0
    at Object.&lt;anonymous&gt; (E:\zk-agent\tests\database\enhanced-connection.test.ts:210:52)</failure>
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 查询执行" name="应该处理查询失败并更新失败统计" time="0.005">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 查询执行" name="应该在未连接时拒绝查询" time="0.004">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 统计信息" name="应该正确跟踪连接统计信息" time="0.003">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 统计信息" name="应该正确计算运行时间" time="0.117">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 配置更新" name="应该允许动态更新连接池配置" time="0.002">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 配置更新" name="应该允许动态更新重连配置" time="0.001">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 配置更新" name="应该允许动态更新健康检查配置" time="0.006">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 全局实例测试" name="应该提供全局数据库连接实例" time="0.001">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 全局实例测试" name="应该提供便捷的连接函数" time="0.004">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 全局实例测试" name="应该提供便捷的查询执行函数" time="0.004">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 错误处理" name="应该正确识别连接相关错误" time="0.012">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 错误处理" name="应该处理优雅关闭" time="0.006">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 事件系统" name="应该正确触发连接事件" time="0.002">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 事件系统" name="应该正确触发断开连接事件" time="0.003">
    </testcase>
    <testcase classname="增强数据库连接管理器测试 › 事件系统" name="应该正确触发错误事件" time="0.007">
    </testcase>
  </testsuite>
  <testsuite name="Test Environment" errors="0" failures="0" skipped="0" timestamp="2025-06-26T09:33:07" time="0.382" tests="6">
    <testcase classname="Test Environment" name="should be able to run tests" time="0.004">
    </testcase>
    <testcase classname="Test Environment" name="should have access to basic JavaScript features" time="0.003">
    </testcase>
    <testcase classname="Test Environment" name="should have access to Node.js globals" time="0.001">
    </testcase>
    <testcase classname="Basic Functionality" name="should handle arrays correctly" time="0.003">
    </testcase>
    <testcase classname="Basic Functionality" name="should handle objects correctly" time="0.001">
    </testcase>
    <testcase classname="Basic Functionality" name="should handle promises correctly" time="0.001">
    </testcase>
  </testsuite>
</testsuites>